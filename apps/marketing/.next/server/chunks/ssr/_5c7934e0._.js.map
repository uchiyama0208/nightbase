{"version":3,"sources":["../../../../../../apps/marketing/src/components/layouts/AuroraPage.tsx","../../../../../../apps/marketing/src/lib/caseStudies.ts","../../../../../../apps/marketing/src/components/CaseStudyList.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/marketing/src/app/%28marketing%29/case-studies/page.tsx"],"sourcesContent":["import type { ReactNode } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\ntype AuroraVariant = \"indigo\" | \"violet\" | \"teal\" | \"amber\";\n\nconst gradientMap: Record<AuroraVariant, string> = {\n  indigo: \"bg-gradient-to-br from-[#c7d2fe]/80 via-[#e0f2ff]/70 to-[#c4f1ff]/80\",\n  violet: \"bg-gradient-to-br from-[#e0c3fc]/70 via-[#c1d3ff]/70 to-[#d4fcf7]/60\",\n  teal: \"bg-gradient-to-br from-[#bbf7d0]/70 via-[#bae6fd]/70 to-[#ede9fe]/70\",\n  amber: \"bg-gradient-to-br from-[#ffe4c7]/70 via-[#dbeafe]/60 to-[#e9d5ff]/70\",\n};\n\ninterface AuroraPageProps {\n  children: ReactNode;\n  className?: string;\n  containerClassName?: string;\n  variant?: AuroraVariant;\n}\n\nexport function AuroraPage({\n  children,\n  className,\n  containerClassName,\n  variant = \"indigo\",\n}: AuroraPageProps) {\n  return (\n    <div className={cn(\"relative isolate overflow-hidden py-20 sm:py-28\", className)}>\n      <div\n        aria-hidden\n        className=\"pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.96),_transparent_65%)]\"\n      />\n      <div aria-hidden className={cn(\"pointer-events-none absolute inset-0 opacity-80 blur-3xl\", gradientMap[variant])} />\n      <div\n        aria-hidden\n        className=\"pointer-events-none absolute left-1/2 top-10 h-48 w-[60vw] -translate-x-1/2 rounded-full bg-white/60 blur-[140px]\"\n      />\n      <div\n        aria-hidden\n        className=\"pointer-events-none absolute inset-x-0 bottom-0 h-64 bg-[radial-gradient(circle_at_bottom,_rgba(95,111,255,0.1),_transparent_60%)]\"\n      />\n      <div className={cn(\"container relative z-10 space-y-16\", containerClassName)}>{children}</div>\n    </div>\n  );\n}\n","import { createClient } from \"@/lib/supabaseClient\";\nimport type { CaseStudy, CaseStudyStatus } from \"@/types/case-studies\";\nimport type { Database } from \"@/types/supabase\";\n\ntype CmsEntryRow = Pick<\n  Database[\"public\"][\"Tables\"][\"cms_entries\"][\"Row\"],\n  \"id\" | \"type\" | \"slug\" | \"title\" | \"body\" | \"excerpt\" | \"tags\" | \"cover_image_url\" | \"status\" | \"published_at\"\n>;\n\nexport const CASE_STUDY_FIELDS =\n  \"id, type, slug, title, body, excerpt, tags, cover_image_url, status, published_at\";\n\n// metadata を使わないシンプルな構成に移行したため、\n// 以前の encode/decode ユーティリティは廃止しました。\n// ただし、CaseStudyEditor.tsx でまだ使用されているため、互換性のために一時的に復元します。\n\nexport function encodeCaseStudyContent(data: {\n  store_name: string | null;\n  summary: string | null;\n  problems: string | null;\n  solutions: string | null;\n  results: string | null;\n}) {\n  return data;\n}\n\nconst INDUSTRY_LABEL_MAP: Record<string, string> = {\n  cabaret: \"キャバクラ\",\n  lounge: \"ラウンジ\",\n  club: \"クラブ\",\n  \"girls-bar\": \"ガールズバー\",\n  \"concept-cafe\": \"コンカフェ\",\n  host: \"ホストクラブ\",\n  bar: \"バー\",\n};\n\nexport function formatCaseStudyIndustry(industry: string | null): string {\n  if (!industry) {\n    return \"その他\";\n  }\n\n  return INDUSTRY_LABEL_MAP[industry] ?? industry;\n}\n\nexport async function getPublishedCaseStudies(limit?: number): Promise<CaseStudy[]> {\n  const supabase = createClient();\n  const nowIso = new Date().toISOString();\n\n  let query = supabase\n    .from(\"cms_entries\")\n    .select(CASE_STUDY_FIELDS)\n    .eq(\"type\", \"case_study\")\n    .eq(\"status\", \"published\")\n    .or(`published_at.is.null,published_at.lte.${nowIso}`)\n    .order(\"published_at\", { ascending: false, nullsFirst: false });\n\n  if (typeof limit === \"number\") {\n    query = query.limit(limit);\n  }\n\n  const { data, error } = await query;\n\n  if (error) {\n    console.error(\"導入事例一覧の取得に失敗しました\", error);\n    return [];\n  }\n\n  const rows: CmsEntryRow[] = data ?? [];\n\n  return rows\n    .map(normalizeCaseStudy)\n    .filter((caseStudy) => caseStudy.slug.length > 0 && caseStudy.status === \"published\");\n}\n\nexport async function getPublishedCaseStudyBySlug(slug: string): Promise<CaseStudy | null> {\n  const supabase = createClient();\n  const normalizedSlug = (slug ?? \"\").trim();\n\n  if (!normalizedSlug) {\n    return null;\n  }\n\n  const { data, error } = await supabase\n    .from(\"cms_entries\")\n    .select(CASE_STUDY_FIELDS)\n    .eq(\"type\", \"case_study\")\n    .eq(\"status\", \"published\")\n    .eq(\"slug\", normalizedSlug)\n    .maybeSingle();\n\n  if (error) {\n    console.error(\"導入事例の取得に失敗しました\", error);\n    return null;\n  }\n\n  if (!data) {\n    return null;\n  }\n\n  return normalizeCaseStudy(data as CmsEntryRow);\n}\n\nfunction normalizeCaseStudy(row: CmsEntryRow): CaseStudy {\n  const tags = Array.isArray(row.tags) ? (row.tags as string[]) : [];\n\n  // 業種はタグから推定\n  // 1. 事前に定義したスラッグ（cabaret など）があればそれを優先\n  // 2. なければ先頭のタグ文字列（例: 「キャバクラ」）をそのまま使う\n  const slugLikeIndustry = tags.find((tag) => INDUSTRY_LABEL_MAP[tag]);\n  const industryFromTags = slugLikeIndustry ?? tags[0] ?? null;\n\n  const summaryFromExcerpt = (row as any).excerpt as string | null | undefined;\n  const summaryFromBody = typeof row.body === \"string\" && row.body.trim().length > 0\n    ? row.body\n      .split(/\\r?\\n/)\n      .map((line) => line.trim())\n      .find((line) => line.length > 0) ?? null\n    : null;\n\n  const summary = summaryFromExcerpt ?? summaryFromBody ?? null;\n\n  return {\n    id: row.id,\n    slug: (row.slug ?? \"\").trim(),\n    title: row.title ?? \"\",\n    body: row.body ?? null,\n    store_name: null,\n    tags,\n    industry: industryFromTags,\n    summary,\n    problems: null,\n    solutions: null,\n    results: null,\n    cover_image_url: row.cover_image_url ?? null,\n    status: normalizeCaseStudyStatus(row.status),\n    published_at: row.published_at ?? null,\n    created_at: null,\n    updated_at: null,\n  };\n}\n\nfunction normalizeCaseStudyStatus(status: string | null | undefined): CaseStudyStatus {\n  switch (status) {\n    case \"published\":\n      return \"published\";\n    default:\n      return \"draft\";\n  }\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const CaseStudyList = registerClientReference(\n    function() { throw new Error(\"Attempted to call CaseStudyList() from the server but CaseStudyList is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/marketing/src/components/CaseStudyList.tsx\",\n    \"CaseStudyList\",\n);\n","import Link from \"next/link\";\n\nimport { AuroraPage } from \"@/components/layouts/AuroraPage\";\nimport { CaseStudyList } from \"@/components/CaseStudyList\";\nimport { siteContent } from \"@/content/site\";\nimport { getPublishedCaseStudies } from \"@/lib/caseStudies\";\n\nexport const dynamic = \"force-dynamic\";\nexport const revalidate = 60;\n\nexport default async function CaseStudiesPage() {\n  const { caseStudies } = siteContent;\n  const studies = await getPublishedCaseStudies();\n\n  return (\n    <AuroraPage variant=\"teal\" containerClassName=\"space-y-16 px-3 sm:px-4\">\n      <section className=\"text-center\">\n        <div className=\"space-y-6\">\n          <span className=\"inline-flex items-center rounded-full border border-white/50 bg-white/30 px-4 py-1 text-xs font-semibold uppercase tracking-[0.25em] text-primary\">\n            Case Studies\n          </span>\n          <h1 className=\"text-4xl font-semibold text-[#0f172a] sm:text-5xl\">{caseStudies.title}</h1>\n          <p className=\"mx-auto max-w-3xl text-lg leading-relaxed text-neutral-600\">{caseStudies.description}</p>\n        </div>\n      </section>\n      <CaseStudyList caseStudies={studies} />\n    </AuroraPage>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[2]}