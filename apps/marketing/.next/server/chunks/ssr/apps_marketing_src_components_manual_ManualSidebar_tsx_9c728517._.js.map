{"version":3,"sources":["../../../../../../apps/marketing/src/components/manual/ManualSidebar.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\n\nimport type { ManualPage } from \"@/types/manual\";\nimport { cn } from \"@/lib/utils\";\n\ntype ManualSidebarProps = {\n  pages: ManualPage[];\n};\n\nconst ALL_SECTION = \"すべて\";\n\nfunction normalize(text: string | null | undefined) {\n  return (text ?? \"\").toLowerCase();\n}\n\nexport function ManualSidebar({ pages }: ManualSidebarProps) {\n  const pathname = usePathname();\n  const [search, setSearch] = useState(\"\");\n  const [selectedSection, setSelectedSection] = useState<string>(ALL_SECTION);\n\n  const currentSlug = useMemo(() => {\n    if (!pathname) return null;\n    const match = pathname.match(/\\/manual\\/(.+)$/);\n    return match?.[1] ?? null;\n  }, [pathname]);\n\n  const orderedSections = useMemo(() => {\n    const seen = new Set<string>();\n    const list: string[] = [];\n\n    for (const page of pages) {\n      const key = page.section || \"general\";\n      if (!seen.has(key)) {\n        seen.add(key);\n        list.push(key);\n      }\n    }\n\n    return list;\n  }, [pages]);\n\n  const searchLower = normalize(search);\n\n  const filteredPages = useMemo(() => {\n    const base = pages;\n\n    const searched = !searchLower\n      ? base\n      : base.filter((page) => {\n          const haystack = [page.title, page.body_markdown ?? \"\"]\n            .map((value) => normalize(value))\n            .join(\"\\n\");\n          return haystack.includes(searchLower);\n        });\n\n    if (selectedSection === ALL_SECTION) {\n      return searched;\n    }\n\n    return searched.filter((page) => (page.section || \"general\") === selectedSection);\n  }, [pages, searchLower, selectedSection]);\n\n  return (\n    <aside className=\"hidden lg:block lg:w-72 lg:flex-shrink-0\">\n      <div className=\"lg:sticky lg:top-24 lg:space-y-6\">\n        <div className=\"glass-panel space-y-4 p-5\">\n          <div>\n            <label\n              htmlFor=\"manual-sidebar-search\"\n              className=\"text-xs font-semibold uppercase tracking-[0.25em] text-neutral-400\"\n            >\n              Search\n            </label>\n            <input\n              id=\"manual-sidebar-search\"\n              type=\"search\"\n              value={search}\n              onChange={(event) => setSearch(event.target.value)}\n              placeholder=\"キーワードで探す\"\n              className=\"mt-2 w-full rounded-full border border-neutral-200 bg-white px-4 py-2 text-sm outline-none transition focus:border-primary focus:ring-2 focus:ring-primary/20\"\n            />\n          </div>\n\n          <div className=\"space-y-3\">\n            <p className=\"text-xs font-semibold uppercase tracking-[0.25em] text-neutral-400\">タグ</p>\n            <div className=\"flex flex-wrap gap-2\">\n              {[ALL_SECTION, ...orderedSections].map((section) => {\n                const isActive = selectedSection === section;\n                return (\n                  <button\n                    key={section}\n                    type=\"button\"\n                    onClick={() => setSelectedSection(section)}\n                    className={cn(\n                      \"rounded-full px-4 py-1.5 text-xs font-medium transition\",\n                      isActive\n                        ? \"bg-primary text-white shadow-sm shadow-primary/30\"\n                        : \"bg-white/70 text-neutral-700 hover:bg-primary/10 hover:text-primary\"\n                    )}\n                  >\n                    {section === ALL_SECTION ? section : section}\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"glass-panel space-y-3 p-5\">\n          <p className=\"text-xs font-semibold uppercase tracking-[0.25em] text-neutral-400\">マニュアル</p>\n          {filteredPages.length === 0 ? (\n            <p className=\"text-xs text-neutral-500\">条件に一致するマニュアルがありません。</p>\n          ) : (\n            <ul className=\"space-y-1 text-sm\">\n              {filteredPages.map((page) => {\n                const isCurrent = currentSlug === page.slug;\n                return (\n                  <li key={page.id}>\n                    <Link\n                      href={`/manual/${page.slug}`}\n                      className={cn(\n                        \"flex items-center justify-between rounded-xl px-3 py-2 text-xs transition\",\n                        isCurrent\n                          ? \"bg-primary text-white shadow-sm\"\n                          : \"bg-white/70 text-neutral-700 hover:bg-primary/10 hover:text-primary\"\n                      )}\n                    >\n                      <span className=\"line-clamp-2 text-left\">{page.title}</span>\n                    </Link>\n                  </li>\n                );\n              })}\n            </ul>\n          )}\n        </div>\n      </div>\n    </aside>\n  );\n}\n"],"names":[],"mappings":"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"}