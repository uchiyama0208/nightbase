module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);a.s(["Users",()=>b],60246)},72692,a=>{"use strict";let b=(0,a.i(70106).default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);a.s(["Menu",()=>b],72692)},57355,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97942),e=a.i(55294);let f=d.Root,g=d.Trigger,h=d.Portal;d.Close;let i=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Overlay,{ref:f,className:(0,e.cn)("fixed inset-0 z-50 bg-slate-950/70 backdrop-blur data-[state=open]:animate-in data-[state=closed]:animate-out",a),...c}));i.displayName=d.Overlay.displayName;let j=c.forwardRef(({side:a="right",className:c,children:f,...g},j)=>(0,b.jsxs)(h,{children:[(0,b.jsx)(i,{}),(0,b.jsx)(d.Content,{ref:j,className:(0,e.cn)("fixed z-50 flex h-full w-full max-w-md flex-col bg-slate-950/95 p-6 text-slate-100 shadow-2xl backdrop-blur data-[state=open]:animate-in data-[state=closed]:animate-out","right"===a&&"right-0 top-0 data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right","left"===a&&"left-0 top-0 data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left","bottom"===a&&"bottom-0 left-1/2 -translate-x-1/2 data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom","top"===a&&"top-0 left-1/2 -translate-x-1/2 data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",c),...g,children:f})]}));j.displayName=d.Content.displayName;let k=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("mb-6 flex flex-col gap-2",a),...c});k.displayName="SheetHeader";let l=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Title,{ref:f,className:(0,e.cn)("text-lg font-semibold text-slate-50",a),...c}));l.displayName=d.Title.displayName;let m=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Description,{ref:f,className:(0,e.cn)("text-sm text-slate-400",a),...c}));m.displayName=d.Description.displayName,a.s(["Sheet",()=>f,"SheetContent",()=>j,"SheetDescription",()=>m,"SheetHeader",()=>k,"SheetTitle",()=>l,"SheetTrigger",()=>g])},30617,21161,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);a.s(["LayoutDashboard",()=>c],30617);let d=(0,b.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Settings",()=>d],21161)},24471,a=>{"use strict";var b=a.i(72131);let c=new Map,d=a=>{if(c.has(a))return;let b=setTimeout(()=>{c.delete(a),g({type:"REMOVE_TOAST",toastId:a})},1e6);c.set(a,b)},e=[],f={toasts:[]};function g(a){f=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,5)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":let c=b.toastId;return c?d(c):a.toasts.forEach(a=>{d(a.id)}),{...a,toasts:a.toasts.filter(a=>a.id!==c)};case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)};default:return a}})(f,a),e.forEach(a=>{a(f)})}function h(){let[a,c]=b.useState(f);return b.useEffect(()=>(e.push(c),()=>{let a=e.indexOf(c);a>-1&&e.splice(a,1)}),[]),{...a,toast:({...a})=>{let b=Math.random().toString(36).slice(2,9),c=()=>g({type:"DISMISS_TOAST",toastId:b});return g({type:"ADD_TOAST",toast:{id:b,...a}}),setTimeout(c,2e3),{id:b,dismiss:c,update:a=>g({type:"UPDATE_TOAST",toast:a})}},dismiss:a=>g({type:"DISMISS_TOAST",toastId:a})}}a.s(["useToast",()=>h])},92258,a=>{"use strict";let b=(0,a.i(70106).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);a.s(["Mail",()=>b],92258)},25283,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(96221),e=a.i(92258);let f=(0,a.i(70106).default)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var g=a.i(93136),h=a.i(45750),i=a.i(92772),j=a.i(2783),k=a.i(24471);function l({supabase:a}){let{toast:g}=(0,k.useToast)(),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(""),J=(0,c.useCallback)(async()=>{m(!0);try{let[b,c]=await Promise.all([a.auth.getUser(),a.from("profiles").select("id, user_id, display_name, email").maybeSingle()]);b.error&&console.error("[AdminSettings] auth.getUser error",b.error);let d=b.data?.user??null;d&&(u(d.id),y(d.email??"")),c.error&&console.error("[AdminSettings] profiles fetch error",c.error),c.data&&(w(c.data.display_name??""),c.data.email&&y(c.data.email))}finally{m(!1)}},[a]);(0,c.useEffect)(()=>{J()},[J]);let K=async b=>{if(b.preventDefault(),!t)return void g({title:"プロフィールを更新できません",description:"再度ログインしてください。"});o(!0);try{let b=v.trim(),{error:c}=await a.from("profiles").update({display_name:b||null,email:x||null}).eq("user_id",t);if(c){console.error("[AdminSettings] プロフィール更新エラー",c),g({title:"プロフィール更新に失敗しました",description:c.message??"時間をおいて再度お試しください。"});return}g({title:"プロフィールを更新しました",description:"表示名を保存しました。"})}finally{o(!1)}},L=async b=>{if(b.preventDefault(),!z.trim())return void g({title:"メールアドレスを入力してください"});if(z.trim()===x)return void g({title:"現在と同じメールアドレスです"});if(!B)return void g({title:"現在のパスワードを入力してください"});q(!0);try{let b=x||(await a.auth.getUser()).data?.user?.email;if(!b)return void g({title:"メールアドレス情報を取得できませんでした"});let{error:c}=await a.auth.signInWithPassword({email:b,password:B});if(c){console.error("[AdminSettings] メール再認証エラー",c),g({title:"パスワードが正しくありません",description:c.message});return}let{error:d}=await a.auth.updateUser({email:z.trim()});if(console.log("[AdminSettings] メール更新結果",{error:d}),d)return void g({title:"メールアドレスの変更に失敗しました",description:d.message});g({title:"メールアドレスを変更しました",description:"確認メールを送信しました。"}),y(z.trim()),A(""),C("")}finally{q(!1)}},M=async b=>{if(b.preventDefault(),!D||!F||!H)return void g({title:"すべてのパスワード欄を入力してください"});if(F.length<8)return void g({title:"新しいパスワードは8文字以上にしてください"});if(F!==H)return void g({title:"新しいパスワードが一致しません"});s(!0);try{let b=x||(await a.auth.getUser()).data?.user?.email;if(!b)return void g({title:"メールアドレス情報を取得できませんでした"});let{error:c}=await a.auth.signInWithPassword({email:b,password:D});if(c){console.error("[AdminSettings] パスワード再認証エラー",c),g({title:"現在のパスワードが正しくありません",description:c.message});return}let{error:d}=await a.auth.updateUser({password:F});if(console.log("[AdminSettings] パスワード更新結果",{error:d}),d)return void g({title:"パスワードの変更に失敗しました",description:d.message});g({title:"パスワードを変更しました",description:"次回ログイン時から新しいパスワードが適用されます。"}),E(""),G(""),I("")}finally{s(!1)}};return(0,b.jsxs)("div",{className:"space-y-10 p-8",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"設定"}),(0,b.jsx)("h1",{className:"text-4xl font-semibold text-slate-900",children:"アカウント設定"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"NightBase 管理画面で使用するご自身のアカウント情報を更新します。"})]}),(0,b.jsxs)("div",{className:"grid gap-8 lg:grid-cols-2",children:[(0,b.jsxs)("section",{className:"space-y-6 rounded-3xl border border-slate-200 bg-white p-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"プロフィール"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"表示名と連絡先を管理します。"})]}),(0,b.jsxs)("form",{className:"space-y-5",onSubmit:K,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"display-name",className:"text-slate-700",children:"表示名"}),(0,b.jsx)(i.Input,{id:"display-name",value:v,onChange:a=>w(a.target.value),placeholder:"NightBase 管理者",disabled:l})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"current-email",className:"text-slate-700",children:"現在のメールアドレス"}),(0,b.jsx)(i.Input,{id:"current-email",value:x,disabled:!0,readOnly:!0,className:"bg-slate-100 text-slate-700"})]}),(0,b.jsxs)(h.Button,{type:"submit",className:"bg-primary text-white",disabled:n||l,children:[n?(0,b.jsx)(d.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"プロフィールを保存"]})]})]}),(0,b.jsxs)("section",{className:"space-y-6 rounded-3xl border border-slate-200 bg-white p-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"メールアドレス"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"新しいメールアドレスと現在のパスワードを入力してください。"})]}),(0,b.jsxs)("form",{className:"space-y-5",onSubmit:L,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"new-email",className:"text-slate-700",children:"新しいメールアドレス"}),(0,b.jsx)(i.Input,{id:"new-email",type:"email",placeholder:"you@example.com",value:z,onChange:a=>A(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"email-password",className:"text-slate-700",children:"現在のパスワード"}),(0,b.jsx)(i.Input,{id:"email-password",type:"password",placeholder:"現在のパスワード",value:B,onChange:a=>C(a.target.value)})]}),(0,b.jsxs)(h.Button,{type:"submit",className:"bg-primary text-white",disabled:p,children:[p?(0,b.jsx)(d.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(e.Mail,{className:"mr-2 h-4 w-4"}),"メールアドレスを変更"]})]})]})]}),(0,b.jsxs)("section",{className:"space-y-6 rounded-3xl border border-slate-200 bg-white p-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"パスワード"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"安全なパスワードに更新してください。"})]}),(0,b.jsxs)("form",{className:"grid gap-5 md:grid-cols-2",onSubmit:M,children:[(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,b.jsx)(j.Label,{htmlFor:"current-password",className:"text-slate-700",children:"現在のパスワード"}),(0,b.jsx)(i.Input,{id:"current-password",type:"password",value:D,onChange:a=>E(a.target.value),placeholder:"現在のパスワード"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"new-password",className:"text-slate-700",children:"新しいパスワード"}),(0,b.jsx)(i.Input,{id:"new-password",type:"password",value:F,onChange:a=>G(a.target.value),placeholder:"8文字以上"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"confirm-password",className:"text-slate-700",children:"新しいパスワード（確認）"}),(0,b.jsx)(i.Input,{id:"confirm-password",type:"password",value:H,onChange:a=>I(a.target.value),placeholder:"もう一度入力"})]}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsxs)(h.Button,{type:"submit",className:"bg-primary text-white",disabled:r,children:[r?(0,b.jsx)(d.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(f,{className:"mr-2 h-4 w-4"}),"パスワードを変更"]})})]})]}),(0,b.jsxs)("section",{className:"space-y-4 rounded-3xl border border-red-500/40 bg-red-500/5 p-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-red-900",children:"ログアウト"}),(0,b.jsx)("p",{className:"text-sm text-red-700",children:"現在の管理画面セッションを終了します。"})]}),(0,b.jsx)(h.Button,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500",onClick:async()=>{try{let{error:b}=await a.auth.signOut();if(b)throw b;g({title:"ログアウトしました",description:"ログイン画面に戻ります。"}),window.location.href="/admin"}catch(a){console.error("[AdminSettings] ログアウトに失敗しました",a),g({title:"ログアウトに失敗しました",description:a instanceof Error?a.message:"時間をおいて再度お試しください。"})}},children:"ログアウト"})]})]})}function m(){return(0,b.jsx)(g.AdminProtected,{children:({supabase:a})=>(0,b.jsx)(l,{supabase:a})})}a.s(["default",()=>m,"dynamic",0,"force-dynamic"],25283)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b2f3c78f._.js.map