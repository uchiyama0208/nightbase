{"version":3,"sources":["../../../../../../apps/app/src/app/app/%28main%29/timecard/clock-in-button.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/app/src/app/app/%28main%29/timecard/page.tsx","../../../../../../apps/app/src/components/ui/table.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ClockButtons = registerClientReference(\n    function() { throw new Error(\"Attempted to call ClockButtons() from the server but ClockButtons is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/app/src/app/app/(main)/timecard/clock-in-button.tsx\",\n    \"ClockButtons\",\n);\n","import { Suspense } from \"react\";\nimport type { Metadata } from \"next\";\nimport { redirect } from \"next/navigation\";\nimport { createServerClient } from \"@/lib/supabaseServerClient\";\nimport {\n    Table,\n    TableBody,\n    TableCell,\n    TableHead,\n    TableHeader,\n    TableRow,\n} from \"@/components/ui/table\";\nimport { ClockButtons } from \"./clock-in-button\";\nimport { getTimecardData } from \"./actions\";\n\nexport const metadata: Metadata = {\n    title: \"タイムカード\",\n};\n\nfunction TimecardSkeleton() {\n    return (\n        <div className=\"space-y-4 animate-pulse\">\n            <div className=\"h-8 w-1/3 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n            <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n            <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n    );\n}\n\nexport default async function TimecardPage({\n    searchParams,\n}: {\n    searchParams: Promise<{ openModal?: string; clockOut?: string }>;\n}) {\n    const params = await searchParams;\n    const result = await getTimecardData();\n\n    // Handle redirect\n    if ('redirect' in result && result.redirect) {\n        redirect(result.redirect);\n    }\n\n    if (!result.data) {\n        redirect('/app/me');\n    }\n\n    const { timeCards, profile, storeSettings, showBreakColumns, latestTimeCard, pickupHistory } = result.data!;\n    const autoOpenModal = params.openModal === \"true\";\n    const autoClockOut = params.clockOut === \"true\";\n\n    const formatDateTime = (dateString: string | null) => {\n        if (!dateString) return \"-\";\n        const date = new Date(dateString);\n        return date.toLocaleString(\"ja-JP\", {\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n        });\n    };\n\n    const calculateWorkTime = (card: any) => {\n        if (!card.clock_in) return \"-\";\n\n        const clockIn = new Date(card.clock_in);\n        const clockOut = card.clock_out ? new Date(card.clock_out) : new Date();\n\n        let workMinutes = (clockOut.getTime() - clockIn.getTime()) / (1000 * 60);\n\n        if (card.break_start && card.break_end) {\n            const breakStart = new Date(card.break_start);\n            const breakEnd = new Date(card.break_end);\n            const breakMinutes = (breakEnd.getTime() - breakStart.getTime()) / (1000 * 60);\n            workMinutes -= breakMinutes;\n        }\n\n        const hours = Math.floor(workMinutes / 60);\n        const minutes = Math.floor(workMinutes % 60);\n\n        return `${hours}時間${minutes}分`;\n    };\n\n    return (\n        <div className=\"space-y-4\">\n            <div>\n                <h1 className=\"text-xl md:text-2xl font-bold tracking-tight text-gray-900 dark:text-white\">\n                    タイムカード\n                </h1>\n                <p className=\"mt-2 text-xs md:text-sm text-gray-600 dark:text-gray-400\">\n                    出勤・退勤の打刻と勤務履歴を確認できます。\n                </p>\n            </div>\n\n            <Suspense fallback={<div className=\"h-48 bg-gray-100 dark:bg-gray-800 rounded-lg animate-pulse\"></div>}>\n                <div className=\"rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4 md:p-6 lg:p-8 shadow-sm\">\n                    <ClockButtons\n                        latestTimeCard={latestTimeCard}\n                        storeSettings={storeSettings}\n                        showBreakButtons={showBreakColumns}\n                        pickupHistory={pickupHistory}\n                        autoOpenModal={autoOpenModal}\n                        autoClockOut={autoClockOut}\n                    />\n                </div>\n            </Suspense>\n\n            <div>\n                <h2 className=\"text-base md:text-lg font-semibold text-gray-900 dark:text-white mb-3 md:mb-4\">勤務履歴</h2>\n                <div className=\"rounded-md border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 overflow-x-auto\">\n                    <div className=\"min-w-full\">\n                        <Table>\n                            <TableHeader>\n                                <TableRow className=\"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50\">\n                                    <TableHead className=\"min-w-[90px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">勤務日</TableHead>\n                                    <TableHead className=\"min-w-[90px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">出勤</TableHead>\n                                    <TableHead className=\"min-w-[90px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">退勤</TableHead>\n                                    {showBreakColumns && (\n                                        <>\n                                            <TableHead className=\"hidden md:table-cell min-w-[90px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">休憩開始</TableHead>\n                                            <TableHead className=\"hidden md:table-cell min-w-[90px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">休憩終了</TableHead>\n                                        </>\n                                    )}\n                                    <TableHead className=\"min-w-[80px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">勤務時間</TableHead>\n                                    <TableHead className=\"min-w-[90px] px-2 sm:px-4 text-center text-gray-500 dark:text-gray-400\">送迎先</TableHead>\n                                </TableRow>\n                            </TableHeader>\n                            <TableBody>\n                                {timeCards?.map((card: any) => (\n                                    <TableRow key={card.id} className=\"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50\">\n                                        <TableCell className=\"font-medium text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">{card.work_date}</TableCell>\n                                        <TableCell className=\"text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">{formatDateTime(card.clock_in)}</TableCell>\n                                        <TableCell className=\"text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">{formatDateTime(card.clock_out)}</TableCell>\n                                        {showBreakColumns && (\n                                            <>\n                                                <TableCell className=\"hidden md:table-cell text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">\n                                                    {formatDateTime(card.break_start)}\n                                                </TableCell>\n                                                <TableCell className=\"hidden md:table-cell text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">\n                                                    {formatDateTime(card.break_end)}\n                                                </TableCell>\n                                            </>\n                                        )}\n                                        <TableCell className=\"font-medium text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">{calculateWorkTime(card)}</TableCell>\n                                        <TableCell className=\"text-xs md:text-sm px-2 sm:px-4 text-center text-gray-900 dark:text-white\">{card.pickup_destination || card.pickup_location || \"-\"}</TableCell>\n                                    </TableRow>\n                                ))}\n                                {(!timeCards || timeCards.length === 0) && (\n                                    <TableRow>\n                                        <TableCell colSpan={showBreakColumns ? 7 : 5} className=\"h-24 text-center text-xs md:text-sm text-gray-500 dark:text-gray-400\">\n                                            勤務履歴がありません\n                                        </TableCell>\n                                    </TableRow>\n                                )}\n                            </TableBody>\n                        </Table>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 0;\n","import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Table = React.forwardRef<HTMLTableElement, React.HTMLAttributes<HTMLTableElement>>(\n  ({ className, ...props }, ref) => (\n    <div className=\"relative w-full overflow-x-auto\">\n      <table\n        ref={ref}\n        className={cn(\"w-full caption-bottom text-left text-sm text-slate-900\", className)}\n        {...props}\n      />\n    </div>\n  )\n);\nTable.displayName = \"Table\";\n\nconst TableHeader = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(\n  ({ className, ...props }, ref) => (\n    <thead\n      ref={ref}\n      className={cn(\"text-xs uppercase tracking-[0.25em] text-slate-500\", className)}\n      {...props}\n    />\n  )\n);\nTableHeader.displayName = \"TableHeader\";\n\nconst TableBody = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(\n  ({ className, ...props }, ref) => (\n    <tbody ref={ref} className={cn(\"divide-y divide-slate-100\", className)} {...props} />\n  )\n);\nTableBody.displayName = \"TableBody\";\n\nconst TableRow = React.forwardRef<HTMLTableRowElement, React.HTMLAttributes<HTMLTableRowElement>>(\n  ({ className, ...props }, ref) => (\n    <tr\n      ref={ref}\n      className={cn(\"border-b border-slate-200 transition hover:bg-slate-50\", className)}\n      {...props}\n    />\n  )\n);\nTableRow.displayName = \"TableRow\";\n\nconst TableHead = React.forwardRef<HTMLTableCellElement, React.ThHTMLAttributes<HTMLTableCellElement>>(\n  ({ className, ...props }, ref) => (\n    <th ref={ref} className={cn(\"py-3 text-xs font-semibold text-slate-500\", className)} {...props} />\n  )\n);\nTableHead.displayName = \"TableHead\";\n\nconst TableCell = React.forwardRef<HTMLTableCellElement, React.TdHTMLAttributes<HTMLTableCellElement>>(\n  ({ className, ...props }, ref) => (\n    <td ref={ref} className={cn(\"py-4 text-sm text-slate-900\", className)} {...props} />\n  )\n);\nTableCell.displayName = \"TableCell\";\n\nconst TableCaption = React.forwardRef<HTMLTableCaptionElement, React.HTMLAttributes<HTMLTableCaptionElement>>(\n  ({ className, ...props }, ref) => (\n    <caption ref={ref} className={cn(\"mt-4 text-xs text-slate-500\", className)} {...props} />\n  )\n);\nTableCaption.displayName = \"TableCaption\";\n\nconst TableFooter = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(\n  ({ className, ...props }, ref) => (\n    <tfoot ref={ref} className={cn(\"bg-slate-50\", className)} {...props} />\n  )\n);\nTableFooter.displayName = \"TableFooter\";\n\nexport { Table, TableHeader, TableBody, TableFooter, TableRow, TableHead, TableCell, TableCaption };\n"],"names":[],"mappings":"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","ignoreList":[0]}