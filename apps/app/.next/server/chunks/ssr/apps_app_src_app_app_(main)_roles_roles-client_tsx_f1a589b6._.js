module.exports=[82942,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(55294),e=a.i(45750),f=a.i(11587),g=a.i(92772),h=a.i(2783),i=a.i(55054),j=a.i(5050),k=(0,j.createServerReference)("4051358d725b4044b4fdbd74318bae0cb8a8202223",j.callServer,void 0,j.findSourceMapURL,"createRole"),l=(0,j.createServerReference)("6063814e7fe3c93c0a64c2da9f1839dde3930ad582",j.callServer,void 0,j.findSourceMapURL,"updateRole"),m=a.i(15618);function n({role:a,trigger:d,target:j="staff"}){let[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)({can_manage_roles:!1,can_manage_users:!1,can_manage_settings:!1,can_use_timecard:!1,can_manage_attendance:!1,can_view_dashboard:!1,can_manage_menus:!1,target:j});(0,c.useEffect)(()=>{n&&a?(s(a.name),u({can_manage_roles:a.permissions?.can_manage_roles||!1,can_manage_users:a.permissions?.can_manage_users||!1,can_manage_settings:a.permissions?.can_manage_settings||!1,can_use_timecard:a.permissions?.can_use_timecard||!1,can_manage_attendance:a.permissions?.can_manage_attendance||!1,can_view_dashboard:a.permissions?.can_view_dashboard||!1,can_manage_menus:a.permissions?.can_manage_menus||!1,target:a.permissions?.target==="cast"?"cast":"staff"})):n&&!a&&(s(""),u({can_manage_roles:!1,can_manage_users:!1,can_manage_settings:!1,can_use_timecard:"cast"===j,can_manage_attendance:!1,can_view_dashboard:!1,can_manage_menus:!1,target:j}))},[n,a,j]);let v=async b=>{b.preventDefault(),q(!0);try{let b={name:r,permissions:t};a?await l(a.id,b):await k(b),o(!1)}catch(a){console.error(a),alert("エラーが発生しました")}finally{q(!1)}};return(0,b.jsxs)(f.Dialog,{open:n,onOpenChange:o,children:[(0,b.jsx)(f.DialogTrigger,{asChild:!0,children:d||(0,b.jsxs)(e.Button,{className:"whitespace-nowrap",children:[(0,b.jsx)(m.Plus,{className:"mr-2 h-4 w-4"}),"新規作成"]})}),(0,b.jsx)(f.DialogContent,{className:"bg-transparent p-0 text-slate-900 dark:text-white px-4 sm:px-0",children:(0,b.jsxs)("div",{className:"w-full max-w-md sm:max-w-xl mx-auto rounded-3xl bg-white dark:bg-gray-800 p-6 sm:p-8 shadow-2xl border border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{className:"text-slate-900 dark:text-white",children:a?"ロールを編集":"新規ロール作成"}),(0,b.jsx)(f.DialogDescription,{className:"text-slate-500 dark:text-gray-400",children:"ロール名と権限を設定してください。"})]}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"name",className:"text-gray-900 dark:text-gray-200",children:"ロール名"}),(0,b.jsx)(g.Input,{id:"name",value:r,onChange:a=>s(a.target.value),placeholder:"例: 店長",required:!0,className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white placeholder:text-gray-400"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{className:"text-gray-900 dark:text-gray-200",children:"権限設定"}),(0,b.jsxs)("div",{className:"space-y-2 border border-gray-200 dark:border-gray-700 rounded-md p-4 bg-gray-50 dark:bg-gray-900/50",children:["staff"===j&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_manage_roles",checked:t.can_manage_roles,onCheckedChange:a=>u(b=>({...b,can_manage_roles:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_manage_roles",className:"text-gray-700 dark:text-gray-300",children:"権限管理 (ロールの作成・編集)"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_manage_users",checked:t.can_manage_users,onCheckedChange:a=>u(b=>({...b,can_manage_users:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_manage_users",className:"text-gray-700 dark:text-gray-300",children:"プロフィール情報 (スタッフ・キャストの追加)"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_manage_settings",checked:t.can_manage_settings,onCheckedChange:a=>u(b=>({...b,can_manage_settings:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_manage_settings",className:"text-gray-700 dark:text-gray-300",children:"店舗設定 (基本情報の変更)"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_manage_attendance",checked:t.can_manage_attendance,onCheckedChange:a=>u(b=>({...b,can_manage_attendance:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_manage_attendance",className:"text-gray-700 dark:text-gray-300",children:"勤怠"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_view_dashboard",checked:t.can_view_dashboard,onCheckedChange:a=>u(b=>({...b,can_view_dashboard:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_view_dashboard",className:"text-gray-700 dark:text-gray-300",children:"ダッシュボード閲覧"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_manage_menus",checked:t.can_manage_menus,onCheckedChange:a=>u(b=>({...b,can_manage_menus:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_manage_menus",className:"text-gray-700 dark:text-gray-300",children:"メニュー管理"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"can_use_timecard",checked:t.can_use_timecard,onCheckedChange:a=>u(b=>({...b,can_use_timecard:a})),className:"border-gray-300 dark:border-gray-600 data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),(0,b.jsx)(h.Label,{htmlFor:"can_use_timecard",className:"text-gray-700 dark:text-gray-300",children:"タイムカード利用"})]})]})]}),(0,b.jsxs)(f.DialogFooter,{className:"gap-2",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>o(!1),children:"キャンセル"}),(0,b.jsx)(e.Button,{type:"submit",disabled:p,children:p?"保存中...":"保存"})]})]})]})})]})}var o=a.i(3314),p=a.i(81560),q=a.i(70106);let r=(0,q.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var s=/[\\\/_+.#"@\[\(\{&]/,t=/[\\\/_+.#"@\[\(\{&]/g,u=/[\s-]/,v=/[\s-]/g;function w(a){return a.toLowerCase().replace(v," ")}var x=a.i(97942),y=a.i(30553),z=a.i(92843),A=a.i(70121),B='[cmdk-group=""]',C='[cmdk-group-items=""]',D='[cmdk-item=""]',E=`${D}:not([aria-disabled="true"])`,F="cmdk-item-select",G="data-value",H=(a,b,c)=>{var d;return d=a,function a(b,c,d,e,f,g,h){if(g===c.length)return f===b.length?1:.99;var i=`${f},${g}`;if(void 0!==h[i])return h[i];for(var j,k,l,m,n=e.charAt(g),o=d.indexOf(n,f),p=0;o>=0;)(j=a(b,c,d,e,o+1,g+1,h))>p&&(o===f?j*=1:s.test(b.charAt(o-1))?(j*=.8,(l=b.slice(f,o-1).match(t))&&f>0&&(j*=Math.pow(.999,l.length))):u.test(b.charAt(o-1))?(j*=.9,(m=b.slice(f,o-1).match(v))&&f>0&&(j*=Math.pow(.999,m.length))):(j*=.17,f>0&&(j*=Math.pow(.999,o-f))),b.charAt(o)!==c.charAt(g)&&(j*=.9999)),(j<.1&&d.charAt(o-1)===e.charAt(g+1)||e.charAt(g+1)===e.charAt(g)&&d.charAt(o-1)!==e.charAt(g))&&.1*(k=a(b,c,d,e,o+1,g+2,h))>j&&(j=.1*k),j>p&&(p=j),o=d.indexOf(n,o+1);return h[i]=p,p}(d=c&&c.length>0?`${d+" "+c.join(" ")}`:d,b,w(d),w(b),0,0,{})},I=c.createContext(void 0),J=c.createContext(void 0),K=c.createContext(void 0),L=c.forwardRef((a,b)=>{let d=V(()=>{var b,c;return{search:"",value:null!=(c=null!=(b=a.value)?b:a.defaultValue)?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),e=V(()=>new Set),f=V(()=>new Map),g=V(()=>new Map),h=V(()=>new Set),i=T(a),{label:j,children:k,value:l,onValueChange:m,filter:n,shouldFilter:o,loop:p,disablePointerSelection:q=!1,vimBindings:r=!0,...s}=a,t=(0,z.useId)(),u=(0,z.useId)(),v=(0,z.useId)(),w=c.useRef(null),x=Y();U(()=>{if(void 0!==l){let a=l.trim();d.current.value=a,A.emit()}},[l]),U(()=>{x(6,P)},[]);let A=c.useMemo(()=>({subscribe:a=>(h.current.add(a),()=>h.current.delete(a)),snapshot:()=>d.current,setState:(a,b,c)=>{var e,f,g,h;if(!Object.is(d.current[a],b)){if(d.current[a]=b,"search"===a)O(),M(),x(1,N);else if("value"===a){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let a=document.getElementById(v);a?a.focus():null==(e=document.getElementById(t))||e.focus()}if(x(7,()=>{var a;d.current.selectedItemId=null==(a=Q())?void 0:a.id,A.emit()}),c||x(5,P),(null==(f=i.current)?void 0:f.value)!==void 0){null==(h=(g=i.current).onValueChange)||h.call(g,null!=b?b:"");return}}A.emit()}},emit:()=>{h.current.forEach(a=>a())}}),[]),K=c.useMemo(()=>({value:(a,b,c)=>{var e;b!==(null==(e=g.current.get(a))?void 0:e.value)&&(g.current.set(a,{value:b,keywords:c}),d.current.filtered.items.set(a,L(b,c)),x(2,()=>{M(),A.emit()}))},item:(a,b)=>(e.current.add(a),b&&(f.current.has(b)?f.current.get(b).add(a):f.current.set(b,new Set([a]))),x(3,()=>{O(),M(),d.current.value||N(),A.emit()}),()=>{g.current.delete(a),e.current.delete(a),d.current.filtered.items.delete(a);let b=Q();x(4,()=>{O(),(null==b?void 0:b.getAttribute("id"))===a&&N(),A.emit()})}),group:a=>(f.current.has(a)||f.current.set(a,new Set),()=>{g.current.delete(a),f.current.delete(a)}),filter:()=>i.current.shouldFilter,label:j||a["aria-label"],getDisablePointerSelection:()=>i.current.disablePointerSelection,listId:t,inputId:v,labelId:u,listInnerRef:w}),[]);function L(a,b){var c,e;let f=null!=(e=null==(c=i.current)?void 0:c.filter)?e:H;return a?f(a,d.current.search,b):0}function M(){if(!d.current.search||!1===i.current.shouldFilter)return;let a=d.current.filtered.items,b=[];d.current.filtered.groups.forEach(c=>{let d=f.current.get(c),e=0;d.forEach(b=>{e=Math.max(a.get(b),e)}),b.push([c,e])});let c=w.current;R().sort((b,c)=>{var d,e;let f=b.getAttribute("id"),g=c.getAttribute("id");return(null!=(d=a.get(g))?d:0)-(null!=(e=a.get(f))?e:0)}).forEach(a=>{let b=a.closest(C);b?b.appendChild(a.parentElement===b?a:a.closest(`${C} > *`)):c.appendChild(a.parentElement===c?a:a.closest(`${C} > *`))}),b.sort((a,b)=>b[1]-a[1]).forEach(a=>{var b;let c=null==(b=w.current)?void 0:b.querySelector(`${B}[${G}="${encodeURIComponent(a[0])}"]`);null==c||c.parentElement.appendChild(c)})}function N(){let a=R().find(a=>"true"!==a.getAttribute("aria-disabled")),b=null==a?void 0:a.getAttribute(G);A.setState("value",b||void 0)}function O(){var a,b,c,h;if(!d.current.search||!1===i.current.shouldFilter){d.current.filtered.count=e.current.size;return}d.current.filtered.groups=new Set;let j=0;for(let f of e.current){let e=L(null!=(b=null==(a=g.current.get(f))?void 0:a.value)?b:"",null!=(h=null==(c=g.current.get(f))?void 0:c.keywords)?h:[]);d.current.filtered.items.set(f,e),e>0&&j++}for(let[a,b]of f.current)for(let c of b)if(d.current.filtered.items.get(c)>0){d.current.filtered.groups.add(a);break}d.current.filtered.count=j}function P(){var a,b,c;let d=Q();d&&((null==(a=d.parentElement)?void 0:a.firstChild)===d&&(null==(c=null==(b=d.closest(B))?void 0:b.querySelector('[cmdk-group-heading=""]'))||c.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function Q(){var a;return null==(a=w.current)?void 0:a.querySelector(`${D}[aria-selected="true"]`)}function R(){var a;return Array.from((null==(a=w.current)?void 0:a.querySelectorAll(E))||[])}function S(a){let b=R()[a];b&&A.setState("value",b.getAttribute(G))}function W(a){var b;let c=Q(),d=R(),e=d.findIndex(a=>a===c),f=d[e+a];null!=(b=i.current)&&b.loop&&(f=e+a<0?d[d.length-1]:e+a===d.length?d[0]:d[e+a]),f&&A.setState("value",f.getAttribute(G))}function X(a){let b=Q(),c=null==b?void 0:b.closest(B),d;for(;c&&!d;)d=null==(c=a>0?function(a,b){let c=a.nextElementSibling;for(;c;){if(c.matches(b))return c;c=c.nextElementSibling}}(c,B):function(a,b){let c=a.previousElementSibling;for(;c;){if(c.matches(b))return c;c=c.previousElementSibling}}(c,B))?void 0:c.querySelector(E);d?A.setState("value",d.getAttribute(G)):W(a)}let _=()=>S(R().length-1),aa=a=>{a.preventDefault(),a.metaKey?_():a.altKey?X(1):W(1)},ab=a=>{a.preventDefault(),a.metaKey?S(0):a.altKey?X(-1):W(-1)};return c.createElement(y.Primitive.div,{ref:b,tabIndex:-1,...s,"cmdk-root":"",onKeyDown:a=>{var b;null==(b=s.onKeyDown)||b.call(s,a);let c=a.nativeEvent.isComposing||229===a.keyCode;if(!(a.defaultPrevented||c))switch(a.key){case"n":case"j":r&&a.ctrlKey&&aa(a);break;case"ArrowDown":aa(a);break;case"p":case"k":r&&a.ctrlKey&&ab(a);break;case"ArrowUp":ab(a);break;case"Home":a.preventDefault(),S(0);break;case"End":a.preventDefault(),_();break;case"Enter":{a.preventDefault();let b=Q();if(b){let a=new Event(F);b.dispatchEvent(a)}}}}},c.createElement("label",{"cmdk-label":"",htmlFor:K.inputId,id:K.labelId,style:$},j),Z(a,a=>c.createElement(J.Provider,{value:A},c.createElement(I.Provider,{value:K},a))))}),M=c.forwardRef((a,b)=>{var d,e;let f=(0,z.useId)(),g=c.useRef(null),h=c.useContext(K),i=c.useContext(I),j=T(a),k=null!=(e=null==(d=j.current)?void 0:d.forceMount)?e:null==h?void 0:h.forceMount;U(()=>{if(!k)return i.item(f,null==h?void 0:h.id)},[k]);let l=X(f,g,[a.value,a.children,g],a.keywords),m=c.useContext(J),n=W(a=>a.value&&a.value===l.current),o=W(a=>!!k||!1===i.filter()||!a.search||a.filtered.items.get(f)>0);function p(){var a,b;q(),null==(b=(a=j.current).onSelect)||b.call(a,l.current)}function q(){m.setState("value",l.current,!0)}if(c.useEffect(()=>{let b=g.current;if(!(!b||a.disabled))return b.addEventListener(F,p),()=>b.removeEventListener(F,p)},[o,a.onSelect,a.disabled]),!o)return null;let{disabled:r,value:s,onSelect:t,forceMount:u,keywords:v,...w}=a;return c.createElement(y.Primitive.div,{ref:(0,A.composeRefs)(g,b),...w,id:f,"cmdk-item":"",role:"option","aria-disabled":!!r,"aria-selected":!!n,"data-disabled":!!r,"data-selected":!!n,onPointerMove:r||i.getDisablePointerSelection()?void 0:q,onClick:r?void 0:p},a.children)}),N=c.forwardRef((a,b)=>{let{heading:d,children:e,forceMount:f,...g}=a,h=(0,z.useId)(),i=c.useRef(null),j=c.useRef(null),k=(0,z.useId)(),l=c.useContext(I),m=W(a=>!!f||!1===l.filter()||!a.search||a.filtered.groups.has(h));U(()=>l.group(h),[]),X(h,i,[a.value,a.heading,j]);let n=c.useMemo(()=>({id:h,forceMount:f}),[f]);return c.createElement(y.Primitive.div,{ref:(0,A.composeRefs)(i,b),...g,"cmdk-group":"",role:"presentation",hidden:!m||void 0},d&&c.createElement("div",{ref:j,"cmdk-group-heading":"","aria-hidden":!0,id:k},d),Z(a,a=>c.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":d?k:void 0},c.createElement(K.Provider,{value:n},a))))}),O=c.forwardRef((a,b)=>{let{alwaysRender:d,...e}=a,f=c.useRef(null),g=W(a=>!a.search);return d||g?c.createElement(y.Primitive.div,{ref:(0,A.composeRefs)(f,b),...e,"cmdk-separator":"",role:"separator"}):null}),P=c.forwardRef((a,b)=>{let{onValueChange:d,...e}=a,f=null!=a.value,g=c.useContext(J),h=W(a=>a.search),i=W(a=>a.selectedItemId),j=c.useContext(I);return c.useEffect(()=>{null!=a.value&&g.setState("search",a.value)},[a.value]),c.createElement(y.Primitive.input,{ref:b,...e,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":j.listId,"aria-labelledby":j.labelId,"aria-activedescendant":i,id:j.inputId,type:"text",value:f?a.value:h,onChange:a=>{f||g.setState("search",a.target.value),null==d||d(a.target.value)}})}),Q=c.forwardRef((a,b)=>{let{children:d,label:e="Suggestions",...f}=a,g=c.useRef(null),h=c.useRef(null),i=W(a=>a.selectedItemId),j=c.useContext(I);return c.useEffect(()=>{if(h.current&&g.current){let a=h.current,b=g.current,c,d=new ResizeObserver(()=>{c=requestAnimationFrame(()=>{let c=a.offsetHeight;b.style.setProperty("--cmdk-list-height",c.toFixed(1)+"px")})});return d.observe(a),()=>{cancelAnimationFrame(c),d.unobserve(a)}}},[]),c.createElement(y.Primitive.div,{ref:(0,A.composeRefs)(g,b),...f,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":i,"aria-label":e,id:j.listId},Z(a,a=>c.createElement("div",{ref:(0,A.composeRefs)(h,j.listInnerRef),"cmdk-list-sizer":""},a)))}),R=c.forwardRef((a,b)=>{let{open:d,onOpenChange:e,overlayClassName:f,contentClassName:g,container:h,...i}=a;return c.createElement(x.Root,{open:d,onOpenChange:e},c.createElement(x.Portal,{container:h},c.createElement(x.Overlay,{"cmdk-overlay":"",className:f}),c.createElement(x.Content,{"aria-label":a.label,"cmdk-dialog":"",className:g},c.createElement(L,{ref:b,...i}))))}),S=Object.assign(L,{List:Q,Item:M,Input:P,Group:N,Separator:O,Dialog:R,Empty:c.forwardRef((a,b)=>W(a=>0===a.filtered.count)?c.createElement(y.Primitive.div,{ref:b,...a,"cmdk-empty":"",role:"presentation"}):null),Loading:c.forwardRef((a,b)=>{let{progress:d,children:e,label:f="Loading...",...g}=a;return c.createElement(y.Primitive.div,{ref:b,...g,"cmdk-loading":"",role:"progressbar","aria-valuenow":d,"aria-valuemin":0,"aria-valuemax":100,"aria-label":f},Z(a,a=>c.createElement("div",{"aria-hidden":!0},a)))})});function T(a){let b=c.useRef(a);return U(()=>{b.current=a}),b}var U=c.useEffect;function V(a){let b=c.useRef();return void 0===b.current&&(b.current=a()),b}function W(a){let b=c.useContext(J),d=()=>a(b.snapshot());return c.useSyncExternalStore(b.subscribe,d,d)}function X(a,b,d,e=[]){let f=c.useRef(),g=c.useContext(I);return U(()=>{var c;let h=(()=>{var a;for(let b of d){if("string"==typeof b)return b.trim();if("object"==typeof b&&"current"in b)return b.current?null==(a=b.current.textContent)?void 0:a.trim():f.current}})(),i=e.map(a=>a.trim());g.value(a,h,i),null==(c=b.current)||c.setAttribute(G,h),f.current=h}),f}var Y=()=>{let[a,b]=c.useState(),d=V(()=>new Map);return U(()=>{d.current.forEach(a=>a()),d.current=new Map},[a]),(a,c)=>{d.current.set(a,c),b({})}};function Z({asChild:a,children:b},d){let e;return a&&c.isValidElement(b)?c.cloneElement("function"==typeof(e=b.type)?e(b.props):"render"in e?e.render(b.props):b,{ref:b.ref},d(b.props.children)):d(b)}var $={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},_=a.i(56712);let aa=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(S,{ref:e,className:(0,d.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...c}));aa.displayName=S.displayName;let ab=c.forwardRef(({className:a,...c},e)=>(0,b.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,b.jsx)(_.MagnifyingGlassIcon,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,b.jsx)(S.Input,{ref:e,className:(0,d.cn)("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...c})]}));ab.displayName=S.Input.displayName;let ac=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(S.List,{ref:e,className:(0,d.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...c}));ac.displayName=S.List.displayName;let ad=c.forwardRef((a,c)=>(0,b.jsx)(S.Empty,{ref:c,className:"py-6 text-center text-sm",...a}));ad.displayName=S.Empty.displayName;let ae=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(S.Group,{ref:e,className:(0,d.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...c}));ae.displayName=S.Group.displayName,c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(S.Separator,{ref:e,className:(0,d.cn)("-mx-1 h-px bg-border",a),...c})).displayName=S.Separator.displayName;let af=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(S.Item,{ref:e,className:(0,d.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...c}));af.displayName=S.Item.displayName;var ag=(0,j.createServerReference)("60211aeb80c05ed8abf26656abe964d684267a3d74",j.callServer,void 0,j.findSourceMapURL,"assignRole"),ah=a.i(60246);let ai=(0,q.default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function aj({role:a,profiles:d}){let[g,h]=(0,c.useState)(!1),i=a.permissions?.target==="cast"?"cast":"staff",j=d.filter(a=>a.role===i),k=j.filter(b=>b.role_id===a.id),l=j.filter(b=>b.role_id!==a.id),m=async b=>{try{await ag(b,a.id)}catch(a){console.error(a),alert("エラーが発生しました")}},n=async a=>{try{await ag(a,null)}catch(a){console.error(a),alert("エラーが発生しました")}};return(0,b.jsxs)(f.Dialog,{open:g,onOpenChange:h,children:[(0,b.jsx)(f.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(ah.Users,{className:"mr-2 h-4 w-4"}),"メンバー管理 (",k.length,")"]})}),(0,b.jsxs)(f.DialogContent,{className:"bg-white dark:bg-gray-800 w-[95%] rounded-lg p-6 max-h-[90vh] overflow-y-auto sm:max-w-2xl",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsxs)(f.DialogTitle,{className:"text-slate-900 dark:text-white",children:[a.name," - メンバー管理"]}),(0,b.jsx)(f.DialogDescription,{className:"text-slate-500 dark:text-gray-400",children:"このロールを持つユーザーを管理します。"})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-gray-700 bg-slate-50/80 dark:bg-gray-900/50 p-4 sm:p-5",children:[(0,b.jsx)("h4",{className:"font-medium mb-2 text-gray-900 dark:text-white",children:"現在のメンバー"}),(0,b.jsxs)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:[0===k.length&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground dark:text-gray-400",children:"メンバーはいません"}),k.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-secondary/50 dark:bg-gray-800 rounded-md",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.display_name}),a.real_name&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:a.real_name})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>n(a.id),children:(0,b.jsx)(ai,{className:"h-4 w-4"})})]},a.id))]})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-gray-700 bg-slate-50/80 dark:bg-gray-900/50 p-4 sm:p-5",children:[(0,b.jsx)("h4",{className:"font-medium mb-2 text-gray-900 dark:text-white",children:"メンバーを追加"}),(0,b.jsxs)(aa,{className:"w-full border border-slate-200 dark:border-gray-700 rounded-xl overflow-hidden bg-white dark:bg-gray-800",children:[(0,b.jsx)(ab,{placeholder:"ユーザーを検索...",className:"dark:text-white"}),(0,b.jsxs)(ac,{children:[(0,b.jsx)(ad,{className:"text-gray-700 dark:text-gray-200",children:"ユーザーが見つかりません"}),(0,b.jsx)(ae,{children:l.map(a=>(0,b.jsxs)(af,{onSelect:()=>m(a.id),className:"flex items-center justify-between dark:text-white",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.display_name}),a.real_name&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:a.real_name})]}),a.role_id&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground bg-secondary px-2 py-0.5 rounded",children:"他のロールあり"})]},a.id))})]})]})]})]})]})]})}var ak=(0,j.createServerReference)("404e99b8a0847028f660fbc984b5dd6745e3b9c778",j.callServer,void 0,j.findSourceMapURL,"deleteRole");function al({role:a,profiles:d}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(!1),k=async()=>{j(!0);try{await ak(a.id),h(!1)}catch(a){console.error(a),alert("削除に失敗しました。メンバーが割り当てられている可能性があります。")}finally{j(!1)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 bg-card dark:bg-gray-800 text-card-foreground dark:text-white shadow-sm p-6 flex flex-col h-full",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 dark:bg-primary/20 rounded-full",children:(0,b.jsx)(o.Shield,{className:"h-6 w-6 text-primary dark:text-primary-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:[new Date(a.created_at).toLocaleDateString()," 作成"]})]})]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground dark:text-gray-400 flex-1 mb-4",children:(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[a.permissions?.can_manage_roles&&(0,b.jsx)("li",{children:"権限管理"}),a.permissions?.can_manage_users&&(0,b.jsx)("li",{children:"プロフィール情報"}),a.permissions?.can_manage_settings&&(0,b.jsx)("li",{children:"店舗設定"}),a.permissions?.can_use_timecard&&(0,b.jsx)("li",{children:"タイムカード"}),a.permissions?.can_manage_attendance&&(0,b.jsx)("li",{children:"勤怠"}),a.permissions?.can_view_dashboard&&(0,b.jsx)("li",{children:"ダッシュボード"}),!Object.values(a.permissions||{}).some(Boolean)&&(0,b.jsx)("li",{children:"権限なし"})]})}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 mt-auto pt-4 border-t",children:[(0,b.jsx)(aj,{role:a,profiles:d}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",className:"flex-1 text-destructive hover:text-destructive",onClick:()=>h(!0),disabled:a.is_system_role,children:[(0,b.jsx)(p.Trash2,{className:"mr-2 h-4 w-4"}),"削除"]}),(0,b.jsx)(n,{role:a,trigger:(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",className:"flex-1",disabled:a.is_system_role,children:[(0,b.jsx)(r,{className:"mr-2 h-4 w-4"}),"編集"]})})]})]})]}),(0,b.jsx)(f.Dialog,{open:g,onOpenChange:h,children:(0,b.jsxs)(f.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800 w-[95%] rounded-lg p-6",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"ロールを削除"}),(0,b.jsxs)(f.DialogDescription,{className:"text-gray-500 dark:text-gray-400",children:["「",a.name,"」を削除しますか？",(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"text-destructive font-semibold",children:"※この操作は取り消せません。"})]})]}),(0,b.jsxs)(f.DialogFooter,{className:"flex flex-col gap-4",children:[(0,b.jsx)(e.Button,{variant:"destructive",onClick:k,disabled:i,className:"w-full",children:i?"削除中...":"削除する"}),(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>h(!1),disabled:i,className:"w-full",children:"キャンセル"})]})]})})]})}function am({roles:a,profiles:f}){let[g,h]=(0,c.useState)("staff"),i=c.default.useRef(null),j=a.filter(a=>(a.permissions?.target==="cast"?"cast":"staff")===g);return(0,b.jsxs)("div",{className:"relative min-h-screen pb-20",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white",children:"権限管理"}),(0,b.jsx)("p",{className:"mt-1 text-xs md:text-sm text-gray-500 dark:text-gray-400",children:"店舗の役割と権限を設定します。"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"inline-flex items-center rounded-full bg-gray-100 dark:bg-gray-800 p-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>h("cast"),className:(0,d.cn)("px-4 py-2 rounded-full text-sm font-medium transition-colors","cast"===g?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"),children:"キャスト"}),(0,b.jsx)("button",{type:"button",onClick:()=>h("staff"),className:(0,d.cn)("px-4 py-2 rounded-full text-sm font-medium transition-colors","staff"===g?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"),children:"スタッフ"})]}),(0,b.jsx)(e.Button,{size:"icon",className:"h-10 w-10 rounded-full bg-white hover:bg-gray-50 border-2 border-blue-500 text-blue-500",onClick:()=>i.current?.click(),children:(0,b.jsx)(m.Plus,{className:"h-5 w-5"})})]}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.map(a=>(0,b.jsx)(al,{role:a,profiles:f},a.id))})]}),(0,b.jsx)(n,{target:g,trigger:(0,b.jsx)("button",{ref:i,className:"hidden"})})]})}a.s(["RolesPageClient",()=>am],82942)}];

//# sourceMappingURL=apps_app_src_app_app_%28main%29_roles_roles-client_tsx_f1a589b6._.js.map