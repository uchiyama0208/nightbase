{"version":3,"sources":["../../../../../../apps/app/src/app/app/%28main%29/features/features-client.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/app/src/app/app/%28main%29/features/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FeaturesClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call FeaturesClient() from the server but FeaturesClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/app/src/app/app/(main)/features/features-client.tsx\",\n    \"FeaturesClient\",\n);\n","import { Suspense } from \"react\";\nimport { redirect } from \"next/navigation\";\nimport { createServerClient } from \"@/lib/supabaseServerClient\";\nimport { FeaturesClient } from \"./features-client\";\nimport { updateSingleFeature } from \"./actions\";\n\nasync function getFeaturesData() {\n  const supabase = await createServerClient();\n  const { data: { user } } = await supabase.auth.getUser();\n\n  if (!user) {\n    redirect(\"/login\");\n  }\n\n  const { data: appUser } = await supabase\n    .from(\"users\")\n    .select(\"current_profile_id\")\n    .eq(\"id\", user.id)\n    .maybeSingle();\n\n  if (!appUser?.current_profile_id) {\n    redirect(\"/app/me\");\n  }\n\n  const { data: currentProfile } = await supabase\n    .from(\"profiles\")\n    .select(\"store_id, role\")\n    .eq(\"id\", appUser.current_profile_id)\n    .maybeSingle();\n\n  if (!currentProfile?.store_id) {\n    redirect(\"/app/me\");\n  }\n\n  if (currentProfile.role !== \"staff\") {\n    redirect(\"/app/dashboard\");\n  }\n\n  const { data: store } = await supabase\n    .from(\"stores\")\n    .select(\"*\")\n    .eq(\"id\", currentProfile.store_id)\n    .single();\n\n  const initialFlags = store\n    ? {\n      show_dashboard: store.show_dashboard ?? true,\n      show_attendance: store.show_attendance ?? false,\n      show_timecard: store.show_timecard ?? false,\n      show_users: store.show_users ?? false,\n      show_roles: store.show_roles ?? false,\n      show_menus: store.show_menus ?? false,\n    }\n    : {\n      show_dashboard: true,\n      show_attendance: false,\n      show_timecard: false,\n      show_users: false,\n      show_roles: false,\n      show_menus: false,\n    };\n\n  return { initialFlags };\n}\n\nfunction FeaturesSkeleton() {\n  return (\n    <div className=\"space-y-4 md:space-y-6 animate-pulse\">\n      <div className=\"h-8 w-1/3 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n      <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n    </div>\n  );\n}\n\nexport default async function FeatureSettingsPage() {\n  const data = await getFeaturesData();\n\n  return (\n    <Suspense fallback={<FeaturesSkeleton />}>\n      <FeaturesClient initialFlags={data.initialFlags} updateFeature={updateSingleFeature} />\n    </Suspense>\n  );\n}\n\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 0;\n"],"names":[],"mappings":"+VAEO,IAAM,EAAiB,CAAA,EAAA,AAD9B,EAAA,CAAA,CAAA,OAC8B,uBAAA,AAAuB,EACjD,WAAa,MAAM,AAAI,MAAM,0OAA4O,EACzQ,yFACA,sEAHG,IAAM,EAAiB,CAAA,EAD9B,AAC8B,EAD9B,CAAA,CAAA,OAC8B,uBAAA,AAAuB,EACjD,WAAa,MAAM,AAAI,MAAM,0OAA4O,EACzQ,qEACA,iJCLJ,EAAA,EAAA,CAAA,CAAA,KACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,eAAe,IACb,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,kBAAA,AAAkB,IACnC,CAAE,KAAM,MAAE,CAAI,CAAE,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,EAElD,CAAC,GACH,CAAA,EADS,AACT,EAAA,QAAA,AAAQ,EAAC,UAGX,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC7B,IAAI,CAAC,SACL,MAAM,CAAC,sBACP,EAAE,CAAC,KAAM,EAAK,EAAE,EAChB,WAAW,EAEV,CAAC,GAAS,oBACZ,AADgC,AAChC,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,WAGX,GAAM,CAAE,KAAM,CAAc,CAAE,CAAG,MAAM,EACpC,IAAI,CAAC,YACL,MAAM,CAAC,kBACP,EAAE,CAAC,KAAM,EAAQ,kBAAkB,EACnC,WAAW,EAEV,CAAC,GAAgB,UAAU,AAC7B,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,WAGiB,SAAS,CAAjC,EAAe,IAAI,EACrB,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,kBAGX,GAAM,CAAE,KAAM,CAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,UACL,MAAM,CAAC,KACP,EAAE,CAAC,KAAM,EAAe,QAAQ,EAChC,MAAM,GAoBT,MAAO,CAAE,aAlBY,EACjB,CACA,eAAgB,EAAM,cAAc,GAAI,EACxC,gBAAiB,EAAM,eAAe,GAAI,EAC1C,cAAe,EAAM,aAAa,GAAI,EACtC,WAAY,EAAM,UAAU,GAAI,EAChC,WAAY,EAAM,UAAU,GAAI,EAChC,WAAY,EAAM,UAAU,GAAI,CAClC,EACE,CACA,gBAAgB,EAChB,iBAAiB,EACjB,eAAe,EACf,YAAY,EACZ,YAAY,EACZ,WAAY,EACd,CAEoB,CACxB,CAEA,SAAS,IACP,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gDAGrB,CAEe,eAAe,IAC5B,IAAM,EAAO,MAAM,IAEnB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,SAAU,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAA,YACnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAC,aAAc,EAAK,YAAY,CAAE,cAAe,EAAA,mBAAmB,IAGzF,kCAEuB,+BACG","ignoreList":[0]}