module.exports=[11587,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97942),e=a.i(55294);let f=d.Root,g=d.Trigger,h=d.Portal,i=d.Close,j=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Overlay,{ref:f,className:(0,e.cn)("fixed inset-0 z-50 bg-slate-950/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out",a),...c}));j.displayName=d.Overlay.displayName;let k=c.forwardRef(({className:a,children:c,...f},g)=>(0,b.jsxs)(h,{children:[(0,b.jsx)(j,{}),(0,b.jsx)(d.Content,{ref:g,className:(0,e.cn)("fixed left-1/2 top-1/2 z-50 w-[calc(100%-2rem)] max-w-xl -translate-x-1/2 -translate-y-1/2 rounded-3xl border border-slate-200 bg-white p-8 text-slate-900 shadow-2xl backdrop-blur data-[state=open]:animate-in data-[state=closed]:animate-out dark:border-white/10 dark:bg-slate-950/95 dark:text-slate-100",a),...f,children:c})]}));k.displayName=d.Content.displayName;let l=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("mb-6 flex flex-col gap-2 text-center sm:text-left",a),...c});l.displayName="DialogHeader";let m=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...c});m.displayName="DialogFooter";let n=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Title,{ref:f,className:(0,e.cn)("text-xl font-semibold text-slate-900 dark:text-slate-50",a),...c}));n.displayName=d.Title.displayName;let o=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Description,{ref:f,className:(0,e.cn)("text-sm text-slate-500 dark:text-slate-400",a),...c}));o.displayName=d.Description.displayName,a.s(["Dialog",()=>f,"DialogClose",()=>i,"DialogContent",()=>k,"DialogDescription",()=>o,"DialogFooter",()=>m,"DialogHeader",()=>l,"DialogTitle",()=>n,"DialogTrigger",()=>g])},27534,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(55294);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{ref:e,className:(0,d.cn)("w-full caption-bottom text-left text-sm text-slate-900",a),...c})}));e.displayName="Table";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("thead",{ref:e,className:(0,d.cn)("text-xs uppercase tracking-[0.25em] text-slate-500",a),...c}));f.displayName="TableHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tbody",{ref:e,className:(0,d.cn)("divide-y divide-slate-100",a),...c}));g.displayName="TableBody";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tr",{ref:e,className:(0,d.cn)("border-b border-slate-200 transition hover:bg-slate-50",a),...c}));h.displayName="TableRow";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("th",{ref:e,className:(0,d.cn)("py-3 text-xs font-semibold text-slate-500",a),...c}));i.displayName="TableHead";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("td",{ref:e,className:(0,d.cn)("py-4 text-sm text-slate-900",a),...c}));j.displayName="TableCell",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("caption",{ref:e,className:(0,d.cn)("mt-4 text-xs text-slate-500",a),...c})).displayName="TableCaption",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tfoot",{ref:e,className:(0,d.cn)("bg-slate-50",a),...c})).displayName="TableFooter",a.s(["Table",()=>e,"TableBody",()=>g,"TableCell",()=>j,"TableHead",()=>i,"TableHeader",()=>f,"TableRow",()=>h])},5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},33441,a=>{"use strict";let b=(0,a.i(70106).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],33441)},62722,a=>{"use strict";let b=(0,a.i(70106).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],62722)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},96078,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(27534),f=a.i(11587),g=a.i(45750),h=a.i(2783),i=a.i(62403),j=a.i(5050),k=(0,j.createServerReference)("60bfce386e78cdf5046f0d765820c5da089650234b",j.callServer,void 0,j.findSourceMapURL,"approveJoinRequest"),l=(0,j.createServerReference)("406f30820b6fe13c7c51167556b013b73667cc6e45",j.callServer,void 0,j.findSourceMapURL,"rejectJoinRequest"),m=a.i(16201),n=a.i(62722);function o({request:a,isOpen:d,onClose:e,onRequestProcessed:j}){let[o,p]=(0,c.useState)(a.role),[q,r]=(0,c.useState)(!1),s=async()=>{r(!0);let b=await k(a.id,o);b.success?j(a.id):alert(`エラー: ${b.error}`),r(!1)},t=async()=>{if(!confirm("この申請を拒否してもよろしいですか?"))return;r(!0);let b=await l(a.id);b.success?j(a.id):alert(`エラー: ${b.error}`),r(!1)};return(0,b.jsx)(f.Dialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(f.DialogContent,{className:"max-w-[calc(100vw-32px)] max-h-[calc(100vh-32px)] sm:max-w-[500px] bg-white dark:bg-gray-800 text-gray-900 dark:text-white !p-4 sm:!p-6 my-4",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"参加申請の確認"}),(0,b.jsx)(f.DialogDescription,{children:"申請者の情報を確認し、承認または拒否してください"})]}),(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-sm text-gray-600 dark:text-gray-400",children:"名前"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a.real_name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-sm text-gray-600 dark:text-gray-400",children:"申請日時"}),(0,b.jsx)("p",{className:"text-gray-900 dark:text-white",children:new Date(a.created_at).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"role",children:"権限ロール"}),(0,b.jsxs)(i.Select,{value:o,onValueChange:p,children:[(0,b.jsx)(i.SelectTrigger,{id:"role",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"cast",children:"キャスト"}),(0,b.jsx)(i.SelectItem,{value:"staff",children:"スタッフ"})]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"承認時に付与する権限を選択してください"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,b.jsxs)(g.Button,{onClick:s,disabled:q,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[(0,b.jsx)(m.CheckCircle,{className:"h-4 w-4 mr-2"}),q?"処理中...":"許可する"]}),(0,b.jsxs)(g.Button,{onClick:t,disabled:q,variant:"destructive",className:"flex-1",children:[(0,b.jsx)(n.XCircle,{className:"h-4 w-4 mr-2"}),"拒否する"]})]})]})]})})}var p=a.i(56711),q=a.i(2411);function r({requests:a}){let[d,f]=(0,c.useState)(a),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)("all"),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!1),r=d.filter(a=>{let b=a.display_name.toLowerCase().includes(g.toLowerCase())||a.real_name.toLowerCase().includes(g.toLowerCase()),c="all"===i||a.role===i;return b&&c});return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start",children:(0,b.jsx)("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto items-center",children:(0,b.jsxs)("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-full",children:[(0,b.jsx)("button",{onClick:()=>j("all"),className:`px-4 py-1.5 text-sm rounded-full transition-all ${"all"===i?"bg-white dark:bg-gray-700 shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"全て"}),(0,b.jsx)("button",{onClick:()=>j("cast"),className:`px-4 py-1.5 text-sm rounded-full transition-all ${"cast"===i?"bg-white dark:bg-gray-700 shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"キャスト"}),(0,b.jsx)("button",{onClick:()=>j("staff"),className:`px-4 py-1.5 text-sm rounded-full transition-all ${"staff"===i?"bg-white dark:bg-gray-700 shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"スタッフ"})]})})}),(0,b.jsx)("div",{className:"rounded-md border bg-white dark:bg-gray-800",children:(0,b.jsxs)(e.Table,{children:[(0,b.jsx)(e.TableHeader,{children:(0,b.jsxs)(e.TableRow,{children:[(0,b.jsx)(e.TableHead,{className:"text-center w-1/2",children:"名前"}),(0,b.jsx)(e.TableHead,{className:"text-center w-1/2",children:"申請日時"})]})}),(0,b.jsx)(e.TableBody,{children:0===r.length?(0,b.jsx)(e.TableRow,{children:(0,b.jsx)(e.TableCell,{colSpan:2,className:"text-center py-8 text-gray-500",children:"参加申請が見つかりません"})}):r.map(a=>(0,b.jsxs)(e.TableRow,{className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50",onClick:()=>{l(a),n(!0)},children:[(0,b.jsx)(e.TableCell,{className:"font-medium text-center w-1/2",children:a.real_name}),(0,b.jsx)(e.TableCell,{className:"text-sm text-gray-500 text-center w-1/2",children:(0,p.format)(new Date(a.created_at),"yyyy/MM/dd HH:mm",{locale:q.ja})})]},a.id))})]})}),k&&(0,b.jsx)(o,{request:k,isOpen:m,onClose:()=>n(!1),onRequestProcessed:a=>{f(d.filter(b=>b.id!==a)),n(!1)}})]})}var s=(0,j.createServerReference)("00af8e2dc2f7222e26f0f54a39bfb791519379a9a2",j.callServer,void 0,j.findSourceMapURL,"getJoinRequestsData");function t(){let a=(0,d.useRouter)(),[e,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(null);if((0,c.useEffect)(()=>{(async()=>{h(!0);try{let b=await s();if(b.redirect)return void a.push(b.redirect);f(b.data)}catch(a){console.error("Failed to fetch join requests data",a),j(a.message)}finally{h(!1)}})()},[a]),g)return(0,b.jsxs)("div",{className:"p-2 space-y-6 animate-pulse",children:[(0,b.jsx)("div",{className:"h-8 w-1/3 bg-gray-200 dark:bg-gray-700 rounded"}),(0,b.jsx)("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"})]});if(i)return(0,b.jsxs)("div",{className:"p-4",children:["Error loading join requests: ",i]});if(!e)return null;let{joinRequests:k}=e;return(0,b.jsxs)("div",{className:"p-2 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"参加申請"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"スタッフやキャストからの参加申請を管理します。"})]}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(r,{requests:k})})]})}a.s(["default",()=>t,"dynamic",0,"force-dynamic"],96078)}];

//# sourceMappingURL=_d8565dbd._.js.map