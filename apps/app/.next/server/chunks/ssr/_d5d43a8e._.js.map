{"version":3,"sources":["../../../../../../node_modules/lucide-react/src/icons/loader-circle.ts","../../../../../../apps/app/src/app/auth/line-callback/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name LoaderCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTJhOSA5IDAgMSAxLTYuMjE5LTguNTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/loader-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LoaderCircle = createLucideIcon('LoaderCircle', [\n  ['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56', key: '13zald' }],\n]);\n\nexport default LoaderCircle;\n","\"use client\";\n\nimport { Suspense, useEffect, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { createBrowserClient } from \"@/lib/supabaseClient\";\nimport { Loader2 } from \"lucide-react\";\n\nexport default function LineCallbackPage() {\n    return (\n        <Suspense\n            fallback={\n                <div className=\"flex min-h-screen flex-col items-center justify-center bg-gray-50\">\n                    <div className=\"text-center\">\n                        <Loader2 className=\"h-10 w-10 animate-spin text-blue-600 mx-auto mb-4\" />\n                        <p className=\"text-gray-600\">ログイン処理中...</p>\n                    </div>\n                </div>\n            }\n        >\n            <LineCallbackContent />\n        </Suspense>\n    );\n}\n\nfunction LineCallbackContent() {\n    const router = useRouter();\n    const searchParams = useSearchParams();\n    const supabase = createBrowserClient();\n    const [error, setError] = useState<string | null>(null);\n\n    useEffect(() => {\n        const handleCallback = async () => {\n            const accessToken = searchParams.get(\"access_token\");\n            const refreshToken = searchParams.get(\"refresh_token\");\n            const next = searchParams.get(\"next\") || \"/app/dashboard\";\n            const isFriend = searchParams.get(\"is_friend\");\n\n            if (!accessToken || !refreshToken) {\n                setError(\"認証トークンが見つかりません。\");\n                return;\n            }\n\n            try {\n                const { error } = await supabase.auth.setSession({\n                    access_token: accessToken,\n                    refresh_token: refreshToken,\n                });\n\n                if (error) {\n                    console.error(\"Error setting session:\", error);\n                    setError(`セッションの確立に失敗しました: ${error.message}`);\n                } else {\n                    // Pass is_friend parameter to the next page\n                    const redirectUrl = new URL(next, window.location.origin);\n                    if (isFriend !== null) {\n                        redirectUrl.searchParams.set(\"is_friend\", isFriend);\n                    }\n                    router.replace(redirectUrl.pathname + redirectUrl.search);\n                }\n            } catch (err) {\n                console.error(\"Unexpected error:\", err);\n                setError(\"予期せぬエラーが発生しました。\");\n            }\n        };\n\n        handleCallback();\n    }, [router, searchParams, supabase.auth]);\n\n    if (error) {\n        return (\n            <div className=\"flex min-h-screen flex-col items-center justify-center bg-gray-50 p-4\">\n                <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-md text-center\">\n                    <h2 className=\"text-xl font-bold text-red-600 mb-2\">ログインエラー</h2>\n                    <p className=\"text-gray-600 mb-4\">{error}</p>\n                    <button\n                        onClick={() => router.push(\"/login\")}\n                        className=\"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700\"\n                    >\n                        ログインページへ戻る\n                    </button>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"flex min-h-screen flex-col items-center justify-center bg-gray-50\">\n            <div className=\"text-center\">\n                <Loader2 className=\"h-10 w-10 animate-spin text-blue-600 mx-auto mb-4\" />\n                <p className=\"text-gray-600\">ログイン処理中...</p>\n            </div>\n        </div>\n    );\n}\n\nexport const dynamic = 'force-dynamic';\n"],"names":[],"mappings":"uCAaM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAe,AAAf,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAe,OAAA,EAAiB,cAAgB,CAAA,CAAA,AACpD,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAA+B,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC7D,CAAA,CAAA,sECbD,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,IACpB,MACI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACL,SACI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6EACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,sDACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,6BAKzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAA,IAGb,CAEA,SAAS,IACL,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAe,CAAA,EAAA,EAAA,eAAA,AAAe,IAC9B,EAAW,CAAA,EAAA,EAAA,mBAAmB,AAAnB,IACX,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,YAwClD,CAtCA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAmCN,CAlCuB,UACnB,IAAM,EAAc,EAAa,GAAG,CAAC,gBAC/B,EAAe,EAAa,GAAG,CAAC,iBAChC,EAAO,EAAa,GAAG,CAAC,SAAW,iBACnC,EAAW,EAAa,GAAG,CAAC,aAElC,GAAI,CAAC,GAAe,CAAC,EAAc,OAC/B,EAAS,mBAIb,GAAI,CACA,GAAM,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,UAAU,CAAC,CAC7C,aAAc,EACd,cAAe,CACnB,GAEA,GAAI,EACA,KADO,GACC,KAAK,CAAC,yBAA0B,GACxC,EAAS,CAAC,iBAAiB,EAAE,EAAM,OAAO,CAAA,CAAE,MACzC,CAEH,IAAM,EAAc,IAAI,IAAI,EAAM,OAAO,QAAQ,CAAC,MAAM,CACvC,MAAM,EAAnB,GACA,EAAY,YAAY,CAAC,GAAG,CAAC,YAAa,GAE9C,EAAO,OAAO,CAAC,EAAY,QAAQ,CAAG,EAAY,MAAM,CAC5D,CACJ,CAAE,MAAO,EAAK,CACV,QAAQ,KAAK,CAAC,oBAAqB,GACnC,EAAS,kBACb,EACJ,GAGJ,EAAG,CAAC,EAAQ,EAAc,EAAS,IAAI,CAAC,EAEpC,GAEI,CAAA,EAAA,CAFG,CAEH,GAAA,EAAC,MAAA,CAAI,UAAU,iFACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0EACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+CAAsC,YACpD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BAAsB,IACnC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAO,IAAI,CAAC,UAC3B,UAAU,sEACb,oBASb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6EACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,sDACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,mBAI7C,kCAEuB","ignoreList":[0]}