module.exports=[84064,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(5050),f=(0,e.createServerReference)("403be324e96604b07e3d40e85ad9ed05510f775e95",e.callServer,void 0,e.findSourceMapURL,"createAttendance"),g=(0,e.createServerReference)("405bcd64a4bdfaf384e28eef70d6feb4dab0c1c2a1",e.callServer,void 0,e.findSourceMapURL,"updateAttendance"),h=(0,e.createServerReference)("40d39c086fd86461c7bae6b63e57f6f4ac6ba7b97d",e.callServer,void 0,e.findSourceMapURL,"deleteAttendance"),i=a.i(45750),j=a.i(92772),k=a.i(2783),l=a.i(62403),m=a.i(11587),n=a.i(17755),o=a.i(13749),p=a.i(41675),q=a.i(41710);function r({isOpen:a,onClose:e,profiles:r,currentProfileId:s,defaultRole:t="staff",initialData:u,editingRecord:v,onOpenProfileEdit:w,onFocusAttendanceForProfile:x}){let y=(0,d.useRouter)(),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(t),[F,G]=(0,c.useState)(!1),H=v&&r.find(a=>a.id===v.user_id)||null,I=r.filter(a=>"cast"===D?"cast"===a.role:"staff"===a.role),J=v?.user_id||u?.profileId||"",K=v?.date||u?.date||new Date().toISOString().split("T")[0],L=a=>{if(!a)return"";if(/^\d{2}:\d{2}(?::\d{2})?$/.test(a))return a.slice(0,5);try{let b=new Date(a);if(!isNaN(b.getTime()))return b.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch(a){console.error("Error parsing time:",a)}return""},M=v?L(v.start_time):u?.startTime||"",N=v?L(v.end_time):u?.endTime||"",O=v?.pickup_destination||"",P=async a=>{a.preventDefault(),A(!0);try{let b=new FormData(a.currentTarget);v?await g(b):await f(b),y.refresh(),e()}catch(a){console.error("Error saving attendance:",a)}finally{A(!1)}},Q=async()=>{if(v){A(!0);try{await h(v.id),y.refresh(),C(!1),e()}catch(a){console.error("Error deleting attendance:",a)}finally{A(!1)}}};return(0,b.jsxs)(m.Dialog,{open:a,onOpenChange:e,children:[(0,b.jsx)(m.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-6 text-gray-900 dark:text-gray-100",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)(m.DialogHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:e,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0","aria-label":"戻る",children:(0,b.jsx)(o.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)(m.DialogTitle,{className:"flex-1 text-center text-xl md:text-2xl font-bold text-gray-900 dark:text-white truncate",children:H?H.display_name||H.real_name||"メンバー":"出勤記録"}),J?(0,b.jsx)("button",{type:"button",onClick:()=>G(a=>!a),className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700","aria-label":"プロフィール・勤怠の操作を表示",children:(0,b.jsx)(n.MoreHorizontal,{className:"h-4 w-4"})}):(0,b.jsx)("div",{className:"h-8 w-8"})]}),F&&J&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",className:"absolute inset-0 z-10 cursor-default",onClick:()=>G(!1),"aria-label":"メニューを閉じる"}),(0,b.jsxs)("div",{className:"absolute right-0 top-10 z-20 w-40 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg p-2 flex flex-col gap-1 text-xs",children:[(0,b.jsx)(i.Button,{type:"button",variant:"ghost",className:"justify-start h-8 px-2 rounded-lg text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>{w?.(J),G(!1),e()},children:"プロフィール"}),(0,b.jsx)(i.Button,{type:"button",variant:"ghost",className:"justify-start h-8 px-2 rounded-lg text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>{x?.(J),G(!1),e()},children:"勤怠"}),v&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"h-px bg-gray-200 dark:bg-gray-700 my-1"}),(0,b.jsx)(i.Button,{type:"button",variant:"ghost",className:"justify-start h-8 px-2 rounded-lg text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{G(!1),C(!0)},children:"削除"})]})]})]}),!v&&(0,b.jsx)("div",{className:"flex justify-center mb-2",children:(0,b.jsxs)("div",{className:"inline-flex h-8 items-center rounded-full bg-gray-100 dark:bg-gray-700 p-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>E("cast"),className:`px-4 h-full flex items-center rounded-full text-xs font-medium transition-colors ${"cast"===D?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"キャスト"}),(0,b.jsx)("button",{type:"button",onClick:()=>E("staff"),className:`px-4 h-full flex items-center rounded-full text-xs font-medium transition-colors ${"staff"===D?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"スタッフ"})]})}),(0,b.jsxs)("form",{onSubmit:P,className:"space-y-4 mt-1",children:[v&&(0,b.jsx)("input",{type:"hidden",name:"id",value:v.id}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(k.Label,{htmlFor:"profileId",children:"メンバー"}),(0,b.jsxs)(l.Select,{name:"profileId",defaultValue:J,required:!0,children:[(0,b.jsx)(l.SelectTrigger,{className:"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md",children:(0,b.jsx)(l.SelectValue,{placeholder:"メンバーを選択"})}),(0,b.jsx)(l.SelectContent,{children:I.map(a=>(0,b.jsx)(l.SelectItem,{value:a.id,children:a.display_name||a.real_name||"メンバー"},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(k.Label,{htmlFor:"date",children:"日付"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(p.Calendar,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 dark:text-gray-400 pointer-events-none"}),(0,b.jsx)(j.Input,{id:"date",name:"date",type:"date",required:!0,defaultValue:K,className:"w-full pl-10 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(k.Label,{htmlFor:"pickup_destination",children:"送迎先"}),(0,b.jsx)(j.Input,{id:"pickup_destination",name:"pickup_destination",type:"text",placeholder:"送迎先を入力",defaultValue:O,className:"w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(k.Label,{htmlFor:"startTime",children:"開始時刻"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Clock,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 dark:text-gray-400 pointer-events-none"}),(0,b.jsx)(j.Input,{id:"startTime",name:"startTime",type:"time",defaultValue:M,className:"w-full pl-10 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(k.Label,{htmlFor:"endTime",children:"終了時刻"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Clock,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 dark:text-gray-400 pointer-events-none"}),(0,b.jsx)(j.Input,{id:"endTime",name:"endTime",type:"time",defaultValue:N,className:"w-full pl-10 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]})]})]}),(0,b.jsxs)(m.DialogFooter,{className:"flex-col sm:flex-row gap-4 mt-8",children:[(0,b.jsx)(i.Button,{type:"submit",disabled:z,className:"w-full sm:w-auto rounded-full h-10",children:z?"保存中...":v?"保存":"作成"}),(0,b.jsx)(i.Button,{type:"button",variant:"outline",onClick:e,className:"w-full sm:w-auto border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full h-10",children:"キャンセル"})]})]})]})}),(0,b.jsx)(m.Dialog,{open:B,onOpenChange:C,children:(0,b.jsxs)(m.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800 w-[95%] rounded-lg p-6",children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{className:"text-lg font-bold text-gray-900 dark:text-white",children:"勤怠記録の削除"}),(0,b.jsxs)(m.DialogDescription,{className:"text-gray-500 dark:text-gray-400 mt-2",children:["この勤怠記録を削除してもよろしいですか？",(0,b.jsx)("br",{}),"この操作は取り消せません。"]})]}),(0,b.jsxs)(m.DialogFooter,{className:"flex-col sm:flex-row gap-3 mt-6",children:[(0,b.jsx)(i.Button,{type:"button",variant:"destructive",onClick:Q,disabled:z,className:"w-full sm:w-auto rounded-full",children:z?"削除中...":"削除する"}),(0,b.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>C(!1),className:"w-full sm:w-auto rounded-full",children:"キャンセル"})]})]})})]})}a.s(["AttendanceModal",()=>r],84064)},92759,83415,76472,10448,82038,98036,57017,69613,78976,74601,69574,50238,35350,46478,61846,76673,89100,53627,65215,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>c],92759);var d=a.i(30216);a.s(["UserCircle",()=>d.default],83415);let e=(0,b.default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>e],76472);let f=(0,b.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);a.s(["Edit2",()=>f],10448);var g=a.i(5050),h=(0,g.createServerReference)("40d54faf838f60a57d913423bb21d98cd0140e82a1",g.callServer,void 0,g.findSourceMapURL,"updateUser");a.s(["updateUser",()=>h],82038);var i=(0,g.createServerReference)("40e631752d3f63866f4bfdcefb52b39b7a16b9beed",g.callServer,void 0,g.findSourceMapURL,"createUser");a.s(["createUser",()=>i],98036);var j=(0,g.createServerReference)("40d454b66dc7597bde21ab5ab88ac6c1291aba3456",g.callServer,void 0,g.findSourceMapURL,"deleteUser");a.s(["deleteUser",()=>j],57017);var k=(0,g.createServerReference)("40ac9d7a98c2a78cd988100eef4e5e7d91131859e8",g.callServer,void 0,g.findSourceMapURL,"getProfileDetails");a.s(["getProfileDetails",()=>k],69613);var l=(0,g.createServerReference)("7013ab3c5d7056545e992425288ac07f894e0f9321",g.callServer,void 0,g.findSourceMapURL,"updateProfileRelationships");a.s(["updateProfileRelationships",()=>l],78976);var m=(0,g.createServerReference)("6037218bf15dafe2b6f4a84653a7896a5f707e4376",g.callServer,void 0,g.findSourceMapURL,"addProfileComment");a.s(["addProfileComment",()=>m],74601);var n=(0,g.createServerReference)("60819da50ce93994448e38298ecedf8232cced91bd",g.callServer,void 0,g.findSourceMapURL,"updateProfileComment");a.s(["updateProfileComment",()=>n],69574);var o=(0,g.createServerReference)("4084b6043912cd8a75569f2d971d9e162ea4de2c3f",g.callServer,void 0,g.findSourceMapURL,"deleteProfileComment");a.s(["deleteProfileComment",()=>o],50238);var p=(0,g.createServerReference)("405a3002f6f21537774442b0b95e2dd58bbb99e2d9",g.callServer,void 0,g.findSourceMapURL,"toggleCommentLike");a.s(["toggleCommentLike",()=>p],35350);var q=(0,g.createServerReference)("00e8e4d5ad38b65a60a88324e02b1556aaf771095a",g.callServer,void 0,g.findSourceMapURL,"getAllProfiles");a.s(["getAllProfiles",()=>q],46478);var r=(0,g.createServerReference)("00a5fe1c9ebf4b8eac0bfb2ac26badbfac17290c2b",g.callServer,void 0,g.findSourceMapURL,"getCurrentUserProfileId");a.s(["getCurrentUserProfileId",()=>r],61846);var s=(0,g.createServerReference)("6032599c457d1d9c38a767c7a62a3e4304032c930b",g.callServer,void 0,g.findSourceMapURL,"uploadProfileAvatar");a.s(["uploadProfileAvatar",()=>s],76673);var t=(0,g.createServerReference)("40a7d24dbb5a7d9dfb1a862bc601d5443013a95d2a",g.callServer,void 0,g.findSourceMapURL,"deleteProfileAvatar");a.s(["deleteProfileAvatar",()=>t],89100);var u=(0,g.createServerReference)("405d88bef58e495845168b770b6ef6545da02343bd",g.callServer,void 0,g.findSourceMapURL,"getUserBottleKeeps");a.s(["getUserBottleKeeps",()=>u],53627);var v=(0,g.createServerReference)("00e241e9b8fcf03b19909349ec766f9fc7fbab803a",g.callServer,void 0,g.findSourceMapURL,"getMenus");a.s(["getMenus",()=>v],65215)},44698,69851,a=>{"use strict";var b=a.i(5050),c=(0,b.createServerReference)("406ac45c0783e1af90b5ef914f0a0a0f0dd0751f05",b.callServer,void 0,b.findSourceMapURL,"createBottleKeep");a.s(["createBottleKeep",()=>c],44698);var d=(0,b.createServerReference)("6041bdd2e4dae44a41afa21525389d91048eec82d8",b.callServer,void 0,b.findSourceMapURL,"updateBottleKeep");a.s(["updateBottleKeep",()=>d],69851)},81278,a=>{"use strict";a.s(["BottleModal",()=>r]);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(44698),f=a.i(69851),g=a.i(45750),h=a.i(92772),i=a.i(2783),j=a.i(12144),k=a.i(62403),l=a.i(11587),m=a.i(13749),n=a.i(15618),o=a.i(55054),p=a.i(53007),q=a.i(18697);function r({isOpen:a,onClose:r,bottle:s,menus:t,profiles:u,initialProfileIds:v=[]}){let w=(0,d.useRouter)(),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),H=s?.bottle_keep_holders?.map(a=>a.profile_id)||v,[I,J]=(0,c.useState)(H),K=[...u].filter(a=>"guest"===a.role).sort((a,b)=>{let c=a.display_name_kana||a.display_name||a.real_name_kana||a.real_name||"",d=b.display_name_kana||b.display_name||b.real_name_kana||b.real_name||"";return c.localeCompare(d,"ja")}).filter(a=>{let b=z.toLowerCase(),c=(a.display_name||"").toLowerCase(),d=(a.display_name_kana||"").toLowerCase(),e=(a.real_name||"").toLowerCase(),f=(a.real_name_kana||"").toLowerCase();return c.includes(b)||d.includes(b)||e.includes(b)||f.includes(b)}),L=[...t].sort((a,b)=>a.name.localeCompare(b.name,"ja")).filter(a=>{let b=B.toLowerCase();return a.name.toLowerCase().includes(b)}),M=async a=>{a.preventDefault(),y(!0);try{let b=new FormData(a.currentTarget);b.set("profile_ids",JSON.stringify(I)),s?await (0,f.updateBottleKeep)(s.id,b):await (0,e.createBottleKeep)(b),w.refresh(),r()}catch(a){console.error("Error saving bottle keep:",a),alert("保存に失敗しました")}finally{y(!1)}};return(0,b.jsxs)(l.Dialog,{open:a,onOpenChange:r,children:[(0,b.jsxs)(l.DialogContent,{className:"sm:max-w-[500px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-6 text-gray-900 dark:text-gray-100",children:[(0,b.jsxs)(l.DialogHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:r,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none","aria-label":"戻る",children:(0,b.jsx)(m.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)(l.DialogTitle,{className:"flex-1 text-center text-xl font-bold text-gray-900 dark:text-white",children:s?"ボトル編集":"ボトル新規登録"}),(0,b.jsx)("div",{className:"w-8"})]}),(0,b.jsxs)("form",{onSubmit:M,className:"space-y-5 mt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(i.Label,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["ゲスト ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>E(!0),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:[(0,b.jsx)(n.Plus,{className:"h-3 w-3"}),"ゲストを追加"]})]}),(0,b.jsx)(h.Input,{type:"text",placeholder:"ゲストを検索...",value:z,onChange:a=>A(a.target.value),className:"bg-white dark:bg-gray-900 mb-2"}),(0,b.jsx)("div",{className:"border rounded-lg p-3 max-h-48 overflow-y-auto bg-gray-50 dark:bg-gray-900",children:0===K.length?(0,b.jsx)("p",{className:"text-sm text-gray-500",children:z?"該当するゲストがいません":"プロフィールがありません"}):(0,b.jsx)("div",{className:"space-y-2",children:K.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Checkbox,{id:`profile-${a.id}`,checked:I.includes(a.id),onCheckedChange:()=>{var b;return b=a.id,void J(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])}}),(0,b.jsx)("label",{htmlFor:`profile-${a.id}`,className:"text-sm cursor-pointer text-gray-700 dark:text-gray-300",children:a.display_name||a.real_name||"名前未設定"})]},a.id))})}),0===I.length&&(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"少なくとも1人のゲストを選択してください"})]}),!s&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(i.Label,{htmlFor:"menu_id",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["ボトル ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>G(!0),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:[(0,b.jsx)(n.Plus,{className:"h-3 w-3"}),"メニューを追加"]})]}),(0,b.jsx)(h.Input,{type:"text",placeholder:"ボトルを検索...",value:B,onChange:a=>C(a.target.value),className:"bg-white dark:bg-gray-900 mb-2"}),(0,b.jsxs)(k.Select,{name:"menu_id",required:!0,children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-white dark:bg-gray-900",children:(0,b.jsx)(k.SelectValue,{placeholder:"ボトルを選択"})}),(0,b.jsx)(k.SelectContent,{children:0===L.length?(0,b.jsx)("div",{className:"p-2 text-sm text-gray-500",children:"該当するボトルがありません"}):L.map(a=>(0,b.jsxs)(k.SelectItem,{value:a.id,children:[a.name," - ¥",a.price.toLocaleString()]},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"remaining_amount",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"残量"}),(0,b.jsxs)(k.Select,{name:"remaining_amount",defaultValue:String(s?.remaining_amount||100),required:!0,children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-white dark:bg-gray-900",children:(0,b.jsx)(k.SelectValue,{placeholder:"残量を選択"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"100",children:"未開封"}),(0,b.jsx)(k.SelectItem,{value:"75",children:"多め"}),(0,b.jsx)(k.SelectItem,{value:"50",children:"半分"}),(0,b.jsx)(k.SelectItem,{value:"25",children:"少なめ"}),(0,b.jsx)(k.SelectItem,{value:"0",children:"無し"})]})]})]}),s&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"status",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ステータス"}),(0,b.jsxs)(k.Select,{name:"status",defaultValue:s?.status||"active",children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-white dark:bg-gray-900",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"active",children:"利用中"}),(0,b.jsx)(k.SelectItem,{value:"empty",children:"空"}),(0,b.jsx)(k.SelectItem,{value:"returned",children:"返却済"})]})]})]}),!s&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"opened_at",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"開栓日"}),(0,b.jsx)(h.Input,{id:"opened_at",name:"opened_at",type:"date",defaultValue:new Date().toISOString().split("T")[0],required:!0,className:"bg-white dark:bg-gray-900"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"expiration_date",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"有効期限 (任意)"}),(0,b.jsx)(h.Input,{id:"expiration_date",name:"expiration_date",type:"date",defaultValue:s?.expiration_date||"",className:"bg-white dark:bg-gray-900"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"memo",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"メモ (任意)"}),(0,b.jsx)(j.Textarea,{id:"memo",name:"memo",defaultValue:s?.memo||"",rows:3,className:"bg-white dark:bg-gray-900 resize-none",placeholder:"備考があれば入力してください"})]}),(0,b.jsxs)(l.DialogFooter,{className:"flex gap-3 pt-4",children:[(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:r,disabled:x,className:"flex-1 min-h-[44px] h-11",children:"キャンセル"}),(0,b.jsx)(g.Button,{type:"submit",disabled:x||0===I.length,className:"flex-1 min-h-[44px] h-11",children:x?"保存中...":s?"更新":"登録"})]})]})]}),(0,b.jsx)(q.UserEditModal,{open:D,onOpenChange:a=>{E(a),a||w.refresh()},profile:null,defaultRole:"guest",isNested:!0}),(0,b.jsx)(p.MenuEditModal,{open:F,onOpenChange:a=>{G(a),a||w.refresh()},menu:null,categories:t.map(a=>a.category).filter((a,b,c)=>c.indexOf(a)===b)})]})}},48036,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11587),e=a.i(13749),f=a.i(96221),g=a.i(5050),h=(0,g.createServerReference)("4045f18647982ea20967cf125e0fa243b6327117e9",g.callServer,void 0,g.findSourceMapURL,"getAttendanceRecords"),i=a.i(56711),j=a.i(2411);function k({isOpen:a,onClose:g,profileId:k,profileName:l,onEditRecord:m}){let[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(new Date().toISOString().slice(0,7));(0,c.useEffect)(()=>{a&&k&&(async()=>{q(!0);try{let a=await h(k);o(a||[])}catch(a){console.error("Failed to fetch records:",a)}finally{q(!1)}})()},[a,k]);let t=a=>a?(0,i.format)(new Date(a),"HH:mm"):"-",u=n.filter(a=>a.work_date.startsWith(r));return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:g,children:(0,b.jsxs)(d.DialogContent,{className:"sm:max-w-[600px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-3",children:[(0,b.jsxs)(d.DialogHeader,{className:"flex flex-col gap-4 mb-4",children:[(0,b.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:g,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0",children:(0,b.jsx)(e.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsxs)(d.DialogTitle,{className:"flex-1 text-center text-lg font-bold text-gray-900 dark:text-white truncate pr-8",children:[l,"の勤怠"]})]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("input",{type:"month",value:r,onChange:a=>s(a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})})]}),p?(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"})}):(0,b.jsx)("div",{className:"space-y-2",children:0===u.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"勤怠データがありません"}):(0,b.jsx)("div",{className:"overflow-hidden rounded-md border border-gray-200 dark:border-gray-700",children:(0,b.jsxs)("table",{className:"w-full text-sm table-fixed",children:[(0,b.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-900/50 text-gray-500 dark:text-gray-400 font-medium",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-center w-1/3",children:"日付"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center w-1/3",children:"開始"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center w-1/3",children:"終了"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:u.map(a=>(0,b.jsxs)("tr",{onClick:()=>m(a),className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-center text-gray-900 dark:text-gray-100",children:(0,i.format)(new Date(a.work_date),"M/d (EEE)",{locale:j.ja})}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-gray-600 dark:text-gray-300",children:t(a.clock_in)}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-gray-600 dark:text-gray-300",children:t(a.clock_out)})]},a.id))})]})})})]})})}a.s(["UserAttendanceListModal",()=>k],48036)},18697,a=>{"use strict";a.s(["UserEditModal",()=>P],18697);var b=a.i(87924),c=a.i(72131),d=a.i(13749),e=a.i(17755),f=a.i(92759),g=a.i(83415),h=a.i(76472),i=a.i(10448),j=a.i(81560),k=a.i(73320),l=a.i(45750),m=a.i(92772),n=a.i(2783),o=a.i(62403),p=a.i(11587),q=a.i(82038),r=a.i(98036),s=a.i(57017),t=a.i(69613),u=a.i(78976),v=a.i(74601),w=a.i(69574),x=a.i(50238),y=a.i(35350),z=a.i(46478),A=a.i(61846),B=a.i(76673);a.i(89100);var C=a.i(53627),D=a.i(65215),E=a.i(81278),F=a.i(50944),G=a.i(48036),H=a.i(84064),I=a.i(87532),J=a.i(33441),K=a.i(11883);let L={cast:"キャスト",staff:"スタッフ",guest:"ゲスト"};function M({isOpen:a,onClose:e,title:f,profiles:h,selectedIds:i,onSelectionChange:j,currentProfileId:k}){let[n,o]=(0,c.useState)(""),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(i);(0,c.useEffect)(()=>{t(i)},[i]),(0,c.useEffect)(()=>{a||(o(""),r(null))},[a]);let u=h.filter(a=>a.id!==k).filter(a=>{let b=!n||a.display_name?.toLowerCase().includes(n.toLowerCase())||a.real_name?.toLowerCase().includes(n.toLowerCase()),c=!q||a.role===q;return b&&c}),v=()=>{t(i),e()};return(0,b.jsx)(p.Dialog,{open:a,onOpenChange:a=>{a||v()},children:(0,b.jsxs)(p.DialogContent,{className:"sm:max-w-[600px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] flex flex-col p-0",onPointerDownOutside:a=>{a.preventDefault(),v()},onEscapeKeyDown:a=>{a.preventDefault(),v()},onInteractOutside:a=>{a.preventDefault()},children:[(0,b.jsxs)(p.DialogHeader,{className:"flex flex-row items-center justify-between gap-2 px-3 py-6 pb-4 relative",children:[(0,b.jsx)("button",{type:"button",onClick:v,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0","aria-label":"戻る",children:(0,b.jsx)(d.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)(p.DialogTitle,{className:"flex-1 text-center text-xl md:text-2xl font-bold text-gray-900 dark:text-white truncate",children:f}),(0,b.jsx)("div",{className:"w-8 h-8"})]}),(0,b.jsxs)("div",{className:"px-3 space-y-4 flex-1 overflow-hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(I.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)(m.Input,{type:"text",placeholder:"名前で検索...",value:n,onChange:a=>o(a.target.value),className:"pl-10 rounded-md"})]}),(0,b.jsxs)("div",{className:"inline-flex h-9 items-center rounded-full bg-gray-100 dark:bg-gray-800 p-1 text-xs",children:[(0,b.jsx)("button",{onClick:()=>r(null),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${null===q?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"すべて"}),["cast","staff","guest"].map(a=>(0,b.jsx)("button",{onClick:()=>r(a),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${q===a?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:L[a]},a))]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto -mx-3 px-3",children:(0,b.jsx)("div",{className:"space-y-1.5",children:0===u.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"該当するメンバーが見つかりません"}):u.map(a=>(0,b.jsxs)("button",{onClick:()=>{var b;return b=a.id,void t(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"w-full flex items-center gap-2.5 p-2.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[(0,b.jsxs)(K.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(K.AvatarImage,{src:a.avatar_url||""}),(0,b.jsx)(K.AvatarFallback,{className:"bg-gray-200 dark:bg-gray-700",children:(0,b.jsx)(g.UserCircle,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})})]}),(0,b.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:a.display_name||a.real_name||"名前なし"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:L[a.role]||a.role})]}),(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${s.includes(a.id)?"bg-blue-600 border-blue-600":"border-gray-300 dark:border-gray-600"}`,children:s.includes(a.id)&&(0,b.jsx)(J.Check,{className:"h-3 w-3 text-white"})})})]},a.id))})})]}),(0,b.jsxs)("div",{className:"px-3 py-6 pt-4 border-t border-gray-200 dark:border-gray-700 space-y-3",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:[s.length,"人選択中"]}),(0,b.jsx)(l.Button,{onClick:()=>{j(s),e()},className:"w-full rounded-full",children:"保存する"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:v,className:"w-full rounded-full border-gray-300 dark:border-gray-600",children:"キャンセル"})]})]})})}var N=a.i(56711),O=a.i(12144);function P({profile:a,open:I,onOpenChange:J,isNested:L=!1,defaultRole:Q}){let R=(0,F.useSearchParams)(),S=Q||R.get("role")||"cast",[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(a?.role??S),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(null),ad=(0,F.useRouter)(),[ae,af]=(0,c.useState)([]),[ag,ah]=(0,c.useState)([]),[ai,aj]=(0,c.useState)([]),[ak,al]=(0,c.useState)(""),[am,an]=(0,c.useState)(!1),[ao,ap]=(0,c.useState)(null),[aq,ar]=(0,c.useState)(null),[as,at]=(0,c.useState)(""),[au,av]=(0,c.useState)(null),[aw,ax]=(0,c.useState)(null),[ay,az]=(0,c.useState)(null),[aA,aB]=(0,c.useState)(null),[aC,aD]=(0,c.useState)([]),[aE,aF]=(0,c.useState)([]),[aG,aH]=(0,c.useState)(!1),aI=c.default.useRef(null),aJ=async b=>{let c=b.target.files?.[0];if(!c||!a)return;let d=new FormData;d.append("file",c);try{await (0,B.uploadProfileAvatar)(a.id,d),ad.refresh()}catch(a){console.error("Avatar upload failed:",a),alert("アップロードに失敗しました")}};(0,c.useEffect)(()=>{W(a?.role??S)},[a,S]);let aK=c.default.useRef(void 0),aL=c.default.useCallback(()=>{a&&(aK.current&&clearTimeout(aK.current),aK.current=setTimeout(async()=>{let a=document.querySelector("form[data-profile-form]");if(!a)return;let b=new FormData(a);try{await (0,q.updateUser)(b)}catch(a){console.error("Auto-save failed:",a)}},1e3))},[a]);(0,c.useEffect)(()=>{I?(async()=>{an(!0);try{let b=await (0,z.getAllProfiles)();af(b);let c=await (0,A.getCurrentUserProfileId)();if(ap(c),a){let b=await (0,t.getProfileDetails)(a.id);b&&(ah(b.relationships),aj(b.comments))}}catch(a){console.error("Failed to fetch details:",a)}finally{an(!1)}})():(ah([]),aj([]),aD([]),aF([]),al(""),ar(null),av(null))},[I,a]),(0,c.useEffect)(()=>{I&&a&&"guest"===a.role&&(async()=>{aD(await (0,C.getUserBottleKeeps)(a.id))})()},[I,a]),(0,c.useEffect)(()=>{I&&(async()=>{aF(await (0,D.getMenus)())})()},[I]);let aM=async()=>{a&&aD(await (0,C.getUserBottleKeeps)(a.id))},aN=async()=>{if(!a)return;let b=await (0,t.getProfileDetails)(a.id);b&&aj(b.comments)},aO=async b=>{U(!0);try{a?await (0,q.updateUser)(b):await (0,r.createUser)(b),J(!1),ad.refresh()}catch(a){console.error("Failed to save user:",a),alert("ユーザーの保存に失敗しました")}finally{U(!1)}},aP=async()=>{if(a){U(!0);try{await (0,s.deleteUser)(a.id),aa(!1),J(!1),ad.refresh()}catch(a){console.error("Failed to delete user:",a),alert("ユーザーの削除に失敗しました")}finally{U(!1)}}},aQ=async(b,c)=>{if(a)try{await (0,u.updateProfileRelationships)(a.id,b,c);let d=await (0,t.getProfileDetails)(a.id);d&&ah(d.relationships)}catch(a){console.error(`Failed to update ${b}:`,a)}},aR=async()=>{if(a&&ak.trim())try{await (0,v.addProfileComment)(a.id,ak),al(""),await aN()}catch(a){console.error("Failed to add comment:",a)}},aS=async a=>{if(as.trim())try{await (0,w.updateProfileComment)(a,as),ar(null),at(""),await aN()}catch(a){console.error("Failed to update comment:",a)}},aT=async a=>{try{await (0,x.deleteProfileComment)(a),ax(null),await aN()}catch(a){console.error("Failed to delete comment:",a)}},aU=async a=>{try{await (0,y.toggleCommentLike)(a),await aN()}catch(a){console.error("Failed to toggle like:",a)}},aV=b=>a?ag.filter(a=>a.relationship_type===b).map(b=>b.source_profile_id===a.id?b.target_profile_id:b.source_profile_id):[],aW=a=>{let b=aV(a);return ae.filter(a=>b.includes(a.id))};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Dialog,{open:I,onOpenChange:J,children:(0,b.jsxs)(p.DialogContent,{className:"sm:max-w-[600px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-6",onPointerDownOutside:a=>{a.preventDefault(),J(!1)},onEscapeKeyDown:a=>{a.preventDefault(),J(!1)},onInteractOutside:a=>{a.preventDefault()},children:[(0,b.jsxs)(p.DialogHeader,{className:"flex flex-row items-center justify-between gap-2 relative",children:[(0,b.jsx)("button",{type:"button",onClick:()=>J(!1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0","aria-label":"戻る",children:(0,b.jsx)(d.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)(p.DialogTitle,{className:"flex-1 text-center text-xl md:text-2xl font-bold text-gray-900 dark:text-white truncate",children:a?a.display_name||"ユーザー編集":"新規作成"}),a?(0,b.jsx)("button",{type:"button",onClick:()=>Y(!X),className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700","aria-label":"オプション",children:(0,b.jsx)(e.MoreHorizontal,{className:"h-4 w-4"})}):(0,b.jsx)("div",{className:"w-8 h-8"}),X&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>Y(!1)}),(0,b.jsxs)("div",{className:"absolute right-0 top-10 z-50 w-40 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg p-2 flex flex-col gap-1 text-sm animate-in fade-in zoom-in-95 duration-100",children:[(0,b.jsx)("button",{type:"button",className:"w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>{Y(!1),$(!0)},children:"勤怠一覧"}),a?.id!==ao&&(0,b.jsx)("button",{type:"button",className:"w-full text-left px-3 py-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{Y(!1),aa(!0)},children:"削除"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("form",{action:aO,className:"space-y-4","data-profile-form":!0,onChange:aL,children:[a&&(0,b.jsx)("input",{type:"hidden",name:"profileId",value:a.id}),(0,b.jsx)("input",{type:"hidden",name:"role",value:V}),a&&(0,b.jsx)("div",{className:"flex flex-col items-center gap-4 mb-6",children:(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsxs)(K.Avatar,{className:"h-24 w-24 cursor-pointer",onClick:()=>{a&&aI.current?.click()},children:[(0,b.jsx)(K.AvatarImage,{src:a.avatar_url||"",className:"object-cover"}),(0,b.jsx)(K.AvatarFallback,{className:"bg-gray-100 dark:bg-gray-800 text-2xl",children:a.display_name?.[0]||(0,b.jsx)(g.UserCircle,{className:"h-12 w-12"})}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 rounded-full opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity",children:(0,b.jsx)(k.Upload,{className:"h-6 w-6 text-white"})})]}),(0,b.jsx)("input",{type:"file",ref:aI,className:"hidden",accept:"image/*",onChange:aJ})]})}),!a&&(0,b.jsx)("div",{className:"flex justify-center mb-2",children:(0,b.jsxs)("div",{className:"inline-flex h-9 items-center rounded-full bg-gray-100 dark:bg-gray-800 p-1 text-xs",children:[(0,b.jsx)("button",{type:"button",onClick:()=>W("cast"),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${"cast"===V?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"キャスト"}),(0,b.jsx)("button",{type:"button",onClick:()=>W("staff"),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${"staff"===V?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"スタッフ"}),(0,b.jsx)("button",{type:"button",onClick:()=>W("guest"),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${"guest"===V?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"ゲスト"})]})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"displayName",children:"表示名"}),(0,b.jsx)(m.Input,{id:"displayName",name:"displayName",defaultValue:a?.display_name||"",placeholder:"表示名",className:"rounded-md",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"displayNameKana",children:"表示名（かな）"}),(0,b.jsx)(m.Input,{id:"displayNameKana",name:"displayNameKana",defaultValue:a?.display_name_kana||"",placeholder:"ひょうじめい",className:"rounded-md",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"realName",children:"本名"}),(0,b.jsx)(m.Input,{id:"realName",name:"realName",defaultValue:a?.real_name||"",placeholder:"本名",className:"rounded-md"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"realNameKana",children:"本名（かな）"}),(0,b.jsx)(m.Input,{id:"realNameKana",name:"realNameKana",defaultValue:a?.real_name_kana||"",placeholder:"ほんみょう",className:"rounded-md"})]})]}),"guest"===V&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"guestAddressee",children:"宛名"}),(0,b.jsx)(m.Input,{id:"guestAddressee",name:"guestAddressee",type:"text",defaultValue:a?.guest_addressee??"",placeholder:"例: 山田様",className:"rounded-md"})]}),"guest"===V&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"guestReceiptType",children:"領収書"}),(0,b.jsxs)(o.Select,{name:"guestReceiptType",defaultValue:a?.guest_receipt_type||"none",children:[(0,b.jsx)(o.SelectTrigger,{className:"rounded-md",children:(0,b.jsx)(o.SelectValue,{placeholder:"領収書の種類を選択"})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"none",children:"なし"}),(0,b.jsx)(o.SelectItem,{value:"amount_only",children:"金額のみ"}),(0,b.jsx)(o.SelectItem,{value:"with_date",children:"日付入り"})]})]})]}),a&&"guest"===V&&(0,b.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"キープボトル"}),(0,b.jsx)("button",{type:"button",onClick:()=>aH(!0),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:"+ 追加"})]}),(0,b.jsx)("div",{className:"space-y-2",children:0===aC.length?(0,b.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"ボトルはありません"}):aC.map(a=>(0,b.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:a.menu_name}),(0,b.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["残量: ",a.remaining_amount,"%",a.expiration_date&&` / 期限: ${(0,N.format)(new Date(a.expiration_date),"yyyy/MM/dd")}`]})]})},a.id))})]}),!a&&(0,b.jsx)(p.DialogFooter,{className:"mt-6",children:(0,b.jsxs)("div",{className:"flex flex-col w-full gap-3",children:[(0,b.jsx)(l.Button,{type:"submit",disabled:T,className:"w-full rounded-full h-10",children:T?"作成中...":"作成する"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>J(!1),className:"w-full rounded-full border-gray-300 dark:border-gray-600 h-10",children:"キャンセル"})]})})]},a?.id||"new"),a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"相性"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(n.Label,{className:"text-xs text-gray-500",children:"相性 ◯"}),(0,b.jsx)("button",{type:"button",onClick:()=>az("compatibility_good"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:0===aW("compatibility_good").length?(0,b.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):aW("compatibility_good").map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>aB(a.id),className:"px-3 py-1.5 rounded-full bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-sm hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:a.display_name||a.real_name||"名前なし"},a.id))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(n.Label,{className:"text-xs text-gray-500",children:"相性 ✕"}),(0,b.jsx)("button",{type:"button",onClick:()=>az("compatibility_bad"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:0===aW("compatibility_bad").length?(0,b.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):aW("compatibility_bad").map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>aB(a.id),className:"px-3 py-1.5 rounded-full bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 text-sm hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:a.display_name||a.real_name||"名前なし"},a.id))})]})]})]}),("cast"===V||"guest"===V)&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(n.Label,{children:"指名"}),(0,b.jsx)("button",{type:"button",onClick:()=>az("nomination"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:0===aW("nomination").length?(0,b.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):aW("nomination").map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>aB(a.id),className:"px-3 py-1.5 rounded-full bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 text-sm hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-colors",children:a.display_name||a.real_name||"名前なし"},a.id))})]}),("cast"===V||"staff"===V)&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(n.Label,{children:"担当"}),(0,b.jsx)("button",{type:"button",onClick:()=>az("in_charge"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:0===aW("in_charge").length?(0,b.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):aW("in_charge").map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>aB(a.id),className:"px-3 py-1.5 rounded-full bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 text-sm hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors",children:a.display_name||a.real_name||"名前なし"},a.id))})]})]}),(0,b.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 space-y-4",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"コメント"}),(0,b.jsxs)("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:[ai.map(a=>(0,b.jsxs)("div",{className:"flex gap-3 items-start bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg relative",children:[(0,b.jsxs)(K.Avatar,{className:"h-6 w-6",children:[(0,b.jsx)(K.AvatarImage,{src:a.author?.avatar_url||""}),(0,b.jsx)(K.AvatarFallback,{className:"bg-gray-200 dark:bg-gray-700",children:(0,b.jsx)(g.UserCircle,{className:"h-6 w-6 text-gray-700 dark:text-gray-300"})})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:a.author?.display_name||"不明なユーザー"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,b.jsx)("span",{className:"text-xs text-gray-500",children:(0,N.format)(new Date(a.updated_at),"yyyy/MM/dd")}),a.author?.id===ao&&(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("button",{type:"button",onClick:()=>av(au===a.id?null:a.id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:(0,b.jsx)(e.MoreHorizontal,{className:"h-3 w-3 text-gray-700 dark:text-gray-300"})}),au===a.id&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 z-40",onClick:a=>{a.stopPropagation(),av(null)}}),(0,b.jsxs)("div",{className:"absolute right-0 top-6 z-50 w-24 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg p-1 flex flex-col gap-1 text-xs",children:[(0,b.jsxs)("button",{type:"button",className:"w-full text-left px-2 py-1.5 rounded flex items-center gap-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>{ar(a.id),at(a.content),av(null)},children:[(0,b.jsx)(i.Edit2,{className:"h-3 w-3"}),"編集"]}),(0,b.jsxs)("button",{type:"button",className:"w-full text-left px-2 py-1.5 rounded flex items-center gap-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{ax(a.id),av(null)},children:[(0,b.jsx)(j.Trash2,{className:"h-3 w-3"}),"削除"]})]})]})]})]})]}),aq===a.id?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(O.Textarea,{value:as,onChange:a=>at(a.target.value),className:"min-h-[60px]"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(l.Button,{type:"button",size:"sm",onClick:()=>aS(a.id),children:"保存"}),(0,b.jsx)(l.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{ar(null),at("")},children:"キャンセル"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words",children:a.content}),(0,b.jsxs)("button",{type:"button",onClick:()=>aU(a.id),className:`flex items-center gap-1 text-xs transition-colors ${a.user_has_liked?"text-pink-500 dark:text-pink-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[(0,b.jsx)(h.Heart,{className:`h-3 w-3 ${a.user_has_liked?"fill-current":""}`}),(0,b.jsx)("span",{children:a.like_count>0?a.like_count:"いいね"})]})]})]})]},a.id)),0===ai.length&&(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-2",children:"コメントはありません"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(m.Input,{value:ak,onChange:a=>al(a.target.value),placeholder:"コメントを入力...",className:"flex-1 h-10",onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),aR())}}),(0,b.jsx)(l.Button,{type:"button",size:"icon",onClick:aR,disabled:!ak.trim(),className:"h-10 w-10",children:(0,b.jsx)(f.Send,{className:"h-4 w-4"})})]})]})]})]})]})}),!L&&a&&"guest"===a.role&&(0,b.jsx)(E.BottleModal,{isOpen:aG,onClose:()=>{aH(!1),aM()},menus:aE,profiles:ae,initialProfileIds:a?[a.id]:[]}),(0,b.jsx)(p.Dialog,{open:!!aw,onOpenChange:a=>!a&&ax(null),children:(0,b.jsxs)(p.DialogContent,{className:"sm:max-w-[400px] bg-white dark:bg-gray-800 w-[90%] rounded-lg p-6",children:[(0,b.jsx)(p.DialogHeader,{children:(0,b.jsx)(p.DialogTitle,{className:"text-center text-lg font-bold text-gray-900 dark:text-white",children:"コメントを削除"})}),(0,b.jsxs)("div",{className:"py-4 text-center text-gray-600 dark:text-gray-300",children:[(0,b.jsx)("p",{children:"本当にこのコメントを削除しますか？"}),(0,b.jsx)("p",{className:"text-sm mt-2 text-gray-500",children:"この操作は取り消せません。"})]}),(0,b.jsxs)(p.DialogFooter,{className:"flex-col sm:flex-row gap-3",children:[(0,b.jsx)(l.Button,{type:"button",variant:"destructive",onClick:()=>aw&&aT(aw),className:"w-full rounded-full bg-red-600 hover:bg-red-700 text-white h-10",children:"削除"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>ax(null),className:"w-full rounded-full border-gray-300 dark:border-gray-600 h-10",children:"キャンセル"})]})]})}),(0,b.jsx)(p.Dialog,{open:_,onOpenChange:aa,children:(0,b.jsxs)(p.DialogContent,{className:"sm:max-w-[400px] bg-white dark:bg-gray-800 w-[95%] rounded-lg p-6",children:[(0,b.jsx)(p.DialogHeader,{children:(0,b.jsx)(p.DialogTitle,{className:"text-center text-lg font-bold text-gray-900 dark:text-white",children:"ユーザーを削除"})}),(0,b.jsxs)("div",{className:"py-4 text-center text-gray-600 dark:text-gray-300",children:[(0,b.jsxs)("p",{children:["本当に「",a?.display_name,"」を削除しますか？"]}),(0,b.jsx)("p",{className:"text-sm mt-2 text-gray-500",children:"この操作は取り消せません。"})]}),(0,b.jsxs)(p.DialogFooter,{className:"flex-col sm:flex-row gap-3",children:[(0,b.jsx)(l.Button,{type:"button",variant:"destructive",onClick:aP,disabled:T,className:"w-full rounded-full bg-red-600 hover:bg-red-700 text-white h-10",children:T?"削除中...":"削除"}),(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>aa(!1),disabled:T,className:"w-full rounded-full border-gray-300 dark:border-gray-600 h-10",children:"キャンセル"})]})]})}),a&&(0,b.jsx)(G.UserAttendanceListModal,{isOpen:Z,onClose:()=>$(!1),profileId:a.id,profileName:a.display_name||"メンバー",onEditRecord:a=>ac(a)}),ab&&a&&(0,b.jsx)(H.AttendanceModal,{isOpen:!!ab,onClose:()=>ac(null),profiles:[a],currentProfileId:a.id,editingRecord:ab}),a&&ay&&(0,b.jsx)(M,{isOpen:!!ay,onClose:()=>az(null),title:"compatibility_good"===ay?"相性 ◯":"compatibility_bad"===ay?"相性 ✕":"nomination"===ay?"指名":"担当",profiles:ae,selectedIds:aV(ay),onSelectionChange:a=>{ay&&aQ(ay,a)},currentProfileId:a.id}),aA&&(0,b.jsx)(P,{open:!!aA,onOpenChange:a=>!a&&aB(null),profile:ae.find(a=>a.id===aA)||null,isNested:!0})]})}}];

//# sourceMappingURL=_42d1795c._.js.map