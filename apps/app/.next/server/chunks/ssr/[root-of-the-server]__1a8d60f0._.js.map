{"version":3,"sources":["../../../../../../apps/app/src/app/app/%28main%29/bottles/bottle-list.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/app/src/app/app/%28main%29/bottles/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const BottleList = registerClientReference(\n    function() { throw new Error(\"Attempted to call BottleList() from the server but BottleList is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/app/src/app/app/(main)/bottles/bottle-list.tsx\",\n    \"BottleList\",\n);\n","import { Suspense } from \"react\";\nimport type { Metadata } from \"next\";\nimport { redirect } from \"next/navigation\";\nimport { createServerClient } from \"@/lib/supabaseServerClient\";\nimport { BottleList } from \"./bottle-list\";\nimport { getMenus } from \"../menus/actions\";\n\nexport const metadata: Metadata = {\n    title: \"ボトルキープ管理\",\n};\n\nasync function getBottlesPageData() {\n    const supabase = await createServerClient();\n    const { data: { user } } = await supabase.auth.getUser();\n\n    if (!user) {\n        redirect(\"/login\");\n    }\n\n    const { data: appUser } = await supabase\n        .from(\"users\")\n        .select(\"current_profile_id\")\n        .eq(\"id\", user.id)\n        .maybeSingle();\n\n    if (!appUser?.current_profile_id) {\n        redirect(\"/app/me\");\n    }\n\n    const { data: currentProfile } = await supabase\n        .from(\"profiles\")\n        .select(\"store_id\")\n        .eq(\"id\", appUser.current_profile_id)\n        .maybeSingle();\n\n    if (!currentProfile?.store_id) {\n        redirect(\"/app/me\");\n    }\n\n    // Fetch menus for bottle selection\n    const menus = await getMenus();\n\n    // Fetch all profiles in this store (for guest selection)\n    const { data: profiles } = await supabase\n        .from(\"profiles\")\n        .select(\"id, display_name, role\")\n        .eq(\"store_id\", currentProfile.store_id)\n        .order(\"display_name\");\n\n    return {\n        storeId: currentProfile.store_id,\n        menus: menus || [],\n        profiles: profiles || [],\n    };\n}\n\nfunction BottlesSkeleton() {\n    return (\n        <div className=\"space-y-4 animate-pulse\">\n            <div className=\"h-8 w-1/3 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n            <div className=\"h-4 w-1/2 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n            <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n    );\n}\n\nexport default async function BottlesPage() {\n    const data = await getBottlesPageData();\n\n    return (\n        <div className=\"space-y-4\">\n            <div className=\"flex flex-col gap-2\">\n                <h1 className=\"text-xl md:text-2xl font-bold tracking-tight text-gray-900 dark:text-white\">\n                    ボトルキープ管理\n                </h1>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                    お客様のボトルキープを管理します。\n                </p>\n            </div>\n\n            <Suspense fallback={<BottlesSkeleton />}>\n                <BottleList\n                    storeId={data.storeId}\n                    menus={data.menus}\n                    profiles={data.profiles}\n                />\n            </Suspense>\n        </div>\n    );\n}\n\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 0;\n"],"names":[],"mappings":"+VAEO,IAAM,EAAa,CAAA,EAAA,AAD1B,EAAA,CAAA,CAAA,OAC0B,uBAAA,AAAuB,EAC7C,WAAa,MAAM,AAAI,MAAM,kOAAoO,EACjQ,oFACA,8DAHG,IAAM,EAAa,CAAA,EAD1B,AAC0B,EAD1B,CAAA,CAAA,OAC0B,uBAAA,AAAuB,EAC7C,WAAa,MAAM,AAAI,MAAM,kOAAoO,EACjQ,gEACA,wICLJ,EAAA,EAAA,CAAA,CAAA,KAEA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OAMA,eAAe,IACX,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,kBAAA,AAAkB,IACnC,CAAE,KAAM,MAAE,CAAI,CAAE,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,EAElD,CAAC,GACD,CAAA,EADO,AACP,EAAA,QAAA,AAAQ,EAAC,UAGb,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,SACL,MAAM,CAAC,sBACP,EAAE,CAAC,KAAM,EAAK,EAAE,EAChB,WAAW,EAEZ,CAAC,GAAS,oBAAoB,AAC9B,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,WAGb,GAAM,CAAE,KAAM,CAAc,CAAE,CAAG,MAAM,EAClC,IAAI,CAAC,YACL,MAAM,CAAC,YACP,EAAE,CAAC,KAAM,EAAQ,kBAAkB,EACnC,WAAW,EAEZ,CAAC,GAAgB,UAAU,AAC3B,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,WAIb,IAAM,EAAQ,MAAM,CAAA,EAAA,EAAA,QAAQ,AAAR,IAGd,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAC5B,IAAI,CAAC,YACL,MAAM,CAAC,0BACP,EAAE,CAAC,WAAY,EAAe,QAAQ,EACtC,KAAK,CAAC,gBAEX,MAAO,CACH,QAAS,EAAe,QAAQ,CAChC,MAAO,GAAS,EAAE,CAClB,SAAU,GAAY,EAAE,AAC5B,CACJ,CAEA,SAAS,IACL,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gDAG3B,CAEe,eAAe,IAC1B,IAAM,EAAO,MAAM,IAEnB,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gCACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sFAA6E,aAG3F,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,yBAK5D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,SAAU,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAA,YACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACP,QAAS,EAAK,OAAO,CACrB,MAAO,EAAK,KAAK,CACjB,SAAU,EAAK,QAAQ,OAK3C,kCAEuB,6BApFW,CAC9B,MAAO,UACX,iBAmF0B","ignoreList":[0]}