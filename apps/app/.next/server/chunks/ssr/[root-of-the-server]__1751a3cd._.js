module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},64240,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},790,(a,b,c)=>{let{createClientModuleProxy:d}=a.r(11857);a.n(d("[project]/node_modules/next/dist/client/app-dir/link.js <module evaluation>"))},84707,(a,b,c)=>{let{createClientModuleProxy:d}=a.r(11857);a.n(d("[project]/node_modules/next/dist/client/app-dir/link.js"))},97647,a=>{"use strict";a.i(790);var b=a.i(84707);a.n(b)},95936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={default:function(){return i},useLinkStatus:function(){return h.useLinkStatus}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(64240),g=a.r(7997),h=f._(a.r(97647));function i(a){let b=a.legacyBehavior,c="string"==typeof a.children||"number"==typeof a.children||"string"==typeof a.children?.type,d=a.children?.type?.$$typeof===Symbol.for("react.client.reference");return!b||c||d||(a.children?.type?.$$typeof===Symbol.for("react.lazy")?console.error("Using a Lazy Component as a direct child of `<Link legacyBehavior>` from a Server Component is not supported. If you need legacyBehavior, wrap your Lazy Component in a Client Component that renders the Link's `<a>` tag."):console.error("Using a Server Component as a direct child of `<Link legacyBehavior>` is not supported. If you need legacyBehavior, wrap your Server Component in a Client Component that renders the Link's `<a>` tag.")),(0,g.jsx)(h.default,{...a})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},83296,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ClockInForm() from the server but ClockInForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/app/src/app/tablet/timecard/[storeId]/ClockInForm.tsx <module evaluation>","ClockInForm");a.s(["ClockInForm",0,b])},67452,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ClockInForm() from the server but ClockInForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/app/src/app/tablet/timecard/[storeId]/ClockInForm.tsx","ClockInForm");a.s(["ClockInForm",0,b])},63640,a=>{"use strict";a.i(83296);var b=a.i(67452);a.n(b)},43600,a=>{"use strict";var b=a.i(7997),c=a.i(95936),d=a.i(73918),e=a.i(69570),f=a.i(63640);let g=[{label:"あ",chars:"あいうえお"},{label:"か",chars:"かきくけこ"},{label:"さ",chars:"さしすせそ"},{label:"た",chars:"たちつてと"},{label:"な",chars:"なにぬねの"},{label:"は",chars:"はひふへほ"},{label:"ま",chars:"まみむめも"},{label:"や",chars:"やゆよ"},{label:"ら",chars:"らりるれろ"},{label:"わ",chars:"わをん"}];function h(a){let b=(a||"").trim().charAt(0);if(!b)return"その他";for(let a of g)if(a.chars.includes(b))return a.label;return"その他"}function i(a){if(!a)return"-";let b=new Date(a);return Number.isNaN(b.getTime())?"-":b.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})}function j(a){if(!a)return null;let b=a.split(":"),c=Number(b[0]??"0"),d=Number(b[1]??"0");return Number.isNaN(c)||Number.isNaN(d)?null:60*c+d}async function k(a){let k=await a.params,l=await a.searchParams,m=k.storeId,n="clockOut"===l.mode?"clockOut":"clockIn"===l.mode?"clockIn":null,o=l.profileId||null,p=l.kanaGroup||null,q=(0,d.createServiceRoleClient)(),{data:r}=await q.from("stores").select("id, name, tablet_timecard_enabled, tablet_theme, tablet_allowed_roles, tablet_acceptance_start_time, tablet_acceptance_end_time").eq("id",m).maybeSingle(),s=r?.tablet_theme==="dark",t=s?"bg-slate-900 text-white":"bg-gray-50 text-gray-900",u=s?"border-slate-700":"border-gray-200",v=s?"bg-slate-800":"bg-white",w=s?"text-gray-400":"text-gray-600";if(!r||!1===r.tablet_timecard_enabled)return(0,b.jsx)("div",{className:`min-h-screen flex items-center justify-center ${t}`,children:(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("p",{className:"text-lg font-semibold",children:"タブレット用タイムカードは利用できません"}),(0,b.jsx)("p",{className:`text-sm ${w}`,children:"店舗の設定画面でタブレット用タイムカードを有効化してください。"})]})});if(!function(a,b){let c=j(a),d=j(b);if(null===c&&null===d)return!0;let e=new Date,f=60*e.getHours()+e.getMinutes();return null===c&&null!==d?f<=d:null!==c&&null===d?f>=c:null===c||null===d||(c<=d?f>=c&&f<=d:f>=c||f<=d)}(r.tablet_acceptance_start_time,r.tablet_acceptance_end_time))return(0,b.jsx)("div",{className:`min-h-screen flex items-center justify-center ${t}`,children:(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("p",{className:"text-lg font-semibold",children:"現在はタブレット打刻の受付時間外です"}),(0,b.jsx)("p",{className:`text-sm ${w}`,children:"受付時間の設定を確認してください。"})]})});let x=new Date(new Date().getTime()+324e5).toISOString().split("T")[0],{data:y}=await q.from("profiles").select("id, display_name, display_name_kana").eq("store_id",m),z=y||[],A=new Map;z.forEach(a=>A.set(a.id,a));let B=z.map(a=>a.id),C=[];if(B.length>0){let{data:a}=await q.from("time_cards").select("id, user_id, work_date, clock_in, clock_out").eq("work_date",x).in("user_id",B);C=a||[]}let D={};if(B.length>0){let{data:a}=await q.from("time_cards").select("user_id, pickup_destination").not("pickup_destination","is",null).in("user_id",B);for(let b of a||[]){let a=b.user_id,c=b.pickup_destination?.trim();c&&(D[a]||(D[a]=[]),D[a].includes(c)||D[a].push(c))}}let E=`/tablet/timecard/${m}`,F=o&&A.get(o)||null,G=l.role,H=r?.tablet_allowed_roles??["staff","cast"],I=H.includes("staff")&&H.includes("cast"),J="string"==typeof G&&H.includes(G)?G:null,K=1;return n?I&&!J?K=2:!n||p||F?n&&p&&!F?K=4:n&&F&&(K=5):K=3:K=1,(0,b.jsxs)("div",{className:`min-h-screen ${t} flex flex-col lg:flex-row`,children:[(0,b.jsx)("div",{className:`w-full lg:w-1/2 border-b lg:border-b-0 lg:border-r ${u} p-6 lg:p-10 flex flex-col`,children:(0,b.jsxs)("div",{className:`flex-1 overflow-auto rounded-xl ${v} border ${u} p-4 lg:p-6`,children:[(0,b.jsx)("h2",{className:`text-lg font-semibold mb-4 text-center ${s?"text-white":"text-gray-900"}`,children:"本日の出勤状況"}),0===C.length?(0,b.jsx)("p",{className:`text-sm ${w}`,children:"まだ本日の打刻はありません。"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:`border-b ${u} ${s?"bg-slate-900/40":"bg-gray-50"}`,children:[(0,b.jsx)("th",{className:`text-center py-2 px-3 font-semibold ${w} w-1/3`,children:"名前"}),(0,b.jsx)("th",{className:`text-center py-2 px-3 font-semibold ${w} w-1/3`,children:"出勤"}),(0,b.jsx)("th",{className:`text-center py-2 px-3 font-semibold ${w} w-1/3`,children:"退勤"})]})}),(0,b.jsx)("tbody",{children:C.sort((a,b)=>(b.clock_in||"").localeCompare(a.clock_in||"")).map(a=>{let c=A.get(a.user_id);return(0,b.jsxs)("tr",{className:`border-b ${s?"border-slate-700 hover:bg-slate-700":"border-gray-100 hover:bg-gray-50"}`,children:[(0,b.jsx)("td",{className:"py-2 px-3 font-medium text-center",children:c?.display_name||"(不明)"}),(0,b.jsx)("td",{className:"py-2 px-3 text-center",children:i(a.clock_in)}),(0,b.jsx)("td",{className:"py-2 px-3 text-center",children:i(a.clock_out)})]},a.id)})})]})})]})}),(0,b.jsxs)("div",{className:"w-full lg:w-1/2 p-6 lg:p-10 flex flex-col gap-6",children:[1===K&&(0,b.jsxs)("div",{className:"flex-1 flex flex-col gap-6",children:[(0,b.jsx)(c.default,{href:`${E}?mode=clockIn`,className:"flex-1 flex items-center justify-center rounded-2xl bg-blue-500 hover:bg-blue-600 text-white text-5xl font-bold shadow-lg transition-colors",children:"出勤する"}),(0,b.jsx)(c.default,{href:`${E}?mode=clockOut`,className:"flex-1 flex items-center justify-center rounded-2xl bg-rose-500 hover:bg-rose-600 text-white text-5xl font-bold shadow-lg transition-colors",children:"退勤する"})]}),2===K&&n&&I&&(0,b.jsxs)("div",{className:"flex-1 flex flex-col gap-6",children:[(0,b.jsxs)(c.default,{href:E,className:`self-start flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s?"bg-slate-700 hover:bg-slate-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"戻る"]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col gap-6",children:[(0,b.jsx)(c.default,{href:`${E}?mode=${n}&role=staff`,className:"flex-1 flex items-center justify-center rounded-2xl bg-emerald-500 hover:bg-emerald-600 text-white text-5xl font-bold shadow-lg transition-colors",children:"スタッフで打刻"}),(0,b.jsx)(c.default,{href:`${E}?mode=${n}&role=cast`,className:"flex-1 flex items-center justify-center rounded-2xl bg-purple-500 hover:bg-purple-600 text-white text-5xl font-bold shadow-lg transition-colors",children:"キャストで打刻"})]})]}),3===K&&n&&(0,b.jsxs)("div",{className:"flex-1 flex flex-col gap-3",children:[(0,b.jsxs)(c.default,{href:E,className:`self-start flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s?"bg-slate-700 hover:bg-slate-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"戻る"]}),(0,b.jsx)("div",{className:"flex-1 flex flex-col gap-2",children:g.map(a=>{let d=z.filter(b=>h(b.display_name_kana)===a.label).length;return(0,b.jsxs)(c.default,{href:`${E}?mode=${n}&kanaGroup=${a.label}`,className:`flex-1 px-6 rounded-xl ${v} border-2 ${u} hover:border-blue-400 ${s?"hover:bg-slate-700":"hover:bg-blue-50"} flex items-center justify-between transition-all`,children:[(0,b.jsxs)("div",{className:`text-xl font-bold ${s?"text-white":"text-gray-900"}`,children:[a.label," 行"]}),(0,b.jsxs)("div",{className:`text-sm ${w}`,children:[d,"名"]})]},a.label)})})]}),4===K&&n&&p&&(0,b.jsxs)("div",{className:"flex-1 flex flex-col gap-4",children:[(0,b.jsxs)(c.default,{href:`${E}?mode=${n}`,className:`self-start flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s?"bg-slate-700 hover:bg-slate-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"行選択に戻る"]}),(0,b.jsxs)("h2",{className:`text-lg font-semibold ${s?"text-white":"text-gray-900"}`,children:[p," 行の名前を選択"]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:z.filter(a=>h(a.display_name_kana)===p).map(a=>(0,b.jsx)(c.default,{href:`${E}?mode=${n}${J?`&role=${J}`:""}&kanaGroup=${p}&profileId=${a.id}`,className:`px-4 py-6 rounded-xl ${v} border-2 ${u} hover:border-blue-400 ${s?"hover:bg-slate-700":"hover:bg-blue-50"} text-center text-lg font-medium transition-all ${s?"text-white":"text-gray-900"}`,children:a.display_name||"(名前未設定)"},a.id))})]}),5===K&&n&&F&&(0,b.jsxs)("div",{className:`flex-1 flex flex-col rounded-xl ${v} border ${u} p-6`,children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3 mb-4",children:[(0,b.jsxs)(c.default,{href:`${E}?mode=${n}`,className:`self-start flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s?"bg-slate-700 hover:bg-slate-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"名前を変更"]}),(0,b.jsxs)("h2",{className:`text-lg font-semibold ${s?"text-white":"text-gray-900"}`,children:["clockIn"===n?"出勤情報の確認":"退勤の確認","：",F.display_name]})]}),"clockIn"===n?(0,b.jsx)(f.ClockInForm,{storeId:m,profileId:F.id,profileName:F.display_name||"",pickupHistory:D[F.id]||[],tabletClockIn:e.tabletClockIn,isDarkMode:s}):(0,b.jsxs)("form",{action:e.tabletClockOut,className:"flex-1 flex flex-col",children:[(0,b.jsx)("input",{type:"hidden",name:"store_id",value:m}),(0,b.jsx)("input",{type:"hidden",name:"profile_id",value:F.id}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsx)("button",{type:"submit",className:"mt-4 w-full py-8 rounded-2xl bg-rose-500 hover:bg-rose-600 text-white text-2xl font-bold shadow-lg",children:"退勤する"})]})]})]})]})}a.s(["default",()=>k,"dynamic",0,"force-dynamic","revalidate",0,0])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1751a3cd._.js.map