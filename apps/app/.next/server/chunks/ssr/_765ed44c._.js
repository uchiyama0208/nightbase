module.exports=[5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},11587,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97942),e=a.i(55294);let f=d.Root,g=d.Trigger,h=d.Portal,i=d.Close,j=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Overlay,{ref:f,className:(0,e.cn)("fixed inset-0 z-50 bg-slate-950/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out",a),...c}));j.displayName=d.Overlay.displayName;let k=c.forwardRef(({className:a,children:c,...f},g)=>(0,b.jsxs)(h,{children:[(0,b.jsx)(j,{}),(0,b.jsx)(d.Content,{ref:g,className:(0,e.cn)("fixed left-1/2 top-1/2 z-50 w-[calc(100%-2rem)] max-w-xl -translate-x-1/2 -translate-y-1/2 rounded-3xl border border-slate-200 bg-white p-8 text-slate-900 shadow-2xl backdrop-blur data-[state=open]:animate-in data-[state=closed]:animate-out dark:border-white/10 dark:bg-slate-950/95 dark:text-slate-100",a),...f,children:c})]}));k.displayName=d.Content.displayName;let l=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("mb-6 flex flex-col gap-2 text-center sm:text-left",a),...c});l.displayName="DialogHeader";let m=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...c});m.displayName="DialogFooter";let n=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Title,{ref:f,className:(0,e.cn)("text-xl font-semibold text-slate-900 dark:text-slate-50",a),...c}));n.displayName=d.Title.displayName;let o=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Description,{ref:f,className:(0,e.cn)("text-sm text-slate-500 dark:text-slate-400",a),...c}));o.displayName=d.Description.displayName,a.s(["Dialog",()=>f,"DialogClose",()=>i,"DialogContent",()=>k,"DialogDescription",()=>o,"DialogFooter",()=>m,"DialogHeader",()=>l,"DialogTitle",()=>n,"DialogTrigger",()=>g])},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},69520,a=>{"use strict";let b=(0,a.i(70106).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],69520)},62722,a=>{"use strict";let b=(0,a.i(70106).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],62722)},25479,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({pickupHistory:a,onValidationChange:d,isDarkMode:e,onPickupChange:f,onDestinationChange:g}){let[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(""),l=a=>{i(a),f&&f(a),!1===a?d(!0):(d(""!==j.trim()),g&&g(j))},m=a=>{k(a),!0===h&&(d(""!==a.trim()),g&&g(a))};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:`text-base font-semibold ${e?"text-white":"text-gray-900"}`,children:"送迎の有無"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>l(!1),className:`px-6 py-4 rounded-xl border-2 font-semibold text-lg transition-all ${!1===h?"bg-blue-500 border-blue-500 text-white":e?"bg-slate-800 border-slate-600 text-gray-200 hover:border-slate-400":"bg-white border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"送迎なし"}),(0,b.jsx)("button",{type:"button",onClick:()=>l(!0),className:`px-6 py-4 rounded-xl border-2 font-semibold text-lg transition-all ${!0===h?"bg-blue-500 border-blue-500 text-white":e?"bg-slate-800 border-slate-600 text-gray-200 hover:border-slate-400":"bg-white border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"送迎あり"})]})]}),(0,b.jsx)("input",{type:"hidden",name:"pickup_required",value:!0===h?"yes":"no"}),!0===h&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:`text-base font-semibold ${e?"text-white":"text-gray-900"}`,children:"送迎先"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("input",{type:"text",name:"pickup_destination_custom",value:j,onChange:a=>m(a.target.value),placeholder:"送迎先を入力",className:`w-full rounded-lg px-4 py-3 text-base border placeholder:text-gray-400 ${e?"bg-slate-800 border-slate-600 text-white placeholder:text-gray-500":"bg-white border-gray-300 text-gray-900"}`}),a?.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:`text-sm ${e?"text-gray-400":"text-gray-500"}`,children:"過去の履歴から選択"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>m(a),className:`px-4 py-2 rounded-lg text-sm border transition-colors ${j===a?"bg-blue-500 border-blue-500 text-white":e?"bg-slate-800 border-slate-600 text-gray-200 hover:border-slate-400":"bg-white border-gray-300 text-gray-700 hover:border-gray-400"}`,children:a},a))})]})]})]})]})}a.s(["PickupForm",()=>d])},98464,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(45750),e=a.i(5050),f=(0,e.createServerReference)("604ea1603dfc839f0dd9303395a1f7904ae2b84a07",e.callServer,void 0,e.findSourceMapURL,"clockIn"),g=(0,e.createServerReference)("40e6fae2b8cdecd7cc41b88835c51644ba8e42490d",e.callServer,void 0,e.findSourceMapURL,"startBreak"),h=(0,e.createServerReference)("40e60f50041f2bc8364378a81162612bea16641584",e.callServer,void 0,e.findSourceMapURL,"endBreak");let i=(0,a.i(70106).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var j=a.i(62722),k=a.i(69520),l=a.i(96221),m=a.i(11587),n=a.i(25479),o=(0,e.createServerReference)("40aa1d3b6c70b0def48387ebc4f67ad5e325ad7695",e.callServer,void 0,e.findSourceMapURL,"clockOut"),p=a.i(50944);function q({isOpen:a,onClose:e,timeCardId:f}){let[g,h]=(0,c.useState)(!1),i=(0,p.useRouter)(),j=async()=>{h(!0);try{await o(f),e(),i.refresh()}catch(a){console.error("Clock out failed:",a),alert("退勤打刻に失敗しました。もう一度お試しください。")}finally{h(!1)}};return(0,b.jsx)(m.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(m.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800",children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{className:"text-gray-900 dark:text-white",children:"退勤確認"}),(0,b.jsx)(m.DialogDescription,{className:"text-gray-600 dark:text-gray-400",children:"退勤打刻を行いますか？"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 pt-4",children:[(0,b.jsx)(d.Button,{onClick:j,disabled:g,className:"w-full bg-blue-500 hover:bg-blue-600 text-white",children:g?"登録中...":"退勤する"}),(0,b.jsx)(d.Button,{variant:"outline",onClick:e,className:"w-full border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"キャンセル"})]})]})})}function r({latestTimeCard:a,storeSettings:e,showBreakButtons:o=!0,pickupHistory:p,autoOpenModal:r=!1,autoClockOut:s=!1}){let[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)("disabled"),[z,A]=(0,c.useState)(null),B=(0,c.useCallback)(()=>{e?.location_check_enabled?e.latitude&&e.longitude&&navigator.geolocation?(y("checking"),navigator.geolocation.getCurrentPosition(a=>{var b,c,d,f;let g,h,i,j,k,l=(b=a.coords.latitude,c=a.coords.longitude,d=e.latitude,f=e.longitude,g=b*Math.PI/180,h=d*Math.PI/180,2*Math.atan2(Math.sqrt(k=Math.sin((i=(d-b)*Math.PI/180)/2)*Math.sin(i/2)+Math.cos(g)*Math.cos(h)*Math.sin((j=(f-c)*Math.PI/180)/2)*Math.sin(j/2)),Math.sqrt(1-k))*6371e3);A(l),l<=e.location_radius?y("matched"):y("mismatched")},a=>{console.error("Error getting location:",a),y("error")})):y("error"):y("disabled")},[e]),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1);(0,c.useEffect)(()=>{u(new Date);let a=setInterval(()=>{u(new Date)},1e3);return e?.location_check_enabled&&B(),()=>clearInterval(a)},[e?.location_check_enabled,B]),(0,c.useEffect)(()=>{if(r&&!a?.clock_in){let a=setTimeout(()=>{D(!0)},500);return()=>clearTimeout(a)}},[r,a]);let G=c.default.useRef(!1);(0,c.useEffect)(()=>{if(s&&a?.clock_in&&!a?.clock_out&&!G.current){G.current=!0;let a=setTimeout(()=>{F(!0)},300);return()=>clearTimeout(a)}},[s,a]);let[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(""),N=async()=>{D(!0)},O=async()=>{w(!0);try{await f(!0===J,L),D(!1),window.location.reload()}catch(a){console.error("Clock in failed:",a),alert("出勤打刻に失敗しました。もう一度お試しください。")}finally{w(!1)}},P=async a=>{w(!0);try{await a()}catch(a){console.error("Action error:",a),alert("操作に失敗しました")}finally{w(!1)}},Q=a?.clock_in&&!a?.clock_out,R=Q&&a?.break_start&&!a?.break_end,S=v||e?.location_check_enabled&&"matched"!==x;return(0,b.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white font-mono",children:t?t.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--"}),(0,b.jsx)("div",{className:"text-sm md:text-base lg:text-lg text-gray-600 dark:text-gray-400",children:t?t.toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"long"}):"----/--/--"})]}),!Q&&(()=>{if(!e?.location_check_enabled)return null;switch(x){case"checking":return(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-gray-500 dark:text-gray-400 text-sm",children:[(0,b.jsx)(l.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsx)("span",{children:"位置情報を確認中..."})]});case"matched":return(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600 dark:text-green-400 text-sm font-medium",children:[(0,b.jsx)(i,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"位置情報は一致しています"})]});case"mismatched":return(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-red-600 dark:text-red-400 text-sm font-medium",children:[(0,b.jsx)(j.XCircle,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:["位置情報が一致していません (",Math.round(z||0),"m)"]})]});case"error":return(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-red-600 dark:text-red-400 text-sm font-medium",children:[(0,b.jsx)(j.XCircle,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"位置情報の取得に失敗しました"})]});default:return null}})(),(0,b.jsx)("div",{className:"flex flex-col items-center gap-3 md:gap-4",children:Q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-center text-sm font-medium text-blue-600 dark:text-blue-400 mb-2",children:"勤務中"}),(0,b.jsx)("div",{className:"flex flex-col md:flex-row gap-3 md:gap-4 w-full max-w-md",children:R?(0,b.jsx)(d.Button,{size:"lg",onClick:()=>P(()=>h(a.id)),disabled:v,className:"text-base md:text-lg px-6 md:px-8 py-4 md:py-6 bg-green-500 hover:bg-green-600 text-white w-full",children:v?"登録中...":"休憩終了"}):(0,b.jsxs)(b.Fragment,{children:[o&&(0,b.jsx)(d.Button,{size:"lg",onClick:()=>P(()=>g(a.id)),disabled:v,className:"text-base md:text-lg px-6 md:px-8 py-4 md:py-6 bg-yellow-500 hover:bg-yellow-600 text-white flex-1",children:v?"登録中...":"休憩開始"}),(0,b.jsx)(d.Button,{size:"lg",onClick:()=>{F(!0)},disabled:v,className:`text-base md:text-lg px-6 md:px-8 py-4 md:py-6 bg-red-500 hover:bg-red-600 text-white ${o?"flex-1":"w-full"}`,children:v?"登録中...":"退勤する"})]})})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2 w-full max-w-xs",children:[(0,b.jsx)(d.Button,{size:"lg",onClick:N,disabled:S,className:`text-base md:text-lg px-8 md:px-12 py-4 md:py-6 text-white w-full transition-colors ${S?"bg-gray-300 dark:bg-gray-700 cursor-not-allowed":"bg-[#0088FF] hover:bg-[#0077EE]"}`,children:v?"登録中...":"出勤する"}),e?.location_check_enabled&&"matched"!==x&&"checking"!==x&&(0,b.jsx)(d.Button,{size:"icon",variant:"outline",onClick:B,className:"h-14 w-14 shrink-0 border-gray-200 dark:border-gray-700",title:"位置情報を再取得",children:(0,b.jsx)(k.RefreshCw,{className:"h-5 w-5 text-gray-500"})})]})}),(0,b.jsx)(m.Dialog,{open:C,onOpenChange:D,children:(0,b.jsxs)(m.DialogContent,{className:"sm:max-w-[500px] max-w-[calc(100%-2rem)] bg-white dark:bg-white",children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsx)(m.DialogTitle,{className:"text-gray-900",children:"出勤確認"})}),(0,b.jsx)("div",{className:"py-4",children:(0,b.jsx)(n.PickupForm,{pickupHistory:p,onValidationChange:I,isDarkMode:!1,onPickupChange:K,onDestinationChange:M})}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 pt-2",children:[(0,b.jsx)(d.Button,{onClick:O,disabled:null===J||!H||v,className:"w-full bg-[#0088FF] hover:bg-[#0077EE] text-white disabled:bg-gray-300 disabled:cursor-not-allowed",children:v?"登録中...":"出勤する"}),(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>D(!1),className:"w-full border-gray-300 text-gray-700 hover:bg-gray-50",children:"キャンセル"})]})]})}),(0,b.jsx)(q,{isOpen:E,onClose:()=>F(!1),timeCardId:a?.id||""})]})}a.s(["ClockButtons",()=>r],98464)}];

//# sourceMappingURL=_765ed44c._.js.map