(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,30500,e=>{"use strict";var a=e.i(18050),t=e.i(71645),r=e.i(18566),l=e.i(95187),s=(0,l.createServerReference)("403be324e96604b07e3d40e85ad9ed05510f775e95",l.callServer,void 0,l.findSourceMapURL,"createAttendance"),i=(0,l.createServerReference)("405bcd64a4bdfaf384e28eef70d6feb4dab0c1c2a1",l.callServer,void 0,l.findSourceMapURL,"updateAttendance"),n=(0,l.createServerReference)("40d39c086fd86461c7bae6b63e57f6f4ac6ba7b97d",l.callServer,void 0,l.findSourceMapURL,"deleteAttendance"),d=e.i(3420),c=e.i(68340),o=e.i(30406),x=e.i(83660),u=e.i(18494),m=e.i(41071),g=e.i(73375),h=e.i(87316),y=e.i(3116);function f({isOpen:e,onClose:l,profiles:f,currentProfileId:p,defaultRole:b="staff",initialData:v,editingRecord:j,onOpenProfileEdit:k,onFocusAttendanceForProfile:N}){let w=(0,r.useRouter)(),[S,C]=(0,t.useState)(!1),[_,D]=(0,t.useState)(!1),[L,R]=(0,t.useState)(b),[U,I]=(0,t.useState)(!1),F=j&&f.find(e=>e.id===j.user_id)||null,M=f.filter(e=>"cast"===L?"cast"===e.role:"staff"===e.role),P=j?.user_id||v?.profileId||"",T=j?.date||v?.date||new Date().toISOString().split("T")[0],A=e=>{if(!e)return"";if(/^\d{2}:\d{2}(?::\d{2})?$/.test(e))return e.slice(0,5);try{let a=new Date(e);if(!isNaN(a.getTime()))return a.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch(e){console.error("Error parsing time:",e)}return""},B=j?A(j.start_time):v?.startTime||"",O=j?A(j.end_time):v?.endTime||"",E=j?.pickup_destination||"",K=async e=>{e.preventDefault(),C(!0);try{let a=new FormData(e.currentTarget);j?await i(a):await s(a),w.refresh(),l()}catch(e){console.error("Error saving attendance:",e)}finally{C(!1)}},V=async()=>{if(j){C(!0);try{await n(j.id),w.refresh(),D(!1),l()}catch(e){console.error("Error deleting attendance:",e)}finally{C(!1)}}};return(0,a.jsxs)(u.Dialog,{open:e,onOpenChange:l,children:[(0,a.jsx)(u.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-6 text-gray-900 dark:text-gray-100",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(u.DialogHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:l,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0","aria-label":"戻る",children:(0,a.jsx)(g.ChevronLeft,{className:"h-4 w-4"})}),(0,a.jsx)(u.DialogTitle,{className:"flex-1 text-center text-xl md:text-2xl font-bold text-gray-900 dark:text-white truncate",children:F?F.display_name||F.real_name||"メンバー":"出勤記録"}),P?(0,a.jsx)("button",{type:"button",onClick:()=>I(e=>!e),className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700","aria-label":"プロフィール・勤怠の操作を表示",children:(0,a.jsx)(m.MoreHorizontal,{className:"h-4 w-4"})}):(0,a.jsx)("div",{className:"h-8 w-8"})]}),U&&P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",className:"absolute inset-0 z-10 cursor-default",onClick:()=>I(!1),"aria-label":"メニューを閉じる"}),(0,a.jsxs)("div",{className:"absolute right-0 top-10 z-20 w-40 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg p-2 flex flex-col gap-1 text-xs",children:[(0,a.jsx)(d.Button,{type:"button",variant:"ghost",className:"justify-start h-8 px-2 rounded-lg text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>{k?.(P),I(!1),l()},children:"プロフィール"}),(0,a.jsx)(d.Button,{type:"button",variant:"ghost",className:"justify-start h-8 px-2 rounded-lg text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>{N?.(P),I(!1),l()},children:"勤怠"}),j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-px bg-gray-200 dark:bg-gray-700 my-1"}),(0,a.jsx)(d.Button,{type:"button",variant:"ghost",className:"justify-start h-8 px-2 rounded-lg text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{I(!1),D(!0)},children:"削除"})]})]})]}),!j&&(0,a.jsx)("div",{className:"flex justify-center mb-2",children:(0,a.jsxs)("div",{className:"inline-flex h-8 items-center rounded-full bg-gray-100 dark:bg-gray-700 p-1",children:[(0,a.jsx)("button",{type:"button",onClick:()=>R("cast"),className:`px-4 h-full flex items-center rounded-full text-xs font-medium transition-colors ${"cast"===L?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"キャスト"}),(0,a.jsx)("button",{type:"button",onClick:()=>R("staff"),className:`px-4 h-full flex items-center rounded-full text-xs font-medium transition-colors ${"staff"===L?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"スタッフ"})]})}),(0,a.jsxs)("form",{onSubmit:K,className:"space-y-4 mt-1",children:[j&&(0,a.jsx)("input",{type:"hidden",name:"id",value:j.id}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"profileId",children:"メンバー"}),(0,a.jsxs)(x.Select,{name:"profileId",defaultValue:P,required:!0,children:[(0,a.jsx)(x.SelectTrigger,{className:"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md",children:(0,a.jsx)(x.SelectValue,{placeholder:"メンバーを選択"})}),(0,a.jsx)(x.SelectContent,{children:M.map(e=>(0,a.jsx)(x.SelectItem,{value:e.id,children:e.display_name||e.real_name||"メンバー"},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"date",children:"日付"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Calendar,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 dark:text-gray-400 pointer-events-none"}),(0,a.jsx)(c.Input,{id:"date",name:"date",type:"date",required:!0,defaultValue:T,className:"w-full pl-10 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"pickup_destination",children:"送迎先"}),(0,a.jsx)(c.Input,{id:"pickup_destination",name:"pickup_destination",type:"text",placeholder:"送迎先を入力",defaultValue:E,className:"w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"startTime",children:"開始時刻"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(y.Clock,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 dark:text-gray-400 pointer-events-none"}),(0,a.jsx)(c.Input,{id:"startTime",name:"startTime",type:"time",defaultValue:B,className:"w-full pl-10 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"endTime",children:"終了時刻"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(y.Clock,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 dark:text-gray-400 pointer-events-none"}),(0,a.jsx)(c.Input,{id:"endTime",name:"endTime",type:"time",defaultValue:O,className:"w-full pl-10 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-md"})]})]})]}),(0,a.jsxs)(u.DialogFooter,{className:"flex-col sm:flex-row gap-4 mt-8",children:[(0,a.jsx)(d.Button,{type:"submit",disabled:S,className:"w-full sm:w-auto rounded-full h-10",children:S?"保存中...":j?"保存":"作成"}),(0,a.jsx)(d.Button,{type:"button",variant:"outline",onClick:l,className:"w-full sm:w-auto border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full h-10",children:"キャンセル"})]})]})]})}),(0,a.jsx)(u.Dialog,{open:_,onOpenChange:D,children:(0,a.jsxs)(u.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800 w-[95%] rounded-lg p-6",children:[(0,a.jsxs)(u.DialogHeader,{children:[(0,a.jsx)(u.DialogTitle,{className:"text-lg font-bold text-gray-900 dark:text-white",children:"勤怠記録の削除"}),(0,a.jsxs)(u.DialogDescription,{className:"text-gray-500 dark:text-gray-400 mt-2",children:["この勤怠記録を削除してもよろしいですか？",(0,a.jsx)("br",{}),"この操作は取り消せません。"]})]}),(0,a.jsxs)(u.DialogFooter,{className:"flex-col sm:flex-row gap-3 mt-6",children:[(0,a.jsx)(d.Button,{type:"button",variant:"destructive",onClick:V,disabled:S,className:"w-full sm:w-auto rounded-full",children:S?"削除中...":"削除する"}),(0,a.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>D(!1),className:"w-full sm:w-auto rounded-full",children:"キャンセル"})]})]})})]})}e.s(["AttendanceModal",()=>f],30500)},5658,95740,90597,92930,60353,69868,49519,86194,92752,43107,53157,58491,48436,25730,6120,18836,47176,35097,69481,e=>{"use strict";var a=e.i(75254);let t=(0,a.default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],5658);var r=e.i(68656);e.s(["UserCircle",()=>r.default],95740);let l=(0,a.default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);e.s(["Heart",()=>l],90597);let s=(0,a.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>s],92930);var i=e.i(95187),n=(0,i.createServerReference)("40d54faf838f60a57d913423bb21d98cd0140e82a1",i.callServer,void 0,i.findSourceMapURL,"updateUser");e.s(["updateUser",()=>n],60353);var d=(0,i.createServerReference)("40e631752d3f63866f4bfdcefb52b39b7a16b9beed",i.callServer,void 0,i.findSourceMapURL,"createUser");e.s(["createUser",()=>d],69868);var c=(0,i.createServerReference)("40d454b66dc7597bde21ab5ab88ac6c1291aba3456",i.callServer,void 0,i.findSourceMapURL,"deleteUser");e.s(["deleteUser",()=>c],49519);var o=(0,i.createServerReference)("40ac9d7a98c2a78cd988100eef4e5e7d91131859e8",i.callServer,void 0,i.findSourceMapURL,"getProfileDetails");e.s(["getProfileDetails",()=>o],86194);var x=(0,i.createServerReference)("7013ab3c5d7056545e992425288ac07f894e0f9321",i.callServer,void 0,i.findSourceMapURL,"updateProfileRelationships");e.s(["updateProfileRelationships",()=>x],92752);var u=(0,i.createServerReference)("6037218bf15dafe2b6f4a84653a7896a5f707e4376",i.callServer,void 0,i.findSourceMapURL,"addProfileComment");e.s(["addProfileComment",()=>u],43107);var m=(0,i.createServerReference)("60819da50ce93994448e38298ecedf8232cced91bd",i.callServer,void 0,i.findSourceMapURL,"updateProfileComment");e.s(["updateProfileComment",()=>m],53157);var g=(0,i.createServerReference)("4084b6043912cd8a75569f2d971d9e162ea4de2c3f",i.callServer,void 0,i.findSourceMapURL,"deleteProfileComment");e.s(["deleteProfileComment",()=>g],58491);var h=(0,i.createServerReference)("405a3002f6f21537774442b0b95e2dd58bbb99e2d9",i.callServer,void 0,i.findSourceMapURL,"toggleCommentLike");e.s(["toggleCommentLike",()=>h],48436);var y=(0,i.createServerReference)("00e8e4d5ad38b65a60a88324e02b1556aaf771095a",i.callServer,void 0,i.findSourceMapURL,"getAllProfiles");e.s(["getAllProfiles",()=>y],25730);var f=(0,i.createServerReference)("00a5fe1c9ebf4b8eac0bfb2ac26badbfac17290c2b",i.callServer,void 0,i.findSourceMapURL,"getCurrentUserProfileId");e.s(["getCurrentUserProfileId",()=>f],6120);var p=(0,i.createServerReference)("6032599c457d1d9c38a767c7a62a3e4304032c930b",i.callServer,void 0,i.findSourceMapURL,"uploadProfileAvatar");e.s(["uploadProfileAvatar",()=>p],18836);var b=(0,i.createServerReference)("40a7d24dbb5a7d9dfb1a862bc601d5443013a95d2a",i.callServer,void 0,i.findSourceMapURL,"deleteProfileAvatar");e.s(["deleteProfileAvatar",()=>b],47176);var v=(0,i.createServerReference)("405d88bef58e495845168b770b6ef6545da02343bd",i.callServer,void 0,i.findSourceMapURL,"getUserBottleKeeps");e.s(["getUserBottleKeeps",()=>v],35097);var j=(0,i.createServerReference)("00e241e9b8fcf03b19909349ec766f9fc7fbab803a",i.callServer,void 0,i.findSourceMapURL,"getMenus");e.s(["getMenus",()=>j],69481)},11021,34710,e=>{"use strict";var a=e.i(95187),t=(0,a.createServerReference)("406ac45c0783e1af90b5ef914f0a0a0f0dd0751f05",a.callServer,void 0,a.findSourceMapURL,"createBottleKeep");e.s(["createBottleKeep",()=>t],11021);var r=(0,a.createServerReference)("6041bdd2e4dae44a41afa21525389d91048eec82d8",a.callServer,void 0,a.findSourceMapURL,"updateBottleKeep");e.s(["updateBottleKeep",()=>r],34710)},63683,e=>{"use strict";e.s(["BottleModal",()=>f]);var a=e.i(18050),t=e.i(71645),r=e.i(18566),l=e.i(11021),s=e.i(34710),i=e.i(3420),n=e.i(68340),d=e.i(30406),c=e.i(75160),o=e.i(83660),x=e.i(18494),u=e.i(73375),m=e.i(7233),g=e.i(1781),h=e.i(13573),y=e.i(2246);function f({isOpen:e,onClose:f,bottle:p,menus:b,profiles:v,initialProfileIds:j=[]}){let k=(0,r.useRouter)(),[N,w]=(0,t.useState)(!1),[S,C]=(0,t.useState)(""),[_,D]=(0,t.useState)(""),[L,R]=(0,t.useState)(!1),[U,I]=(0,t.useState)(!1),F=p?.bottle_keep_holders?.map(e=>e.profile_id)||j,[M,P]=(0,t.useState)(F),T=[...v].filter(e=>"guest"===e.role).sort((e,a)=>{let t=e.display_name_kana||e.display_name||e.real_name_kana||e.real_name||"",r=a.display_name_kana||a.display_name||a.real_name_kana||a.real_name||"";return t.localeCompare(r,"ja")}).filter(e=>{let a=S.toLowerCase(),t=(e.display_name||"").toLowerCase(),r=(e.display_name_kana||"").toLowerCase(),l=(e.real_name||"").toLowerCase(),s=(e.real_name_kana||"").toLowerCase();return t.includes(a)||r.includes(a)||l.includes(a)||s.includes(a)}),A=[...b].sort((e,a)=>e.name.localeCompare(a.name,"ja")).filter(e=>{let a=_.toLowerCase();return e.name.toLowerCase().includes(a)}),B=async e=>{e.preventDefault(),w(!0);try{let a=new FormData(e.currentTarget);a.set("profile_ids",JSON.stringify(M)),p?await (0,s.updateBottleKeep)(p.id,a):await (0,l.createBottleKeep)(a),k.refresh(),f()}catch(e){console.error("Error saving bottle keep:",e),alert("保存に失敗しました")}finally{w(!1)}};return(0,a.jsxs)(x.Dialog,{open:e,onOpenChange:f,children:[(0,a.jsxs)(x.DialogContent,{className:"sm:max-w-[500px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-6 text-gray-900 dark:text-gray-100",children:[(0,a.jsxs)(x.DialogHeader,{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:f,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none","aria-label":"戻る",children:(0,a.jsx)(u.ChevronLeft,{className:"h-4 w-4"})}),(0,a.jsx)(x.DialogTitle,{className:"flex-1 text-center text-xl font-bold text-gray-900 dark:text-white",children:p?"ボトル編集":"ボトル新規登録"}),(0,a.jsx)("div",{className:"w-8"})]}),(0,a.jsxs)("form",{onSubmit:B,className:"space-y-5 mt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(d.Label,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["ゲスト ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>R(!0),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:[(0,a.jsx)(m.Plus,{className:"h-3 w-3"}),"ゲストを追加"]})]}),(0,a.jsx)(n.Input,{type:"text",placeholder:"ゲストを検索...",value:S,onChange:e=>C(e.target.value),className:"bg-white dark:bg-gray-900 mb-2"}),(0,a.jsx)("div",{className:"border rounded-lg p-3 max-h-48 overflow-y-auto bg-gray-50 dark:bg-gray-900",children:0===T.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:S?"該当するゲストがいません":"プロフィールがありません"}):(0,a.jsx)("div",{className:"space-y-2",children:T.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Checkbox,{id:`profile-${e.id}`,checked:M.includes(e.id),onCheckedChange:()=>{var a;return a=e.id,void P(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])}}),(0,a.jsx)("label",{htmlFor:`profile-${e.id}`,className:"text-sm cursor-pointer text-gray-700 dark:text-gray-300",children:e.display_name||e.real_name||"名前未設定"})]},e.id))})}),0===M.length&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"少なくとも1人のゲストを選択してください"})]}),!p&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(d.Label,{htmlFor:"menu_id",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["ボトル ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>I(!0),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:[(0,a.jsx)(m.Plus,{className:"h-3 w-3"}),"メニューを追加"]})]}),(0,a.jsx)(n.Input,{type:"text",placeholder:"ボトルを検索...",value:_,onChange:e=>D(e.target.value),className:"bg-white dark:bg-gray-900 mb-2"}),(0,a.jsxs)(o.Select,{name:"menu_id",required:!0,children:[(0,a.jsx)(o.SelectTrigger,{className:"bg-white dark:bg-gray-900",children:(0,a.jsx)(o.SelectValue,{placeholder:"ボトルを選択"})}),(0,a.jsx)(o.SelectContent,{children:0===A.length?(0,a.jsx)("div",{className:"p-2 text-sm text-gray-500",children:"該当するボトルがありません"}):A.map(e=>(0,a.jsxs)(o.SelectItem,{value:e.id,children:[e.name," - ¥",e.price.toLocaleString()]},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"remaining_amount",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"残量"}),(0,a.jsxs)(o.Select,{name:"remaining_amount",defaultValue:String(p?.remaining_amount||100),required:!0,children:[(0,a.jsx)(o.SelectTrigger,{className:"bg-white dark:bg-gray-900",children:(0,a.jsx)(o.SelectValue,{placeholder:"残量を選択"})}),(0,a.jsxs)(o.SelectContent,{children:[(0,a.jsx)(o.SelectItem,{value:"100",children:"未開封"}),(0,a.jsx)(o.SelectItem,{value:"75",children:"多め"}),(0,a.jsx)(o.SelectItem,{value:"50",children:"半分"}),(0,a.jsx)(o.SelectItem,{value:"25",children:"少なめ"}),(0,a.jsx)(o.SelectItem,{value:"0",children:"無し"})]})]})]}),p&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"status",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ステータス"}),(0,a.jsxs)(o.Select,{name:"status",defaultValue:p?.status||"active",children:[(0,a.jsx)(o.SelectTrigger,{className:"bg-white dark:bg-gray-900",children:(0,a.jsx)(o.SelectValue,{})}),(0,a.jsxs)(o.SelectContent,{children:[(0,a.jsx)(o.SelectItem,{value:"active",children:"利用中"}),(0,a.jsx)(o.SelectItem,{value:"empty",children:"空"}),(0,a.jsx)(o.SelectItem,{value:"returned",children:"返却済"})]})]})]}),!p&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"opened_at",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"開栓日"}),(0,a.jsx)(n.Input,{id:"opened_at",name:"opened_at",type:"date",defaultValue:new Date().toISOString().split("T")[0],required:!0,className:"bg-white dark:bg-gray-900"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"expiration_date",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"有効期限 (任意)"}),(0,a.jsx)(n.Input,{id:"expiration_date",name:"expiration_date",type:"date",defaultValue:p?.expiration_date||"",className:"bg-white dark:bg-gray-900"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"memo",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"メモ (任意)"}),(0,a.jsx)(c.Textarea,{id:"memo",name:"memo",defaultValue:p?.memo||"",rows:3,className:"bg-white dark:bg-gray-900 resize-none",placeholder:"備考があれば入力してください"})]}),(0,a.jsxs)(x.DialogFooter,{className:"flex gap-3 pt-4",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:f,disabled:N,className:"flex-1 min-h-[44px] h-11",children:"キャンセル"}),(0,a.jsx)(i.Button,{type:"submit",disabled:N||0===M.length,className:"flex-1 min-h-[44px] h-11",children:N?"保存中...":p?"更新":"登録"})]})]})]}),(0,a.jsx)(y.UserEditModal,{open:L,onOpenChange:e=>{R(e),e||k.refresh()},profile:null,defaultRole:"guest",isNested:!0}),(0,a.jsx)(h.MenuEditModal,{open:U,onOpenChange:e=>{I(e),e||k.refresh()},menu:null,categories:b.map(e=>e.category).filter((e,a,t)=>t.indexOf(e)===a)})]})}},82714,e=>{"use strict";var a=e.i(18050),t=e.i(71645),r=e.i(18494),l=e.i(73375),s=e.i(31278),i=e.i(95187),n=(0,i.createServerReference)("4045f18647982ea20967cf125e0fa243b6327117e9",i.callServer,void 0,i.findSourceMapURL,"getAttendanceRecords"),d=e.i(1851),c=e.i(33625);function o({isOpen:e,onClose:i,profileId:o,profileName:x,onEditRecord:u}){let[m,g]=(0,t.useState)([]),[h,y]=(0,t.useState)(!1),[f,p]=(0,t.useState)(new Date().toISOString().slice(0,7));(0,t.useEffect)(()=>{e&&o&&(async()=>{y(!0);try{let e=await n(o);g(e||[])}catch(e){console.error("Failed to fetch records:",e)}finally{y(!1)}})()},[e,o]);let b=e=>e?(0,d.format)(new Date(e),"HH:mm"):"-",v=m.filter(e=>e.work_date.startsWith(f));return(0,a.jsx)(r.Dialog,{open:e,onOpenChange:i,children:(0,a.jsxs)(r.DialogContent,{className:"sm:max-w-[600px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-3",children:[(0,a.jsxs)(r.DialogHeader,{className:"flex flex-col gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:i,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0",children:(0,a.jsx)(l.ChevronLeft,{className:"h-4 w-4"})}),(0,a.jsxs)(r.DialogTitle,{className:"flex-1 text-center text-lg font-bold text-gray-900 dark:text-white truncate pr-8",children:[x,"の勤怠"]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("input",{type:"month",value:f,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})})]}),h?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(s.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"})}):(0,a.jsx)("div",{className:"space-y-2",children:0===v.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"勤怠データがありません"}):(0,a.jsx)("div",{className:"overflow-hidden rounded-md border border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("table",{className:"w-full text-sm table-fixed",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-900/50 text-gray-500 dark:text-gray-400 font-medium",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-center w-1/3",children:"日付"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center w-1/3",children:"開始"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center w-1/3",children:"終了"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:v.map(e=>(0,a.jsxs)("tr",{onClick:()=>u(e),className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-center text-gray-900 dark:text-gray-100",children:(0,d.format)(new Date(e.work_date),"M/d (EEE)",{locale:c.ja})}),(0,a.jsx)("td",{className:"px-4 py-3 text-center text-gray-600 dark:text-gray-300",children:b(e.clock_in)}),(0,a.jsx)("td",{className:"px-4 py-3 text-center text-gray-600 dark:text-gray-300",children:b(e.clock_out)})]},e.id))})]})})})]})})}e.s(["UserAttendanceListModal",()=>o],82714)},2246,e=>{"use strict";e.s(["UserEditModal",()=>K],2246);var a=e.i(18050),t=e.i(71645),r=e.i(73375),l=e.i(41071),s=e.i(5658),i=e.i(95740),n=e.i(90597),d=e.i(92930),c=e.i(27612),o=e.i(69074),x=e.i(3420),u=e.i(68340),m=e.i(30406),g=e.i(83660),h=e.i(18494),y=e.i(60353),f=e.i(69868),p=e.i(49519),b=e.i(86194),v=e.i(92752),j=e.i(43107),k=e.i(53157),N=e.i(58491),w=e.i(48436),S=e.i(25730),C=e.i(6120),_=e.i(18836);e.i(47176);var D=e.i(35097),L=e.i(69481),R=e.i(63683),U=e.i(18566),I=e.i(82714),F=e.i(30500),M=e.i(55436),P=e.i(43531),T=e.i(94658);let A={cast:"キャスト",staff:"スタッフ",guest:"ゲスト"};function B({isOpen:e,onClose:l,title:s,profiles:n,selectedIds:d,onSelectionChange:c,currentProfileId:o}){let[m,g]=(0,t.useState)(""),[y,f]=(0,t.useState)(null),[p,b]=(0,t.useState)(d);(0,t.useEffect)(()=>{b(d)},[d]),(0,t.useEffect)(()=>{e||(g(""),f(null))},[e]);let v=n.filter(e=>e.id!==o).filter(e=>{let a=!m||e.display_name?.toLowerCase().includes(m.toLowerCase())||e.real_name?.toLowerCase().includes(m.toLowerCase()),t=!y||e.role===y;return a&&t}),j=()=>{b(d),l()};return(0,a.jsx)(h.Dialog,{open:e,onOpenChange:e=>{e||j()},children:(0,a.jsxs)(h.DialogContent,{className:"sm:max-w-[600px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] flex flex-col p-0",onPointerDownOutside:e=>{e.preventDefault(),j()},onEscapeKeyDown:e=>{e.preventDefault(),j()},onInteractOutside:e=>{e.preventDefault()},children:[(0,a.jsxs)(h.DialogHeader,{className:"flex flex-row items-center justify-between gap-2 px-3 py-6 pb-4 relative",children:[(0,a.jsx)("button",{type:"button",onClick:j,className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0","aria-label":"戻る",children:(0,a.jsx)(r.ChevronLeft,{className:"h-4 w-4"})}),(0,a.jsx)(h.DialogTitle,{className:"flex-1 text-center text-xl md:text-2xl font-bold text-gray-900 dark:text-white truncate",children:s}),(0,a.jsx)("div",{className:"w-8 h-8"})]}),(0,a.jsxs)("div",{className:"px-3 space-y-4 flex-1 overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(M.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(u.Input,{type:"text",placeholder:"名前で検索...",value:m,onChange:e=>g(e.target.value),className:"pl-10 rounded-md"})]}),(0,a.jsxs)("div",{className:"inline-flex h-9 items-center rounded-full bg-gray-100 dark:bg-gray-800 p-1 text-xs",children:[(0,a.jsx)("button",{onClick:()=>f(null),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${null===y?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"すべて"}),["cast","staff","guest"].map(e=>(0,a.jsx)("button",{onClick:()=>f(e),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${y===e?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:A[e]},e))]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto -mx-3 px-3",children:(0,a.jsx)("div",{className:"space-y-1.5",children:0===v.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"該当するメンバーが見つかりません"}):v.map(e=>(0,a.jsxs)("button",{onClick:()=>{var a;return a=e.id,void b(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},className:"w-full flex items-center gap-2.5 p-2.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[(0,a.jsxs)(T.Avatar,{className:"h-8 w-8",children:[(0,a.jsx)(T.AvatarImage,{src:e.avatar_url||""}),(0,a.jsx)(T.AvatarFallback,{className:"bg-gray-200 dark:bg-gray-700",children:(0,a.jsx)(i.UserCircle,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})})]}),(0,a.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.display_name||e.real_name||"名前なし"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:A[e.role]||e.role})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${p.includes(e.id)?"bg-blue-600 border-blue-600":"border-gray-300 dark:border-gray-600"}`,children:p.includes(e.id)&&(0,a.jsx)(P.Check,{className:"h-3 w-3 text-white"})})})]},e.id))})})]}),(0,a.jsxs)("div",{className:"px-3 py-6 pt-4 border-t border-gray-200 dark:border-gray-700 space-y-3",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:[p.length,"人選択中"]}),(0,a.jsx)(x.Button,{onClick:()=>{c(p),l()},className:"w-full rounded-full",children:"保存する"}),(0,a.jsx)(x.Button,{type:"button",variant:"outline",onClick:j,className:"w-full rounded-full border-gray-300 dark:border-gray-600",children:"キャンセル"})]})]})})}var O=e.i(1851),E=e.i(75160);function K({profile:e,open:M,onOpenChange:P,isNested:A=!1,defaultRole:V}){let z=(0,U.useSearchParams)(),H=V||z.get("role")||"cast",[$,q]=(0,t.useState)(!1),[J,W]=(0,t.useState)(e?.role??H),[Z,G]=(0,t.useState)(!1),[Q,X]=(0,t.useState)(!1),[Y,ee]=(0,t.useState)(!1),[ea,et]=(0,t.useState)(null),er=(0,U.useRouter)(),[el,es]=(0,t.useState)([]),[ei,en]=(0,t.useState)([]),[ed,ec]=(0,t.useState)([]),[eo,ex]=(0,t.useState)(""),[eu,em]=(0,t.useState)(!1),[eg,eh]=(0,t.useState)(null),[ey,ef]=(0,t.useState)(null),[ep,eb]=(0,t.useState)(""),[ev,ej]=(0,t.useState)(null),[ek,eN]=(0,t.useState)(null),[ew,eS]=(0,t.useState)(null),[eC,e_]=(0,t.useState)(null),[eD,eL]=(0,t.useState)([]),[eR,eU]=(0,t.useState)([]),[eI,eF]=(0,t.useState)(!1),eM=t.default.useRef(null),eP=async a=>{let t=a.target.files?.[0];if(!t||!e)return;let r=new FormData;r.append("file",t);try{await (0,_.uploadProfileAvatar)(e.id,r),er.refresh()}catch(e){console.error("Avatar upload failed:",e),alert("アップロードに失敗しました")}};(0,t.useEffect)(()=>{W(e?.role??H)},[e,H]);let eT=t.default.useRef(void 0),eA=t.default.useCallback(()=>{e&&(eT.current&&clearTimeout(eT.current),eT.current=setTimeout(async()=>{let e=document.querySelector("form[data-profile-form]");if(!e)return;let a=new FormData(e);try{await (0,y.updateUser)(a)}catch(e){console.error("Auto-save failed:",e)}},1e3))},[e]);(0,t.useEffect)(()=>{M?(async()=>{em(!0);try{let a=await (0,S.getAllProfiles)();es(a);let t=await (0,C.getCurrentUserProfileId)();if(eh(t),e){let a=await (0,b.getProfileDetails)(e.id);a&&(en(a.relationships),ec(a.comments))}}catch(e){console.error("Failed to fetch details:",e)}finally{em(!1)}})():(en([]),ec([]),eL([]),eU([]),ex(""),ef(null),ej(null))},[M,e]),(0,t.useEffect)(()=>{M&&e&&"guest"===e.role&&(async()=>{eL(await (0,D.getUserBottleKeeps)(e.id))})()},[M,e]),(0,t.useEffect)(()=>{M&&(async()=>{eU(await (0,L.getMenus)())})()},[M]);let eB=async()=>{e&&eL(await (0,D.getUserBottleKeeps)(e.id))},eO=async()=>{if(!e)return;let a=await (0,b.getProfileDetails)(e.id);a&&ec(a.comments)},eE=async a=>{q(!0);try{e?await (0,y.updateUser)(a):await (0,f.createUser)(a),P(!1),er.refresh()}catch(e){console.error("Failed to save user:",e),alert("ユーザーの保存に失敗しました")}finally{q(!1)}},eK=async()=>{if(e){q(!0);try{await (0,p.deleteUser)(e.id),ee(!1),P(!1),er.refresh()}catch(e){console.error("Failed to delete user:",e),alert("ユーザーの削除に失敗しました")}finally{q(!1)}}},eV=async(a,t)=>{if(e)try{await (0,v.updateProfileRelationships)(e.id,a,t);let r=await (0,b.getProfileDetails)(e.id);r&&en(r.relationships)}catch(e){console.error(`Failed to update ${a}:`,e)}},ez=async()=>{if(e&&eo.trim())try{await (0,j.addProfileComment)(e.id,eo),ex(""),await eO()}catch(e){console.error("Failed to add comment:",e)}},eH=async e=>{if(ep.trim())try{await (0,k.updateProfileComment)(e,ep),ef(null),eb(""),await eO()}catch(e){console.error("Failed to update comment:",e)}},e$=async e=>{try{await (0,N.deleteProfileComment)(e),eN(null),await eO()}catch(e){console.error("Failed to delete comment:",e)}},eq=async e=>{try{await (0,w.toggleCommentLike)(e),await eO()}catch(e){console.error("Failed to toggle like:",e)}},eJ=a=>e?ei.filter(e=>e.relationship_type===a).map(a=>a.source_profile_id===e.id?a.target_profile_id:a.source_profile_id):[],eW=e=>{let a=eJ(e);return el.filter(e=>a.includes(e.id))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Dialog,{open:M,onOpenChange:P,children:(0,a.jsxs)(h.DialogContent,{className:"sm:max-w-[600px] bg-white dark:bg-gray-800 w-[95%] rounded-lg max-h-[90vh] overflow-y-auto p-6",onPointerDownOutside:e=>{e.preventDefault(),P(!1)},onEscapeKeyDown:e=>{e.preventDefault(),P(!1)},onInteractOutside:e=>{e.preventDefault()},children:[(0,a.jsxs)(h.DialogHeader,{className:"flex flex-row items-center justify-between gap-2 relative",children:[(0,a.jsx)("button",{type:"button",onClick:()=>P(!1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-0","aria-label":"戻る",children:(0,a.jsx)(r.ChevronLeft,{className:"h-4 w-4"})}),(0,a.jsx)(h.DialogTitle,{className:"flex-1 text-center text-xl md:text-2xl font-bold text-gray-900 dark:text-white truncate",children:e?e.display_name||"ユーザー編集":"新規作成"}),e?(0,a.jsx)("button",{type:"button",onClick:()=>G(!Z),className:"inline-flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-100 dark:hover:bg-gray-700","aria-label":"オプション",children:(0,a.jsx)(l.MoreHorizontal,{className:"h-4 w-4"})}):(0,a.jsx)("div",{className:"w-8 h-8"}),Z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>G(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 top-10 z-50 w-40 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg p-2 flex flex-col gap-1 text-sm animate-in fade-in zoom-in-95 duration-100",children:[(0,a.jsx)("button",{type:"button",className:"w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>{G(!1),X(!0)},children:"勤怠一覧"}),e?.id!==eg&&(0,a.jsx)("button",{type:"button",className:"w-full text-left px-3 py-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{G(!1),ee(!0)},children:"削除"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("form",{action:eE,className:"space-y-4","data-profile-form":!0,onChange:eA,children:[e&&(0,a.jsx)("input",{type:"hidden",name:"profileId",value:e.id}),(0,a.jsx)("input",{type:"hidden",name:"role",value:J}),e&&(0,a.jsx)("div",{className:"flex flex-col items-center gap-4 mb-6",children:(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsxs)(T.Avatar,{className:"h-24 w-24 cursor-pointer",onClick:()=>{e&&eM.current?.click()},children:[(0,a.jsx)(T.AvatarImage,{src:e.avatar_url||"",className:"object-cover"}),(0,a.jsx)(T.AvatarFallback,{className:"bg-gray-100 dark:bg-gray-800 text-2xl",children:e.display_name?.[0]||(0,a.jsx)(i.UserCircle,{className:"h-12 w-12"})}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40 rounded-full opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity",children:(0,a.jsx)(o.Upload,{className:"h-6 w-6 text-white"})})]}),(0,a.jsx)("input",{type:"file",ref:eM,className:"hidden",accept:"image/*",onChange:eP})]})}),!e&&(0,a.jsx)("div",{className:"flex justify-center mb-2",children:(0,a.jsxs)("div",{className:"inline-flex h-9 items-center rounded-full bg-gray-100 dark:bg-gray-800 p-1 text-xs",children:[(0,a.jsx)("button",{type:"button",onClick:()=>W("cast"),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${"cast"===J?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"キャスト"}),(0,a.jsx)("button",{type:"button",onClick:()=>W("staff"),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${"staff"===J?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"スタッフ"}),(0,a.jsx)("button",{type:"button",onClick:()=>W("guest"),className:`px-4 h-full flex items-center rounded-full font-medium transition-colors ${"guest"===J?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"ゲスト"})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.Label,{htmlFor:"displayName",children:"表示名"}),(0,a.jsx)(u.Input,{id:"displayName",name:"displayName",defaultValue:e?.display_name||"",placeholder:"表示名",className:"rounded-md",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.Label,{htmlFor:"displayNameKana",children:"表示名（かな）"}),(0,a.jsx)(u.Input,{id:"displayNameKana",name:"displayNameKana",defaultValue:e?.display_name_kana||"",placeholder:"ひょうじめい",className:"rounded-md",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.Label,{htmlFor:"realName",children:"本名"}),(0,a.jsx)(u.Input,{id:"realName",name:"realName",defaultValue:e?.real_name||"",placeholder:"本名",className:"rounded-md"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.Label,{htmlFor:"realNameKana",children:"本名（かな）"}),(0,a.jsx)(u.Input,{id:"realNameKana",name:"realNameKana",defaultValue:e?.real_name_kana||"",placeholder:"ほんみょう",className:"rounded-md"})]})]}),"guest"===J&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.Label,{htmlFor:"guestAddressee",children:"宛名"}),(0,a.jsx)(u.Input,{id:"guestAddressee",name:"guestAddressee",type:"text",defaultValue:e?.guest_addressee??"",placeholder:"例: 山田様",className:"rounded-md"})]}),"guest"===J&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.Label,{htmlFor:"guestReceiptType",children:"領収書"}),(0,a.jsxs)(g.Select,{name:"guestReceiptType",defaultValue:e?.guest_receipt_type||"none",children:[(0,a.jsx)(g.SelectTrigger,{className:"rounded-md",children:(0,a.jsx)(g.SelectValue,{placeholder:"領収書の種類を選択"})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"none",children:"なし"}),(0,a.jsx)(g.SelectItem,{value:"amount_only",children:"金額のみ"}),(0,a.jsx)(g.SelectItem,{value:"with_date",children:"日付入り"})]})]})]}),e&&"guest"===J&&(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"キープボトル"}),(0,a.jsx)("button",{type:"button",onClick:()=>eF(!0),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",children:"+ 追加"})]}),(0,a.jsx)("div",{className:"space-y-2",children:0===eD.length?(0,a.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"ボトルはありません"}):eD.map(e=>(0,a.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:e.menu_name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["残量: ",e.remaining_amount,"%",e.expiration_date&&` / 期限: ${(0,O.format)(new Date(e.expiration_date),"yyyy/MM/dd")}`]})]})},e.id))})]}),!e&&(0,a.jsx)(h.DialogFooter,{className:"mt-6",children:(0,a.jsxs)("div",{className:"flex flex-col w-full gap-3",children:[(0,a.jsx)(x.Button,{type:"submit",disabled:$,className:"w-full rounded-full h-10",children:$?"作成中...":"作成する"}),(0,a.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>P(!1),className:"w-full rounded-full border-gray-300 dark:border-gray-600 h-10",children:"キャンセル"})]})})]},e?.id||"new"),e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"相性"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(m.Label,{className:"text-xs text-gray-500",children:"相性 ◯"}),(0,a.jsx)("button",{type:"button",onClick:()=>eS("compatibility_good"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:0===eW("compatibility_good").length?(0,a.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):eW("compatibility_good").map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>e_(e.id),className:"px-3 py-1.5 rounded-full bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-sm hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:e.display_name||e.real_name||"名前なし"},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(m.Label,{className:"text-xs text-gray-500",children:"相性 ✕"}),(0,a.jsx)("button",{type:"button",onClick:()=>eS("compatibility_bad"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:0===eW("compatibility_bad").length?(0,a.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):eW("compatibility_bad").map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>e_(e.id),className:"px-3 py-1.5 rounded-full bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 text-sm hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:e.display_name||e.real_name||"名前なし"},e.id))})]})]})]}),("cast"===J||"guest"===J)&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(m.Label,{children:"指名"}),(0,a.jsx)("button",{type:"button",onClick:()=>eS("nomination"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:0===eW("nomination").length?(0,a.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):eW("nomination").map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>e_(e.id),className:"px-3 py-1.5 rounded-full bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 text-sm hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-colors",children:e.display_name||e.real_name||"名前なし"},e.id))})]}),("cast"===J||"staff"===J)&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(m.Label,{children:"担当"}),(0,a.jsx)("button",{type:"button",onClick:()=>eS("in_charge"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"+ 追加"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:0===eW("in_charge").length?(0,a.jsx)("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:"未設定"}):eW("in_charge").map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>e_(e.id),className:"px-3 py-1.5 rounded-full bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 text-sm hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors",children:e.display_name||e.real_name||"名前なし"},e.id))})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"コメント"}),(0,a.jsxs)("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:[ed.map(e=>(0,a.jsxs)("div",{className:"flex gap-3 items-start bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg relative",children:[(0,a.jsxs)(T.Avatar,{className:"h-6 w-6",children:[(0,a.jsx)(T.AvatarImage,{src:e.author?.avatar_url||""}),(0,a.jsx)(T.AvatarFallback,{className:"bg-gray-200 dark:bg-gray-700",children:(0,a.jsx)(i.UserCircle,{className:"h-6 w-6 text-gray-700 dark:text-gray-300"})})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.author?.display_name||"不明なユーザー"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:(0,O.format)(new Date(e.updated_at),"yyyy/MM/dd")}),e.author?.id===eg&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{type:"button",onClick:()=>ej(ev===e.id?null:e.id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:(0,a.jsx)(l.MoreHorizontal,{className:"h-3 w-3 text-gray-700 dark:text-gray-300"})}),ev===e.id&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:e=>{e.stopPropagation(),ej(null)}}),(0,a.jsxs)("div",{className:"absolute right-0 top-6 z-50 w-24 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg p-1 flex flex-col gap-1 text-xs",children:[(0,a.jsxs)("button",{type:"button",className:"w-full text-left px-2 py-1.5 rounded flex items-center gap-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>{ef(e.id),eb(e.content),ej(null)},children:[(0,a.jsx)(d.Edit2,{className:"h-3 w-3"}),"編集"]}),(0,a.jsxs)("button",{type:"button",className:"w-full text-left px-2 py-1.5 rounded flex items-center gap-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{eN(e.id),ej(null)},children:[(0,a.jsx)(c.Trash2,{className:"h-3 w-3"}),"削除"]})]})]})]})]})]}),ey===e.id?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Textarea,{value:ep,onChange:e=>eb(e.target.value),className:"min-h-[60px]"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x.Button,{type:"button",size:"sm",onClick:()=>eH(e.id),children:"保存"}),(0,a.jsx)(x.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{ef(null),eb("")},children:"キャンセル"})]})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words",children:e.content}),(0,a.jsxs)("button",{type:"button",onClick:()=>eq(e.id),className:`flex items-center gap-1 text-xs transition-colors ${e.user_has_liked?"text-pink-500 dark:text-pink-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[(0,a.jsx)(n.Heart,{className:`h-3 w-3 ${e.user_has_liked?"fill-current":""}`}),(0,a.jsx)("span",{children:e.like_count>0?e.like_count:"いいね"})]})]})]})]},e.id)),0===ed.length&&(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-2",children:"コメントはありません"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.Input,{value:eo,onChange:e=>ex(e.target.value),placeholder:"コメントを入力...",className:"flex-1 h-10",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ez())}}),(0,a.jsx)(x.Button,{type:"button",size:"icon",onClick:ez,disabled:!eo.trim(),className:"h-10 w-10",children:(0,a.jsx)(s.Send,{className:"h-4 w-4"})})]})]})]})]})]})}),!A&&e&&"guest"===e.role&&(0,a.jsx)(R.BottleModal,{isOpen:eI,onClose:()=>{eF(!1),eB()},menus:eR,profiles:el,initialProfileIds:e?[e.id]:[]}),(0,a.jsx)(h.Dialog,{open:!!ek,onOpenChange:e=>!e&&eN(null),children:(0,a.jsxs)(h.DialogContent,{className:"sm:max-w-[400px] bg-white dark:bg-gray-800 w-[90%] rounded-lg p-6",children:[(0,a.jsx)(h.DialogHeader,{children:(0,a.jsx)(h.DialogTitle,{className:"text-center text-lg font-bold text-gray-900 dark:text-white",children:"コメントを削除"})}),(0,a.jsxs)("div",{className:"py-4 text-center text-gray-600 dark:text-gray-300",children:[(0,a.jsx)("p",{children:"本当にこのコメントを削除しますか？"}),(0,a.jsx)("p",{className:"text-sm mt-2 text-gray-500",children:"この操作は取り消せません。"})]}),(0,a.jsxs)(h.DialogFooter,{className:"flex-col sm:flex-row gap-3",children:[(0,a.jsx)(x.Button,{type:"button",variant:"destructive",onClick:()=>ek&&e$(ek),className:"w-full rounded-full bg-red-600 hover:bg-red-700 text-white h-10",children:"削除"}),(0,a.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>eN(null),className:"w-full rounded-full border-gray-300 dark:border-gray-600 h-10",children:"キャンセル"})]})]})}),(0,a.jsx)(h.Dialog,{open:Y,onOpenChange:ee,children:(0,a.jsxs)(h.DialogContent,{className:"sm:max-w-[400px] bg-white dark:bg-gray-800 w-[95%] rounded-lg p-6",children:[(0,a.jsx)(h.DialogHeader,{children:(0,a.jsx)(h.DialogTitle,{className:"text-center text-lg font-bold text-gray-900 dark:text-white",children:"ユーザーを削除"})}),(0,a.jsxs)("div",{className:"py-4 text-center text-gray-600 dark:text-gray-300",children:[(0,a.jsxs)("p",{children:["本当に「",e?.display_name,"」を削除しますか？"]}),(0,a.jsx)("p",{className:"text-sm mt-2 text-gray-500",children:"この操作は取り消せません。"})]}),(0,a.jsxs)(h.DialogFooter,{className:"flex-col sm:flex-row gap-3",children:[(0,a.jsx)(x.Button,{type:"button",variant:"destructive",onClick:eK,disabled:$,className:"w-full rounded-full bg-red-600 hover:bg-red-700 text-white h-10",children:$?"削除中...":"削除"}),(0,a.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>ee(!1),disabled:$,className:"w-full rounded-full border-gray-300 dark:border-gray-600 h-10",children:"キャンセル"})]})]})}),e&&(0,a.jsx)(I.UserAttendanceListModal,{isOpen:Q,onClose:()=>X(!1),profileId:e.id,profileName:e.display_name||"メンバー",onEditRecord:e=>et(e)}),ea&&e&&(0,a.jsx)(F.AttendanceModal,{isOpen:!!ea,onClose:()=>et(null),profiles:[e],currentProfileId:e.id,editingRecord:ea}),e&&ew&&(0,a.jsx)(B,{isOpen:!!ew,onClose:()=>eS(null),title:"compatibility_good"===ew?"相性 ◯":"compatibility_bad"===ew?"相性 ✕":"nomination"===ew?"指名":"担当",profiles:el,selectedIds:eJ(ew),onSelectionChange:e=>{ew&&eV(ew,e)},currentProfileId:e.id}),eC&&(0,a.jsx)(K,{open:!!eC,onOpenChange:e=>!e&&e_(null),profile:el.find(e=>e.id===eC)||null,isNested:!0})]})}}]);