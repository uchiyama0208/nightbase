(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95187,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={callServer:function(){return s.callServer},createServerReference:function(){return c.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var l in r)Object.defineProperty(a,l,{enumerable:!0,get:r[l]});let s=e.r(32120),i=e.r(92245),c=e.r(35326)},18494,e=>{"use strict";var t=e.i(18050),a=e.i(71645),r=e.i(26999),l=e.i(97495);let s=r.Root,i=r.Trigger,c=r.Portal,n=r.Close,d=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(r.Overlay,{ref:s,className:(0,l.cn)("fixed inset-0 z-50 bg-slate-950/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out",e),...a}));d.displayName=r.Overlay.displayName;let o=a.forwardRef(({className:e,children:a,...s},i)=>(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{}),(0,t.jsx)(r.Content,{ref:i,className:(0,l.cn)("fixed left-1/2 top-1/2 z-50 w-[calc(100%-2rem)] max-w-xl -translate-x-1/2 -translate-y-1/2 rounded-3xl border border-slate-200 bg-white p-8 text-slate-900 shadow-2xl backdrop-blur data-[state=open]:animate-in data-[state=closed]:animate-out dark:border-white/10 dark:bg-slate-950/95 dark:text-slate-100",e),...s,children:a})]}));o.displayName=r.Content.displayName;let x=({className:e,...a})=>(0,t.jsx)("div",{className:(0,l.cn)("mb-6 flex flex-col gap-2 text-center sm:text-left",e),...a});x.displayName="DialogHeader";let g=({className:e,...a})=>(0,t.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});g.displayName="DialogFooter";let m=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(r.Title,{ref:s,className:(0,l.cn)("text-xl font-semibold text-slate-900 dark:text-slate-50",e),...a}));m.displayName=r.Title.displayName;let u=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(r.Description,{ref:s,className:(0,l.cn)("text-sm text-slate-500 dark:text-slate-400",e),...a}));u.displayName=r.Description.displayName,e.s(["Dialog",()=>s,"DialogClose",()=>n,"DialogContent",()=>o,"DialogDescription",()=>u,"DialogFooter",()=>g,"DialogHeader",()=>x,"DialogTitle",()=>m,"DialogTrigger",()=>i])},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},73884,e=>{"use strict";let t=(0,e.i(75254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],73884)},11020,e=>{"use strict";var t=e.i(18050),a=e.i(71645);function r({pickupHistory:e,onValidationChange:r,isDarkMode:l,onPickupChange:s,onDestinationChange:i}){let[c,n]=(0,a.useState)(null),[d,o]=(0,a.useState)(""),x=e=>{n(e),s&&s(e),!1===e?r(!0):(r(""!==d.trim()),i&&i(d))},g=e=>{o(e),!0===c&&(r(""!==e.trim()),i&&i(e))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:`text-base font-semibold ${l?"text-white":"text-gray-900"}`,children:"送迎の有無"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>x(!1),className:`px-6 py-4 rounded-xl border-2 font-semibold text-lg transition-all ${!1===c?"bg-blue-500 border-blue-500 text-white":l?"bg-slate-800 border-slate-600 text-gray-200 hover:border-slate-400":"bg-white border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"送迎なし"}),(0,t.jsx)("button",{type:"button",onClick:()=>x(!0),className:`px-6 py-4 rounded-xl border-2 font-semibold text-lg transition-all ${!0===c?"bg-blue-500 border-blue-500 text-white":l?"bg-slate-800 border-slate-600 text-gray-200 hover:border-slate-400":"bg-white border-gray-300 text-gray-700 hover:border-gray-400"}`,children:"送迎あり"})]})]}),(0,t.jsx)("input",{type:"hidden",name:"pickup_required",value:!0===c?"yes":"no"}),!0===c&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:`text-base font-semibold ${l?"text-white":"text-gray-900"}`,children:"送迎先"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("input",{type:"text",name:"pickup_destination_custom",value:d,onChange:e=>g(e.target.value),placeholder:"送迎先を入力",className:`w-full rounded-lg px-4 py-3 text-base border placeholder:text-gray-400 ${l?"bg-slate-800 border-slate-600 text-white placeholder:text-gray-500":"bg-white border-gray-300 text-gray-900"}`}),e?.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"過去の履歴から選択"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>g(e),className:`px-4 py-2 rounded-lg text-sm border transition-colors ${d===e?"bg-blue-500 border-blue-500 text-white":l?"bg-slate-800 border-slate-600 text-gray-200 hover:border-slate-400":"bg-white border-gray-300 text-gray-700 hover:border-gray-400"}`,children:e},e))})]})]})]})]})}e.s(["PickupForm",()=>r])},14831,e=>{"use strict";var t=e.i(18050),a=e.i(71645),r=e.i(3420),l=e.i(95187),s=(0,l.createServerReference)("604ea1603dfc839f0dd9303395a1f7904ae2b84a07",l.callServer,void 0,l.findSourceMapURL,"clockIn"),i=(0,l.createServerReference)("40e6fae2b8cdecd7cc41b88835c51644ba8e42490d",l.callServer,void 0,l.findSourceMapURL,"startBreak"),c=(0,l.createServerReference)("40e60f50041f2bc8364378a81162612bea16641584",l.callServer,void 0,l.findSourceMapURL,"endBreak");let n=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var d=e.i(73884),o=e.i(16715),x=e.i(31278),g=e.i(18494),m=e.i(11020),u=(0,l.createServerReference)("40aa1d3b6c70b0def48387ebc4f67ad5e325ad7695",l.callServer,void 0,l.findSourceMapURL,"clockOut"),h=e.i(18566);function b({isOpen:e,onClose:l,timeCardId:s}){let[i,c]=(0,a.useState)(!1),n=(0,h.useRouter)(),d=async()=>{c(!0);try{await u(s),l(),n.refresh()}catch(e){console.error("Clock out failed:",e),alert("退勤打刻に失敗しました。もう一度お試しください。")}finally{c(!1)}};return(0,t.jsx)(g.Dialog,{open:e,onOpenChange:l,children:(0,t.jsxs)(g.DialogContent,{className:"sm:max-w-[425px] bg-white dark:bg-gray-800",children:[(0,t.jsxs)(g.DialogHeader,{children:[(0,t.jsx)(g.DialogTitle,{className:"text-gray-900 dark:text-white",children:"退勤確認"}),(0,t.jsx)(g.DialogDescription,{className:"text-gray-600 dark:text-gray-400",children:"退勤打刻を行いますか？"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 pt-4",children:[(0,t.jsx)(r.Button,{onClick:d,disabled:i,className:"w-full bg-blue-500 hover:bg-blue-600 text-white",children:i?"登録中...":"退勤する"}),(0,t.jsx)(r.Button,{variant:"outline",onClick:l,className:"w-full border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"キャンセル"})]})]})})}function f({latestTimeCard:e,storeSettings:l,showBreakButtons:u=!0,pickupHistory:h,autoOpenModal:f=!1,autoClockOut:y=!1}){let[p,v]=(0,a.useState)(null),[j,k]=(0,a.useState)(!1),[w,N]=(0,a.useState)("disabled"),[C,S]=(0,a.useState)(null),D=(0,a.useCallback)(()=>{l?.location_check_enabled?l.latitude&&l.longitude&&navigator.geolocation?(N("checking"),navigator.geolocation.getCurrentPosition(e=>{var t,a,r,s;let i,c,n,d,o,x=(t=e.coords.latitude,a=e.coords.longitude,r=l.latitude,s=l.longitude,i=t*Math.PI/180,c=r*Math.PI/180,2*Math.atan2(Math.sqrt(o=Math.sin((n=(r-t)*Math.PI/180)/2)*Math.sin(n/2)+Math.cos(i)*Math.cos(c)*Math.sin((d=(s-a)*Math.PI/180)/2)*Math.sin(d/2)),Math.sqrt(1-o))*6371e3);S(x),x<=l.location_radius?N("matched"):N("mismatched")},e=>{console.error("Error getting location:",e),N("error")})):N("error"):N("disabled")},[l]),[M,_]=(0,a.useState)(!1),[R,T]=(0,a.useState)(!1);(0,a.useEffect)(()=>{v(new Date);let e=setInterval(()=>{v(new Date)},1e3);return l?.location_check_enabled&&D(),()=>clearInterval(e)},[l?.location_check_enabled,D]),(0,a.useEffect)(()=>{if(f&&!e?.clock_in){let e=setTimeout(()=>{_(!0)},500);return()=>clearTimeout(e)}},[f,e]);let P=a.default.useRef(!1);(0,a.useEffect)(()=>{if(y&&e?.clock_in&&!e?.clock_out&&!P.current){P.current=!0;let e=setTimeout(()=>{T(!0)},300);return()=>clearTimeout(e)}},[y,e]);let[B,L]=(0,a.useState)(!1),[z,F]=(0,a.useState)(null),[O,$]=(0,a.useState)(""),E=async()=>{_(!0)},I=async()=>{k(!0);try{await s(!0===z,O),_(!1),window.location.reload()}catch(e){console.error("Clock in failed:",e),alert("出勤打刻に失敗しました。もう一度お試しください。")}finally{k(!1)}},U=async e=>{k(!0);try{await e()}catch(e){console.error("Action error:",e),alert("操作に失敗しました")}finally{k(!1)}},H=e?.clock_in&&!e?.clock_out,q=H&&e?.break_start&&!e?.break_end,X=j||l?.location_check_enabled&&"matched"!==w;return(0,t.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("div",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white font-mono",children:p?p.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--"}),(0,t.jsx)("div",{className:"text-sm md:text-base lg:text-lg text-gray-600 dark:text-gray-400",children:p?p.toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"long"}):"----/--/--"})]}),!H&&(()=>{if(!l?.location_check_enabled)return null;switch(w){case"checking":return(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-gray-500 dark:text-gray-400 text-sm",children:[(0,t.jsx)(x.Loader2,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{children:"位置情報を確認中..."})]});case"matched":return(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600 dark:text-green-400 text-sm font-medium",children:[(0,t.jsx)(n,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"位置情報は一致しています"})]});case"mismatched":return(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-red-600 dark:text-red-400 text-sm font-medium",children:[(0,t.jsx)(d.XCircle,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["位置情報が一致していません (",Math.round(C||0),"m)"]})]});case"error":return(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-red-600 dark:text-red-400 text-sm font-medium",children:[(0,t.jsx)(d.XCircle,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"位置情報の取得に失敗しました"})]});default:return null}})(),(0,t.jsx)("div",{className:"flex flex-col items-center gap-3 md:gap-4",children:H?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"text-center text-sm font-medium text-blue-600 dark:text-blue-400 mb-2",children:"勤務中"}),(0,t.jsx)("div",{className:"flex flex-col md:flex-row gap-3 md:gap-4 w-full max-w-md",children:q?(0,t.jsx)(r.Button,{size:"lg",onClick:()=>U(()=>c(e.id)),disabled:j,className:"text-base md:text-lg px-6 md:px-8 py-4 md:py-6 bg-green-500 hover:bg-green-600 text-white w-full",children:j?"登録中...":"休憩終了"}):(0,t.jsxs)(t.Fragment,{children:[u&&(0,t.jsx)(r.Button,{size:"lg",onClick:()=>U(()=>i(e.id)),disabled:j,className:"text-base md:text-lg px-6 md:px-8 py-4 md:py-6 bg-yellow-500 hover:bg-yellow-600 text-white flex-1",children:j?"登録中...":"休憩開始"}),(0,t.jsx)(r.Button,{size:"lg",onClick:()=>{T(!0)},disabled:j,className:`text-base md:text-lg px-6 md:px-8 py-4 md:py-6 bg-red-500 hover:bg-red-600 text-white ${u?"flex-1":"w-full"}`,children:j?"登録中...":"退勤する"})]})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2 w-full max-w-xs",children:[(0,t.jsx)(r.Button,{size:"lg",onClick:E,disabled:X,className:`text-base md:text-lg px-8 md:px-12 py-4 md:py-6 text-white w-full transition-colors ${X?"bg-gray-300 dark:bg-gray-700 cursor-not-allowed":"bg-[#0088FF] hover:bg-[#0077EE]"}`,children:j?"登録中...":"出勤する"}),l?.location_check_enabled&&"matched"!==w&&"checking"!==w&&(0,t.jsx)(r.Button,{size:"icon",variant:"outline",onClick:D,className:"h-14 w-14 shrink-0 border-gray-200 dark:border-gray-700",title:"位置情報を再取得",children:(0,t.jsx)(o.RefreshCw,{className:"h-5 w-5 text-gray-500"})})]})}),(0,t.jsx)(g.Dialog,{open:M,onOpenChange:_,children:(0,t.jsxs)(g.DialogContent,{className:"sm:max-w-[500px] max-w-[calc(100%-2rem)] bg-white dark:bg-white",children:[(0,t.jsx)(g.DialogHeader,{children:(0,t.jsx)(g.DialogTitle,{className:"text-gray-900",children:"出勤確認"})}),(0,t.jsx)("div",{className:"py-4",children:(0,t.jsx)(m.PickupForm,{pickupHistory:h,onValidationChange:L,isDarkMode:!1,onPickupChange:F,onDestinationChange:$})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 pt-2",children:[(0,t.jsx)(r.Button,{onClick:I,disabled:null===z||!B||j,className:"w-full bg-[#0088FF] hover:bg-[#0077EE] text-white disabled:bg-gray-300 disabled:cursor-not-allowed",children:j?"登録中...":"出勤する"}),(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>_(!1),className:"w-full border-gray-300 text-gray-700 hover:bg-gray-50",children:"キャンセル"})]})]})}),(0,t.jsx)(b,{isOpen:R,onClose:()=>T(!1),timeCardId:e?.id||""})]})}e.s(["ClockButtons",()=>f],14831)}]);